var hv=Object.defineProperty;var dv=(t,e,n)=>e in t?hv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Yu=(t,e,n)=>dv(t,typeof e!="symbol"?e+"":e,n);function fv(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function gv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var s_={exports:{}},Zl={},o_={exports:{}},Q={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zo=Symbol.for("react.element"),pv=Symbol.for("react.portal"),mv=Symbol.for("react.fragment"),_v=Symbol.for("react.strict_mode"),yv=Symbol.for("react.profiler"),xv=Symbol.for("react.provider"),vv=Symbol.for("react.context"),Ev=Symbol.for("react.forward_ref"),wv=Symbol.for("react.suspense"),Sv=Symbol.for("react.memo"),Cv=Symbol.for("react.lazy"),Sg=Symbol.iterator;function Tv(t){return t===null||typeof t!="object"?null:(t=Sg&&t[Sg]||t["@@iterator"],typeof t=="function"?t:null)}var a_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},l_=Object.assign,u_={};function ws(t,e,n){this.props=t,this.context=e,this.refs=u_,this.updater=n||a_}ws.prototype.isReactComponent={};ws.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ws.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function c_(){}c_.prototype=ws.prototype;function vd(t,e,n){this.props=t,this.context=e,this.refs=u_,this.updater=n||a_}var Ed=vd.prototype=new c_;Ed.constructor=vd;l_(Ed,ws.prototype);Ed.isPureReactComponent=!0;var Cg=Array.isArray,h_=Object.prototype.hasOwnProperty,wd={current:null},d_={key:!0,ref:!0,__self:!0,__source:!0};function f_(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)h_.call(e,i)&&!d_.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Zo,type:t,key:s,ref:o,props:r,_owner:wd.current}}function Rv(t,e){return{$$typeof:Zo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Sd(t){return typeof t=="object"&&t!==null&&t.$$typeof===Zo}function Pv(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Tg=/\/+/g;function Hu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Pv(""+t.key):e.toString(36)}function Wa(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Zo:case pv:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+Hu(o,0):i,Cg(r)?(n="",t!=null&&(n=t.replace(Tg,"$&/")+"/"),Wa(r,e,n,"",function(u){return u})):r!=null&&(Sd(r)&&(r=Rv(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(Tg,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",Cg(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+Hu(s,a);o+=Wa(s,e,n,l,r)}else if(l=Tv(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+Hu(s,a++),o+=Wa(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ha(t,e,n){if(t==null)return t;var i=[],r=0;return Wa(t,i,"","",function(s){return e.call(n,s,r++)}),i}function Iv(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var at={current:null},Xa={transition:null},Lv={ReactCurrentDispatcher:at,ReactCurrentBatchConfig:Xa,ReactCurrentOwner:wd};function g_(){throw Error("act(...) is not supported in production builds of React.")}Q.Children={map:ha,forEach:function(t,e,n){ha(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ha(t,function(){e++}),e},toArray:function(t){return ha(t,function(e){return e})||[]},only:function(t){if(!Sd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Q.Component=ws;Q.Fragment=mv;Q.Profiler=yv;Q.PureComponent=vd;Q.StrictMode=_v;Q.Suspense=wv;Q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lv;Q.act=g_;Q.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=l_({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=wd.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)h_.call(e,l)&&!d_.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:Zo,type:t.type,key:r,ref:s,props:i,_owner:o}};Q.createContext=function(t){return t={$$typeof:vv,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:xv,_context:t},t.Consumer=t};Q.createElement=f_;Q.createFactory=function(t){var e=f_.bind(null,t);return e.type=t,e};Q.createRef=function(){return{current:null}};Q.forwardRef=function(t){return{$$typeof:Ev,render:t}};Q.isValidElement=Sd;Q.lazy=function(t){return{$$typeof:Cv,_payload:{_status:-1,_result:t},_init:Iv}};Q.memo=function(t,e){return{$$typeof:Sv,type:t,compare:e===void 0?null:e}};Q.startTransition=function(t){var e=Xa.transition;Xa.transition={};try{t()}finally{Xa.transition=e}};Q.unstable_act=g_;Q.useCallback=function(t,e){return at.current.useCallback(t,e)};Q.useContext=function(t){return at.current.useContext(t)};Q.useDebugValue=function(){};Q.useDeferredValue=function(t){return at.current.useDeferredValue(t)};Q.useEffect=function(t,e){return at.current.useEffect(t,e)};Q.useId=function(){return at.current.useId()};Q.useImperativeHandle=function(t,e,n){return at.current.useImperativeHandle(t,e,n)};Q.useInsertionEffect=function(t,e){return at.current.useInsertionEffect(t,e)};Q.useLayoutEffect=function(t,e){return at.current.useLayoutEffect(t,e)};Q.useMemo=function(t,e){return at.current.useMemo(t,e)};Q.useReducer=function(t,e,n){return at.current.useReducer(t,e,n)};Q.useRef=function(t){return at.current.useRef(t)};Q.useState=function(t){return at.current.useState(t)};Q.useSyncExternalStore=function(t,e,n){return at.current.useSyncExternalStore(t,e,n)};Q.useTransition=function(){return at.current.useTransition()};Q.version="18.3.1";o_.exports=Q;var P=o_.exports;const p_=gv(P),Av=fv({__proto__:null,default:p_},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kv=P,Mv=Symbol.for("react.element"),Dv=Symbol.for("react.fragment"),Nv=Object.prototype.hasOwnProperty,Fv=kv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ov={key:!0,ref:!0,__self:!0,__source:!0};function m_(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)Nv.call(e,i)&&!Ov.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:Mv,type:t,key:s,ref:o,props:r,_owner:Fv.current}}Zl.Fragment=Dv;Zl.jsx=m_;Zl.jsxs=m_;s_.exports=Zl;var E=s_.exports,th={},__={exports:{}},Rt={},y_={exports:{}},x_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,D){var N=L.length;L.push(D);e:for(;0<N;){var W=N-1>>>1,k=L[W];if(0<r(k,D))L[W]=D,L[N]=k,N=W;else break e}}function n(L){return L.length===0?null:L[0]}function i(L){if(L.length===0)return null;var D=L[0],N=L.pop();if(N!==D){L[0]=N;e:for(var W=0,k=L.length,Ce=k>>>1;W<Ce;){var ue=2*(W+1)-1,he=L[ue],Te=ue+1,Re=L[Te];if(0>r(he,N))Te<k&&0>r(Re,he)?(L[W]=Re,L[Te]=N,W=Te):(L[W]=he,L[ue]=N,W=ue);else if(Te<k&&0>r(Re,N))L[W]=Re,L[Te]=N,W=Te;else break e}}return D}function r(L,D){var N=L.sortIndex-D.sortIndex;return N!==0?N:L.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,g=!1,f=!1,_=!1,x=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(L){for(var D=n(u);D!==null;){if(D.callback===null)i(u);else if(D.startTime<=L)i(u),D.sortIndex=D.expirationTime,e(l,D);else break;D=n(u)}}function v(L){if(_=!1,y(L),!f)if(n(l)!==null)f=!0,B(w);else{var D=n(u);D!==null&&H(v,D.startTime-L)}}function w(L,D){f=!1,_&&(_=!1,m(T),T=-1),g=!0;var N=d;try{for(y(D),h=n(l);h!==null&&(!(h.expirationTime>D)||L&&!j());){var W=h.callback;if(typeof W=="function"){h.callback=null,d=h.priorityLevel;var k=W(h.expirationTime<=D);D=t.unstable_now(),typeof k=="function"?h.callback=k:h===n(l)&&i(l),y(D)}else i(l);h=n(l)}if(h!==null)var Ce=!0;else{var ue=n(u);ue!==null&&H(v,ue.startTime-D),Ce=!1}return Ce}finally{h=null,d=N,g=!1}}var C=!1,R=null,T=-1,I=5,A=-1;function j(){return!(t.unstable_now()-A<I)}function b(){if(R!==null){var L=t.unstable_now();A=L;var D=!0;try{D=R(!0,L)}finally{D?F():(C=!1,R=null)}}else C=!1}var F;if(typeof p=="function")F=function(){p(b)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,K=$.port2;$.port1.onmessage=b,F=function(){K.postMessage(null)}}else F=function(){x(b,0)};function B(L){R=L,C||(C=!0,F())}function H(L,D){T=x(function(){L(t.unstable_now())},D)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){f||g||(f=!0,B(w))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(L){switch(d){case 1:case 2:case 3:var D=3;break;default:D=d}var N=d;d=D;try{return L()}finally{d=N}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,D){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var N=d;d=L;try{return D()}finally{d=N}},t.unstable_scheduleCallback=function(L,D,N){var W=t.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?W+N:W):N=W,L){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=N+k,L={id:c++,callback:D,priorityLevel:L,startTime:N,expirationTime:k,sortIndex:-1},N>W?(L.sortIndex=N,e(u,L),n(l)===null&&L===n(u)&&(_?(m(T),T=-1):_=!0,H(v,N-W))):(L.sortIndex=k,e(l,L),f||g||(f=!0,B(w))),L},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(L){var D=d;return function(){var N=d;d=D;try{return L.apply(this,arguments)}finally{d=N}}}})(x_);y_.exports=x_;var bv=y_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jv=P,Ct=bv;function M(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v_=new Set,yo={};function lr(t,e){os(t,e),os(t+"Capture",e)}function os(t,e){for(yo[t]=e,t=0;t<e.length;t++)v_.add(e[t])}var jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nh=Object.prototype.hasOwnProperty,zv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rg={},Pg={};function $v(t){return nh.call(Pg,t)?!0:nh.call(Rg,t)?!1:zv.test(t)?Pg[t]=!0:(Rg[t]=!0,!1)}function Bv(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Gv(t,e,n,i){if(e===null||typeof e>"u"||Bv(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function lt(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var He={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){He[t]=new lt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];He[e]=new lt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){He[t]=new lt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){He[t]=new lt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){He[t]=new lt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){He[t]=new lt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){He[t]=new lt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){He[t]=new lt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){He[t]=new lt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Cd=/[\-:]([a-z])/g;function Td(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Cd,Td);He[e]=new lt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Cd,Td);He[e]=new lt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Cd,Td);He[e]=new lt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){He[t]=new lt(t,1,!1,t.toLowerCase(),null,!1,!1)});He.xlinkHref=new lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){He[t]=new lt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Rd(t,e,n,i){var r=He.hasOwnProperty(e)?He[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Gv(e,n,r,i)&&(n=null),i||r===null?$v(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Un=jv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,da=Symbol.for("react.element"),Mr=Symbol.for("react.portal"),Dr=Symbol.for("react.fragment"),Pd=Symbol.for("react.strict_mode"),ih=Symbol.for("react.profiler"),E_=Symbol.for("react.provider"),w_=Symbol.for("react.context"),Id=Symbol.for("react.forward_ref"),rh=Symbol.for("react.suspense"),sh=Symbol.for("react.suspense_list"),Ld=Symbol.for("react.memo"),ni=Symbol.for("react.lazy"),S_=Symbol.for("react.offscreen"),Ig=Symbol.iterator;function Os(t){return t===null||typeof t!="object"?null:(t=Ig&&t[Ig]||t["@@iterator"],typeof t=="function"?t:null)}var ve=Object.assign,Ku;function Ks(t){if(Ku===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ku=e&&e[1]||""}return`
`+Ku+t}var Zu=!1;function qu(t,e){if(!t||Zu)return"";Zu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){i=u}t.call(e.prototype)}else{try{throw Error()}catch(u){i=u}t()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Zu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ks(t):""}function Uv(t){switch(t.tag){case 5:return Ks(t.type);case 16:return Ks("Lazy");case 13:return Ks("Suspense");case 19:return Ks("SuspenseList");case 0:case 2:case 15:return t=qu(t.type,!1),t;case 11:return t=qu(t.type.render,!1),t;case 1:return t=qu(t.type,!0),t;default:return""}}function oh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Dr:return"Fragment";case Mr:return"Portal";case ih:return"Profiler";case Pd:return"StrictMode";case rh:return"Suspense";case sh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case w_:return(t.displayName||"Context")+".Consumer";case E_:return(t._context.displayName||"Context")+".Provider";case Id:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ld:return e=t.displayName||null,e!==null?e:oh(t.type)||"Memo";case ni:e=t._payload,t=t._init;try{return oh(t(e))}catch{}}return null}function Wv(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oh(e);case 8:return e===Pd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ci(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function C_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Xv(t){var e=C_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function fa(t){t._valueTracker||(t._valueTracker=Xv(t))}function T_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=C_(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function ol(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ah(t,e){var n=e.checked;return ve({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Lg(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=Ci(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function R_(t,e){e=e.checked,e!=null&&Rd(t,"checked",e,!1)}function lh(t,e){R_(t,e);var n=Ci(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?uh(t,e.type,n):e.hasOwnProperty("defaultValue")&&uh(t,e.type,Ci(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ag(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function uh(t,e,n){(e!=="number"||ol(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Zs=Array.isArray;function Hr(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Ci(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function ch(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(M(91));return ve({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function kg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(M(92));if(Zs(n)){if(1<n.length)throw Error(M(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ci(n)}}function P_(t,e){var n=Ci(e.value),i=Ci(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function Mg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function I_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?I_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ga,L_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ga=ga||document.createElement("div"),ga.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ga.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function xo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var so={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vv=["Webkit","ms","Moz","O"];Object.keys(so).forEach(function(t){Vv.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),so[e]=so[t]})});function A_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||so.hasOwnProperty(t)&&so[t]?(""+e).trim():e+"px"}function k_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=A_(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var Yv=ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dh(t,e){if(e){if(Yv[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(M(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(M(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(M(61))}if(e.style!=null&&typeof e.style!="object")throw Error(M(62))}}function fh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gh=null;function Ad(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ph=null,Kr=null,Zr=null;function Dg(t){if(t=Qo(t)){if(typeof ph!="function")throw Error(M(280));var e=t.stateNode;e&&(e=tu(e),ph(t.stateNode,t.type,e))}}function M_(t){Kr?Zr?Zr.push(t):Zr=[t]:Kr=t}function D_(){if(Kr){var t=Kr,e=Zr;if(Zr=Kr=null,Dg(t),e)for(t=0;t<e.length;t++)Dg(e[t])}}function N_(t,e){return t(e)}function F_(){}var Ju=!1;function O_(t,e,n){if(Ju)return t(e,n);Ju=!0;try{return N_(t,e,n)}finally{Ju=!1,(Kr!==null||Zr!==null)&&(F_(),D_())}}function vo(t,e){var n=t.stateNode;if(n===null)return null;var i=tu(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(M(231,e,typeof n));return n}var mh=!1;if(jn)try{var bs={};Object.defineProperty(bs,"passive",{get:function(){mh=!0}}),window.addEventListener("test",bs,bs),window.removeEventListener("test",bs,bs)}catch{mh=!1}function Hv(t,e,n,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var oo=!1,al=null,ll=!1,_h=null,Kv={onError:function(t){oo=!0,al=t}};function Zv(t,e,n,i,r,s,o,a,l){oo=!1,al=null,Hv.apply(Kv,arguments)}function qv(t,e,n,i,r,s,o,a,l){if(Zv.apply(this,arguments),oo){if(oo){var u=al;oo=!1,al=null}else throw Error(M(198));ll||(ll=!0,_h=u)}}function ur(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function b_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ng(t){if(ur(t)!==t)throw Error(M(188))}function Jv(t){var e=t.alternate;if(!e){if(e=ur(t),e===null)throw Error(M(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return Ng(r),t;if(s===i)return Ng(r),e;s=s.sibling}throw Error(M(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(M(189))}}if(n.alternate!==i)throw Error(M(190))}if(n.tag!==3)throw Error(M(188));return n.stateNode.current===n?t:e}function j_(t){return t=Jv(t),t!==null?z_(t):null}function z_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=z_(t);if(e!==null)return e;t=t.sibling}return null}var $_=Ct.unstable_scheduleCallback,Fg=Ct.unstable_cancelCallback,Qv=Ct.unstable_shouldYield,eE=Ct.unstable_requestPaint,Ie=Ct.unstable_now,tE=Ct.unstable_getCurrentPriorityLevel,kd=Ct.unstable_ImmediatePriority,B_=Ct.unstable_UserBlockingPriority,ul=Ct.unstable_NormalPriority,nE=Ct.unstable_LowPriority,G_=Ct.unstable_IdlePriority,ql=null,mn=null;function iE(t){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(ql,t,void 0,(t.current.flags&128)===128)}catch{}}var Jt=Math.clz32?Math.clz32:oE,rE=Math.log,sE=Math.LN2;function oE(t){return t>>>=0,t===0?32:31-(rE(t)/sE|0)|0}var pa=64,ma=4194304;function qs(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function cl(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=qs(a):(s&=o,s!==0&&(i=qs(s)))}else o=n&~r,o!==0?i=qs(o):s!==0&&(i=qs(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Jt(e),r=1<<n,i|=t[n],e&=~r;return i}function aE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lE(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Jt(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=aE(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function yh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function U_(){var t=pa;return pa<<=1,!(pa&4194240)&&(pa=64),t}function Qu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function qo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Jt(e),t[e]=n}function uE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Jt(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function Md(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Jt(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var le=0;function W_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var X_,Dd,V_,Y_,H_,xh=!1,_a=[],fi=null,gi=null,pi=null,Eo=new Map,wo=new Map,si=[],cE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Og(t,e){switch(t){case"focusin":case"focusout":fi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":pi=null;break;case"pointerover":case"pointerout":Eo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":wo.delete(e.pointerId)}}function js(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Qo(e),e!==null&&Dd(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function hE(t,e,n,i,r){switch(e){case"focusin":return fi=js(fi,t,e,n,i,r),!0;case"dragenter":return gi=js(gi,t,e,n,i,r),!0;case"mouseover":return pi=js(pi,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Eo.set(s,js(Eo.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,wo.set(s,js(wo.get(s)||null,t,e,n,i,r)),!0}return!1}function K_(t){var e=Bi(t.target);if(e!==null){var n=ur(e);if(n!==null){if(e=n.tag,e===13){if(e=b_(n),e!==null){t.blockedOn=e,H_(t.priority,function(){V_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Va(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=vh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);gh=i,n.target.dispatchEvent(i),gh=null}else return e=Qo(n),e!==null&&Dd(e),t.blockedOn=n,!1;e.shift()}return!0}function bg(t,e,n){Va(t)&&n.delete(e)}function dE(){xh=!1,fi!==null&&Va(fi)&&(fi=null),gi!==null&&Va(gi)&&(gi=null),pi!==null&&Va(pi)&&(pi=null),Eo.forEach(bg),wo.forEach(bg)}function zs(t,e){t.blockedOn===e&&(t.blockedOn=null,xh||(xh=!0,Ct.unstable_scheduleCallback(Ct.unstable_NormalPriority,dE)))}function So(t){function e(r){return zs(r,t)}if(0<_a.length){zs(_a[0],t);for(var n=1;n<_a.length;n++){var i=_a[n];i.blockedOn===t&&(i.blockedOn=null)}}for(fi!==null&&zs(fi,t),gi!==null&&zs(gi,t),pi!==null&&zs(pi,t),Eo.forEach(e),wo.forEach(e),n=0;n<si.length;n++)i=si[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<si.length&&(n=si[0],n.blockedOn===null);)K_(n),n.blockedOn===null&&si.shift()}var qr=Un.ReactCurrentBatchConfig,hl=!0;function fE(t,e,n,i){var r=le,s=qr.transition;qr.transition=null;try{le=1,Nd(t,e,n,i)}finally{le=r,qr.transition=s}}function gE(t,e,n,i){var r=le,s=qr.transition;qr.transition=null;try{le=4,Nd(t,e,n,i)}finally{le=r,qr.transition=s}}function Nd(t,e,n,i){if(hl){var r=vh(t,e,n,i);if(r===null)uc(t,e,i,dl,n),Og(t,i);else if(hE(r,t,e,n,i))i.stopPropagation();else if(Og(t,i),e&4&&-1<cE.indexOf(t)){for(;r!==null;){var s=Qo(r);if(s!==null&&X_(s),s=vh(t,e,n,i),s===null&&uc(t,e,i,dl,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else uc(t,e,i,null,n)}}var dl=null;function vh(t,e,n,i){if(dl=null,t=Ad(i),t=Bi(t),t!==null)if(e=ur(t),e===null)t=null;else if(n=e.tag,n===13){if(t=b_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return dl=t,null}function Z_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tE()){case kd:return 1;case B_:return 4;case ul:case nE:return 16;case G_:return 536870912;default:return 16}default:return 16}}var ai=null,Fd=null,Ya=null;function q_(){if(Ya)return Ya;var t,e=Fd,n=e.length,i,r="value"in ai?ai.value:ai.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return Ya=r.slice(t,1<i?1-i:void 0)}function Ha(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ya(){return!0}function jg(){return!1}function Pt(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ya:jg,this.isPropagationStopped=jg,this}return ve(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ya)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ya)},persist:function(){},isPersistent:ya}),e}var Ss={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Od=Pt(Ss),Jo=ve({},Ss,{view:0,detail:0}),pE=Pt(Jo),ec,tc,$s,Jl=ve({},Jo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$s&&($s&&t.type==="mousemove"?(ec=t.screenX-$s.screenX,tc=t.screenY-$s.screenY):tc=ec=0,$s=t),ec)},movementY:function(t){return"movementY"in t?t.movementY:tc}}),zg=Pt(Jl),mE=ve({},Jl,{dataTransfer:0}),_E=Pt(mE),yE=ve({},Jo,{relatedTarget:0}),nc=Pt(yE),xE=ve({},Ss,{animationName:0,elapsedTime:0,pseudoElement:0}),vE=Pt(xE),EE=ve({},Ss,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wE=Pt(EE),SE=ve({},Ss,{data:0}),$g=Pt(SE),CE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function PE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=RE[t])?!!e[t]:!1}function bd(){return PE}var IE=ve({},Jo,{key:function(t){if(t.key){var e=CE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ha(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?TE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bd,charCode:function(t){return t.type==="keypress"?Ha(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ha(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),LE=Pt(IE),AE=ve({},Jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bg=Pt(AE),kE=ve({},Jo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bd}),ME=Pt(kE),DE=ve({},Ss,{propertyName:0,elapsedTime:0,pseudoElement:0}),NE=Pt(DE),FE=ve({},Jl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),OE=Pt(FE),bE=[9,13,27,32],jd=jn&&"CompositionEvent"in window,ao=null;jn&&"documentMode"in document&&(ao=document.documentMode);var jE=jn&&"TextEvent"in window&&!ao,J_=jn&&(!jd||ao&&8<ao&&11>=ao),Gg=" ",Ug=!1;function Q_(t,e){switch(t){case"keyup":return bE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ey(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Nr=!1;function zE(t,e){switch(t){case"compositionend":return ey(e);case"keypress":return e.which!==32?null:(Ug=!0,Gg);case"textInput":return t=e.data,t===Gg&&Ug?null:t;default:return null}}function $E(t,e){if(Nr)return t==="compositionend"||!jd&&Q_(t,e)?(t=q_(),Ya=Fd=ai=null,Nr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return J_&&e.locale!=="ko"?null:e.data;default:return null}}var BE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!BE[t.type]:e==="textarea"}function ty(t,e,n,i){M_(i),e=fl(e,"onChange"),0<e.length&&(n=new Od("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var lo=null,Co=null;function GE(t){dy(t,0)}function Ql(t){var e=br(t);if(T_(e))return t}function UE(t,e){if(t==="change")return e}var ny=!1;if(jn){var ic;if(jn){var rc="oninput"in document;if(!rc){var Xg=document.createElement("div");Xg.setAttribute("oninput","return;"),rc=typeof Xg.oninput=="function"}ic=rc}else ic=!1;ny=ic&&(!document.documentMode||9<document.documentMode)}function Vg(){lo&&(lo.detachEvent("onpropertychange",iy),Co=lo=null)}function iy(t){if(t.propertyName==="value"&&Ql(Co)){var e=[];ty(e,Co,t,Ad(t)),O_(GE,e)}}function WE(t,e,n){t==="focusin"?(Vg(),lo=e,Co=n,lo.attachEvent("onpropertychange",iy)):t==="focusout"&&Vg()}function XE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ql(Co)}function VE(t,e){if(t==="click")return Ql(e)}function YE(t,e){if(t==="input"||t==="change")return Ql(e)}function HE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var en=typeof Object.is=="function"?Object.is:HE;function To(t,e){if(en(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!nh.call(e,r)||!en(t[r],e[r]))return!1}return!0}function Yg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Hg(t,e){var n=Yg(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Yg(n)}}function ry(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ry(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function sy(){for(var t=window,e=ol();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ol(t.document)}return e}function zd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function KE(t){var e=sy(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&ry(n.ownerDocument.documentElement,n)){if(i!==null&&zd(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=Hg(n,s);var o=Hg(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ZE=jn&&"documentMode"in document&&11>=document.documentMode,Fr=null,Eh=null,uo=null,wh=!1;function Kg(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wh||Fr==null||Fr!==ol(i)||(i=Fr,"selectionStart"in i&&zd(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),uo&&To(uo,i)||(uo=i,i=fl(Eh,"onSelect"),0<i.length&&(e=new Od("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Fr)))}function xa(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Or={animationend:xa("Animation","AnimationEnd"),animationiteration:xa("Animation","AnimationIteration"),animationstart:xa("Animation","AnimationStart"),transitionend:xa("Transition","TransitionEnd")},sc={},oy={};jn&&(oy=document.createElement("div").style,"AnimationEvent"in window||(delete Or.animationend.animation,delete Or.animationiteration.animation,delete Or.animationstart.animation),"TransitionEvent"in window||delete Or.transitionend.transition);function eu(t){if(sc[t])return sc[t];if(!Or[t])return t;var e=Or[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in oy)return sc[t]=e[n];return t}var ay=eu("animationend"),ly=eu("animationiteration"),uy=eu("animationstart"),cy=eu("transitionend"),hy=new Map,Zg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(t,e){hy.set(t,e),lr(e,[t])}for(var oc=0;oc<Zg.length;oc++){var ac=Zg[oc],qE=ac.toLowerCase(),JE=ac[0].toUpperCase()+ac.slice(1);Pi(qE,"on"+JE)}Pi(ay,"onAnimationEnd");Pi(ly,"onAnimationIteration");Pi(uy,"onAnimationStart");Pi("dblclick","onDoubleClick");Pi("focusin","onFocus");Pi("focusout","onBlur");Pi(cy,"onTransitionEnd");os("onMouseEnter",["mouseout","mouseover"]);os("onMouseLeave",["mouseout","mouseover"]);os("onPointerEnter",["pointerout","pointerover"]);os("onPointerLeave",["pointerout","pointerover"]);lr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));lr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));lr("onBeforeInput",["compositionend","keypress","textInput","paste"]);lr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));lr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));lr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Js="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Js));function qg(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,qv(i,e,void 0,t),t.currentTarget=null}function dy(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;qg(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;qg(r,a,u),s=l}}}if(ll)throw t=_h,ll=!1,_h=null,t}function de(t,e){var n=e[Ph];n===void 0&&(n=e[Ph]=new Set);var i=t+"__bubble";n.has(i)||(fy(e,t,2,!1),n.add(i))}function lc(t,e,n){var i=0;e&&(i|=4),fy(n,t,i,e)}var va="_reactListening"+Math.random().toString(36).slice(2);function Ro(t){if(!t[va]){t[va]=!0,v_.forEach(function(n){n!=="selectionchange"&&(QE.has(n)||lc(n,!1,t),lc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[va]||(e[va]=!0,lc("selectionchange",!1,e))}}function fy(t,e,n,i){switch(Z_(e)){case 1:var r=fE;break;case 4:r=gE;break;default:r=Nd}n=r.bind(null,e,n,t),r=void 0,!mh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function uc(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Bi(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}O_(function(){var u=s,c=Ad(n),h=[];e:{var d=hy.get(t);if(d!==void 0){var g=Od,f=t;switch(t){case"keypress":if(Ha(n)===0)break e;case"keydown":case"keyup":g=LE;break;case"focusin":f="focus",g=nc;break;case"focusout":f="blur",g=nc;break;case"beforeblur":case"afterblur":g=nc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=zg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=_E;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=ME;break;case ay:case ly:case uy:g=vE;break;case cy:g=NE;break;case"scroll":g=pE;break;case"wheel":g=OE;break;case"copy":case"cut":case"paste":g=wE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Bg}var _=(e&4)!==0,x=!_&&t==="scroll",m=_?d!==null?d+"Capture":null:d;_=[];for(var p=u,y;p!==null;){y=p;var v=y.stateNode;if(y.tag===5&&v!==null&&(y=v,m!==null&&(v=vo(p,m),v!=null&&_.push(Po(p,v,y)))),x)break;p=p.return}0<_.length&&(d=new g(d,f,null,n,c),h.push({event:d,listeners:_}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",d&&n!==gh&&(f=n.relatedTarget||n.fromElement)&&(Bi(f)||f[zn]))break e;if((g||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,g?(f=n.relatedTarget||n.toElement,g=u,f=f?Bi(f):null,f!==null&&(x=ur(f),f!==x||f.tag!==5&&f.tag!==6)&&(f=null)):(g=null,f=u),g!==f)){if(_=zg,v="onMouseLeave",m="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(_=Bg,v="onPointerLeave",m="onPointerEnter",p="pointer"),x=g==null?d:br(g),y=f==null?d:br(f),d=new _(v,p+"leave",g,n,c),d.target=x,d.relatedTarget=y,v=null,Bi(c)===u&&(_=new _(m,p+"enter",f,n,c),_.target=y,_.relatedTarget=x,v=_),x=v,g&&f)t:{for(_=g,m=f,p=0,y=_;y;y=_r(y))p++;for(y=0,v=m;v;v=_r(v))y++;for(;0<p-y;)_=_r(_),p--;for(;0<y-p;)m=_r(m),y--;for(;p--;){if(_===m||m!==null&&_===m.alternate)break t;_=_r(_),m=_r(m)}_=null}else _=null;g!==null&&Jg(h,d,g,_,!1),f!==null&&x!==null&&Jg(h,x,f,_,!0)}}e:{if(d=u?br(u):window,g=d.nodeName&&d.nodeName.toLowerCase(),g==="select"||g==="input"&&d.type==="file")var w=UE;else if(Wg(d))if(ny)w=YE;else{w=XE;var C=WE}else(g=d.nodeName)&&g.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=VE);if(w&&(w=w(t,u))){ty(h,w,n,c);break e}C&&C(t,d,u),t==="focusout"&&(C=d._wrapperState)&&C.controlled&&d.type==="number"&&uh(d,"number",d.value)}switch(C=u?br(u):window,t){case"focusin":(Wg(C)||C.contentEditable==="true")&&(Fr=C,Eh=u,uo=null);break;case"focusout":uo=Eh=Fr=null;break;case"mousedown":wh=!0;break;case"contextmenu":case"mouseup":case"dragend":wh=!1,Kg(h,n,c);break;case"selectionchange":if(ZE)break;case"keydown":case"keyup":Kg(h,n,c)}var R;if(jd)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Nr?Q_(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(J_&&n.locale!=="ko"&&(Nr||T!=="onCompositionStart"?T==="onCompositionEnd"&&Nr&&(R=q_()):(ai=c,Fd="value"in ai?ai.value:ai.textContent,Nr=!0)),C=fl(u,T),0<C.length&&(T=new $g(T,t,null,n,c),h.push({event:T,listeners:C}),R?T.data=R:(R=ey(n),R!==null&&(T.data=R)))),(R=jE?zE(t,n):$E(t,n))&&(u=fl(u,"onBeforeInput"),0<u.length&&(c=new $g("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=R))}dy(h,e)})}function Po(t,e,n){return{instance:t,listener:e,currentTarget:n}}function fl(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=vo(t,n),s!=null&&i.unshift(Po(t,s,r)),s=vo(t,e),s!=null&&i.push(Po(t,s,r))),t=t.return}return i}function _r(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Jg(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=vo(n,s),l!=null&&o.unshift(Po(n,l,a))):r||(l=vo(n,s),l!=null&&o.push(Po(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var e1=/\r\n?/g,t1=/\u0000|\uFFFD/g;function Qg(t){return(typeof t=="string"?t:""+t).replace(e1,`
`).replace(t1,"")}function Ea(t,e,n){if(e=Qg(e),Qg(t)!==e&&n)throw Error(M(425))}function gl(){}var Sh=null,Ch=null;function Th(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Rh=typeof setTimeout=="function"?setTimeout:void 0,n1=typeof clearTimeout=="function"?clearTimeout:void 0,ep=typeof Promise=="function"?Promise:void 0,i1=typeof queueMicrotask=="function"?queueMicrotask:typeof ep<"u"?function(t){return ep.resolve(null).then(t).catch(r1)}:Rh;function r1(t){setTimeout(function(){throw t})}function cc(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),So(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);So(e)}function mi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function tp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Cs=Math.random().toString(36).slice(2),dn="__reactFiber$"+Cs,Io="__reactProps$"+Cs,zn="__reactContainer$"+Cs,Ph="__reactEvents$"+Cs,s1="__reactListeners$"+Cs,o1="__reactHandles$"+Cs;function Bi(t){var e=t[dn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[zn]||n[dn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=tp(t);t!==null;){if(n=t[dn])return n;t=tp(t)}return e}t=n,n=t.parentNode}return null}function Qo(t){return t=t[dn]||t[zn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function br(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(M(33))}function tu(t){return t[Io]||null}var Ih=[],jr=-1;function Ii(t){return{current:t}}function fe(t){0>jr||(t.current=Ih[jr],Ih[jr]=null,jr--)}function ce(t,e){jr++,Ih[jr]=t.current,t.current=e}var Ti={},et=Ii(Ti),gt=Ii(!1),Qi=Ti;function as(t,e){var n=t.type.contextTypes;if(!n)return Ti;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function pt(t){return t=t.childContextTypes,t!=null}function pl(){fe(gt),fe(et)}function np(t,e,n){if(et.current!==Ti)throw Error(M(168));ce(et,e),ce(gt,n)}function gy(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(M(108,Wv(t)||"Unknown",r));return ve({},n,i)}function ml(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ti,Qi=et.current,ce(et,t),ce(gt,gt.current),!0}function ip(t,e,n){var i=t.stateNode;if(!i)throw Error(M(169));n?(t=gy(t,e,Qi),i.__reactInternalMemoizedMergedChildContext=t,fe(gt),fe(et),ce(et,t)):fe(gt),ce(gt,n)}var Ln=null,nu=!1,hc=!1;function py(t){Ln===null?Ln=[t]:Ln.push(t)}function a1(t){nu=!0,py(t)}function Li(){if(!hc&&Ln!==null){hc=!0;var t=0,e=le;try{var n=Ln;for(le=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Ln=null,nu=!1}catch(r){throw Ln!==null&&(Ln=Ln.slice(t+1)),$_(kd,Li),r}finally{le=e,hc=!1}}return null}var zr=[],$r=0,_l=null,yl=0,Nt=[],Ft=0,er=null,Mn=1,Dn="";function bi(t,e){zr[$r++]=yl,zr[$r++]=_l,_l=t,yl=e}function my(t,e,n){Nt[Ft++]=Mn,Nt[Ft++]=Dn,Nt[Ft++]=er,er=t;var i=Mn;t=Dn;var r=32-Jt(i)-1;i&=~(1<<r),n+=1;var s=32-Jt(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Mn=1<<32-Jt(e)+r|n<<r|i,Dn=s+t}else Mn=1<<s|n<<r|i,Dn=t}function $d(t){t.return!==null&&(bi(t,1),my(t,1,0))}function Bd(t){for(;t===_l;)_l=zr[--$r],zr[$r]=null,yl=zr[--$r],zr[$r]=null;for(;t===er;)er=Nt[--Ft],Nt[Ft]=null,Dn=Nt[--Ft],Nt[Ft]=null,Mn=Nt[--Ft],Nt[Ft]=null}var St=null,Et=null,pe=!1,qt=null;function _y(t,e){var n=jt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function rp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,St=t,Et=mi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,St=t,Et=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=er!==null?{id:Mn,overflow:Dn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=jt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,St=t,Et=null,!0):!1;default:return!1}}function Lh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ah(t){if(pe){var e=Et;if(e){var n=e;if(!rp(t,e)){if(Lh(t))throw Error(M(418));e=mi(n.nextSibling);var i=St;e&&rp(t,e)?_y(i,n):(t.flags=t.flags&-4097|2,pe=!1,St=t)}}else{if(Lh(t))throw Error(M(418));t.flags=t.flags&-4097|2,pe=!1,St=t}}}function sp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;St=t}function wa(t){if(t!==St)return!1;if(!pe)return sp(t),pe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Th(t.type,t.memoizedProps)),e&&(e=Et)){if(Lh(t))throw yy(),Error(M(418));for(;e;)_y(t,e),e=mi(e.nextSibling)}if(sp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(M(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Et=mi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Et=null}}else Et=St?mi(t.stateNode.nextSibling):null;return!0}function yy(){for(var t=Et;t;)t=mi(t.nextSibling)}function ls(){Et=St=null,pe=!1}function Gd(t){qt===null?qt=[t]:qt.push(t)}var l1=Un.ReactCurrentBatchConfig;function Bs(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(M(309));var i=n.stateNode}if(!i)throw Error(M(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(M(284));if(!n._owner)throw Error(M(290,t))}return t}function Sa(t,e){throw t=Object.prototype.toString.call(e),Error(M(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function op(t){var e=t._init;return e(t._payload)}function xy(t){function e(m,p){if(t){var y=m.deletions;y===null?(m.deletions=[p],m.flags|=16):y.push(p)}}function n(m,p){if(!t)return null;for(;p!==null;)e(m,p),p=p.sibling;return null}function i(m,p){for(m=new Map;p!==null;)p.key!==null?m.set(p.key,p):m.set(p.index,p),p=p.sibling;return m}function r(m,p){return m=vi(m,p),m.index=0,m.sibling=null,m}function s(m,p,y){return m.index=y,t?(y=m.alternate,y!==null?(y=y.index,y<p?(m.flags|=2,p):y):(m.flags|=2,p)):(m.flags|=1048576,p)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,p,y,v){return p===null||p.tag!==6?(p=yc(y,m.mode,v),p.return=m,p):(p=r(p,y),p.return=m,p)}function l(m,p,y,v){var w=y.type;return w===Dr?c(m,p,y.props.children,v,y.key):p!==null&&(p.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===ni&&op(w)===p.type)?(v=r(p,y.props),v.ref=Bs(m,p,y),v.return=m,v):(v=tl(y.type,y.key,y.props,null,m.mode,v),v.ref=Bs(m,p,y),v.return=m,v)}function u(m,p,y,v){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=xc(y,m.mode,v),p.return=m,p):(p=r(p,y.children||[]),p.return=m,p)}function c(m,p,y,v,w){return p===null||p.tag!==7?(p=Zi(y,m.mode,v,w),p.return=m,p):(p=r(p,y),p.return=m,p)}function h(m,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=yc(""+p,m.mode,y),p.return=m,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case da:return y=tl(p.type,p.key,p.props,null,m.mode,y),y.ref=Bs(m,null,p),y.return=m,y;case Mr:return p=xc(p,m.mode,y),p.return=m,p;case ni:var v=p._init;return h(m,v(p._payload),y)}if(Zs(p)||Os(p))return p=Zi(p,m.mode,y,null),p.return=m,p;Sa(m,p)}return null}function d(m,p,y,v){var w=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return w!==null?null:a(m,p,""+y,v);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case da:return y.key===w?l(m,p,y,v):null;case Mr:return y.key===w?u(m,p,y,v):null;case ni:return w=y._init,d(m,p,w(y._payload),v)}if(Zs(y)||Os(y))return w!==null?null:c(m,p,y,v,null);Sa(m,y)}return null}function g(m,p,y,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return m=m.get(y)||null,a(p,m,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case da:return m=m.get(v.key===null?y:v.key)||null,l(p,m,v,w);case Mr:return m=m.get(v.key===null?y:v.key)||null,u(p,m,v,w);case ni:var C=v._init;return g(m,p,y,C(v._payload),w)}if(Zs(v)||Os(v))return m=m.get(y)||null,c(p,m,v,w,null);Sa(p,v)}return null}function f(m,p,y,v){for(var w=null,C=null,R=p,T=p=0,I=null;R!==null&&T<y.length;T++){R.index>T?(I=R,R=null):I=R.sibling;var A=d(m,R,y[T],v);if(A===null){R===null&&(R=I);break}t&&R&&A.alternate===null&&e(m,R),p=s(A,p,T),C===null?w=A:C.sibling=A,C=A,R=I}if(T===y.length)return n(m,R),pe&&bi(m,T),w;if(R===null){for(;T<y.length;T++)R=h(m,y[T],v),R!==null&&(p=s(R,p,T),C===null?w=R:C.sibling=R,C=R);return pe&&bi(m,T),w}for(R=i(m,R);T<y.length;T++)I=g(R,m,T,y[T],v),I!==null&&(t&&I.alternate!==null&&R.delete(I.key===null?T:I.key),p=s(I,p,T),C===null?w=I:C.sibling=I,C=I);return t&&R.forEach(function(j){return e(m,j)}),pe&&bi(m,T),w}function _(m,p,y,v){var w=Os(y);if(typeof w!="function")throw Error(M(150));if(y=w.call(y),y==null)throw Error(M(151));for(var C=w=null,R=p,T=p=0,I=null,A=y.next();R!==null&&!A.done;T++,A=y.next()){R.index>T?(I=R,R=null):I=R.sibling;var j=d(m,R,A.value,v);if(j===null){R===null&&(R=I);break}t&&R&&j.alternate===null&&e(m,R),p=s(j,p,T),C===null?w=j:C.sibling=j,C=j,R=I}if(A.done)return n(m,R),pe&&bi(m,T),w;if(R===null){for(;!A.done;T++,A=y.next())A=h(m,A.value,v),A!==null&&(p=s(A,p,T),C===null?w=A:C.sibling=A,C=A);return pe&&bi(m,T),w}for(R=i(m,R);!A.done;T++,A=y.next())A=g(R,m,T,A.value,v),A!==null&&(t&&A.alternate!==null&&R.delete(A.key===null?T:A.key),p=s(A,p,T),C===null?w=A:C.sibling=A,C=A);return t&&R.forEach(function(b){return e(m,b)}),pe&&bi(m,T),w}function x(m,p,y,v){if(typeof y=="object"&&y!==null&&y.type===Dr&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case da:e:{for(var w=y.key,C=p;C!==null;){if(C.key===w){if(w=y.type,w===Dr){if(C.tag===7){n(m,C.sibling),p=r(C,y.props.children),p.return=m,m=p;break e}}else if(C.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===ni&&op(w)===C.type){n(m,C.sibling),p=r(C,y.props),p.ref=Bs(m,C,y),p.return=m,m=p;break e}n(m,C);break}else e(m,C);C=C.sibling}y.type===Dr?(p=Zi(y.props.children,m.mode,v,y.key),p.return=m,m=p):(v=tl(y.type,y.key,y.props,null,m.mode,v),v.ref=Bs(m,p,y),v.return=m,m=v)}return o(m);case Mr:e:{for(C=y.key;p!==null;){if(p.key===C)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){n(m,p.sibling),p=r(p,y.children||[]),p.return=m,m=p;break e}else{n(m,p);break}else e(m,p);p=p.sibling}p=xc(y,m.mode,v),p.return=m,m=p}return o(m);case ni:return C=y._init,x(m,p,C(y._payload),v)}if(Zs(y))return f(m,p,y,v);if(Os(y))return _(m,p,y,v);Sa(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(n(m,p.sibling),p=r(p,y),p.return=m,m=p):(n(m,p),p=yc(y,m.mode,v),p.return=m,m=p),o(m)):n(m,p)}return x}var us=xy(!0),vy=xy(!1),xl=Ii(null),vl=null,Br=null,Ud=null;function Wd(){Ud=Br=vl=null}function Xd(t){var e=xl.current;fe(xl),t._currentValue=e}function kh(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Jr(t,e){vl=t,Ud=Br=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ft=!0),t.firstContext=null)}function Wt(t){var e=t._currentValue;if(Ud!==t)if(t={context:t,memoizedValue:e,next:null},Br===null){if(vl===null)throw Error(M(308));Br=t,vl.dependencies={lanes:0,firstContext:t}}else Br=Br.next=t;return e}var Gi=null;function Vd(t){Gi===null?Gi=[t]:Gi.push(t)}function Ey(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,Vd(e)):(n.next=r.next,r.next=n),e.interleaved=n,$n(t,i)}function $n(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ii=!1;function Yd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Nn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _i(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,ne&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,$n(t,n)}return r=i.interleaved,r===null?(e.next=e,Vd(i)):(e.next=r.next,r.next=e),i.interleaved=e,$n(t,n)}function Ka(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Md(t,n)}}function ap(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function El(t,e,n,i){var r=t.updateQueue;ii=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=r.baseState;o=0,c=u=l=null,a=s;do{var d=a.lane,g=a.eventTime;if((i&d)===d){c!==null&&(c=c.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=t,_=a;switch(d=e,g=n,_.tag){case 1:if(f=_.payload,typeof f=="function"){h=f.call(g,h,d);break e}h=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=_.payload,d=typeof f=="function"?f.call(g,h,d):f,d==null)break e;h=ve({},h,d);break e;case 2:ii=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else g={eventTime:g,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=g,l=h):c=c.next=g,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(!0);if(c===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);nr|=o,t.lanes=o,t.memoizedState=h}}function lp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(M(191,r));r.call(i)}}}var ea={},_n=Ii(ea),Lo=Ii(ea),Ao=Ii(ea);function Ui(t){if(t===ea)throw Error(M(174));return t}function Hd(t,e){switch(ce(Ao,e),ce(Lo,t),ce(_n,ea),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=hh(e,t)}fe(_n),ce(_n,e)}function cs(){fe(_n),fe(Lo),fe(Ao)}function Sy(t){Ui(Ao.current);var e=Ui(_n.current),n=hh(e,t.type);e!==n&&(ce(Lo,t),ce(_n,n))}function Kd(t){Lo.current===t&&(fe(_n),fe(Lo))}var ye=Ii(0);function wl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dc=[];function Zd(){for(var t=0;t<dc.length;t++)dc[t]._workInProgressVersionPrimary=null;dc.length=0}var Za=Un.ReactCurrentDispatcher,fc=Un.ReactCurrentBatchConfig,tr=0,xe=null,Ne=null,$e=null,Sl=!1,co=!1,ko=0,u1=0;function Ke(){throw Error(M(321))}function qd(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!en(t[n],e[n]))return!1;return!0}function Jd(t,e,n,i,r,s){if(tr=s,xe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Za.current=t===null||t.memoizedState===null?f1:g1,t=n(i,r),co){s=0;do{if(co=!1,ko=0,25<=s)throw Error(M(301));s+=1,$e=Ne=null,e.updateQueue=null,Za.current=p1,t=n(i,r)}while(co)}if(Za.current=Cl,e=Ne!==null&&Ne.next!==null,tr=0,$e=Ne=xe=null,Sl=!1,e)throw Error(M(300));return t}function Qd(){var t=ko!==0;return ko=0,t}function cn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $e===null?xe.memoizedState=$e=t:$e=$e.next=t,$e}function Xt(){if(Ne===null){var t=xe.alternate;t=t!==null?t.memoizedState:null}else t=Ne.next;var e=$e===null?xe.memoizedState:$e.next;if(e!==null)$e=e,Ne=t;else{if(t===null)throw Error(M(310));Ne=t,t={memoizedState:Ne.memoizedState,baseState:Ne.baseState,baseQueue:Ne.baseQueue,queue:Ne.queue,next:null},$e===null?xe.memoizedState=$e=t:$e=$e.next=t}return $e}function Mo(t,e){return typeof e=="function"?e(t):e}function gc(t){var e=Xt(),n=e.queue;if(n===null)throw Error(M(311));n.lastRenderedReducer=t;var i=Ne,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((tr&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=i):l=l.next=h,xe.lanes|=c,nr|=c}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,en(i,e.memoizedState)||(ft=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,xe.lanes|=s,nr|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function pc(t){var e=Xt(),n=e.queue;if(n===null)throw Error(M(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);en(s,e.memoizedState)||(ft=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function Cy(){}function Ty(t,e){var n=xe,i=Xt(),r=e(),s=!en(i.memoizedState,r);if(s&&(i.memoizedState=r,ft=!0),i=i.queue,ef(Iy.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||$e!==null&&$e.memoizedState.tag&1){if(n.flags|=2048,Do(9,Py.bind(null,n,i,r,e),void 0,null),We===null)throw Error(M(349));tr&30||Ry(n,e,r)}return r}function Ry(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=xe.updateQueue,e===null?(e={lastEffect:null,stores:null},xe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Py(t,e,n,i){e.value=n,e.getSnapshot=i,Ly(e)&&Ay(t)}function Iy(t,e,n){return n(function(){Ly(e)&&Ay(t)})}function Ly(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!en(t,n)}catch{return!0}}function Ay(t){var e=$n(t,1);e!==null&&Qt(e,t,1,-1)}function up(t){var e=cn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:t},e.queue=t,t=t.dispatch=d1.bind(null,xe,t),[e.memoizedState,t]}function Do(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=xe.updateQueue,e===null?(e={lastEffect:null,stores:null},xe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function ky(){return Xt().memoizedState}function qa(t,e,n,i){var r=cn();xe.flags|=t,r.memoizedState=Do(1|e,n,void 0,i===void 0?null:i)}function iu(t,e,n,i){var r=Xt();i=i===void 0?null:i;var s=void 0;if(Ne!==null){var o=Ne.memoizedState;if(s=o.destroy,i!==null&&qd(i,o.deps)){r.memoizedState=Do(e,n,s,i);return}}xe.flags|=t,r.memoizedState=Do(1|e,n,s,i)}function cp(t,e){return qa(8390656,8,t,e)}function ef(t,e){return iu(2048,8,t,e)}function My(t,e){return iu(4,2,t,e)}function Dy(t,e){return iu(4,4,t,e)}function Ny(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Fy(t,e,n){return n=n!=null?n.concat([t]):null,iu(4,4,Ny.bind(null,e,t),n)}function tf(){}function Oy(t,e){var n=Xt();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&qd(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function by(t,e){var n=Xt();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&qd(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function jy(t,e,n){return tr&21?(en(n,e)||(n=U_(),xe.lanes|=n,nr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ft=!0),t.memoizedState=n)}function c1(t,e){var n=le;le=n!==0&&4>n?n:4,t(!0);var i=fc.transition;fc.transition={};try{t(!1),e()}finally{le=n,fc.transition=i}}function zy(){return Xt().memoizedState}function h1(t,e,n){var i=xi(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},$y(t))By(e,n);else if(n=Ey(t,e,n,i),n!==null){var r=ot();Qt(n,t,i,r),Gy(n,e,i)}}function d1(t,e,n){var i=xi(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if($y(t))By(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,en(a,o)){var l=e.interleaved;l===null?(r.next=r,Vd(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=Ey(t,e,r,i),n!==null&&(r=ot(),Qt(n,t,i,r),Gy(n,e,i))}}function $y(t){var e=t.alternate;return t===xe||e!==null&&e===xe}function By(t,e){co=Sl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Gy(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Md(t,n)}}var Cl={readContext:Wt,useCallback:Ke,useContext:Ke,useEffect:Ke,useImperativeHandle:Ke,useInsertionEffect:Ke,useLayoutEffect:Ke,useMemo:Ke,useReducer:Ke,useRef:Ke,useState:Ke,useDebugValue:Ke,useDeferredValue:Ke,useTransition:Ke,useMutableSource:Ke,useSyncExternalStore:Ke,useId:Ke,unstable_isNewReconciler:!1},f1={readContext:Wt,useCallback:function(t,e){return cn().memoizedState=[t,e===void 0?null:e],t},useContext:Wt,useEffect:cp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,qa(4194308,4,Ny.bind(null,e,t),n)},useLayoutEffect:function(t,e){return qa(4194308,4,t,e)},useInsertionEffect:function(t,e){return qa(4,2,t,e)},useMemo:function(t,e){var n=cn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=cn();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=h1.bind(null,xe,t),[i.memoizedState,t]},useRef:function(t){var e=cn();return t={current:t},e.memoizedState=t},useState:up,useDebugValue:tf,useDeferredValue:function(t){return cn().memoizedState=t},useTransition:function(){var t=up(!1),e=t[0];return t=c1.bind(null,t[1]),cn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=xe,r=cn();if(pe){if(n===void 0)throw Error(M(407));n=n()}else{if(n=e(),We===null)throw Error(M(349));tr&30||Ry(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,cp(Iy.bind(null,i,s,t),[t]),i.flags|=2048,Do(9,Py.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=cn(),e=We.identifierPrefix;if(pe){var n=Dn,i=Mn;n=(i&~(1<<32-Jt(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=ko++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=u1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},g1={readContext:Wt,useCallback:Oy,useContext:Wt,useEffect:ef,useImperativeHandle:Fy,useInsertionEffect:My,useLayoutEffect:Dy,useMemo:by,useReducer:gc,useRef:ky,useState:function(){return gc(Mo)},useDebugValue:tf,useDeferredValue:function(t){var e=Xt();return jy(e,Ne.memoizedState,t)},useTransition:function(){var t=gc(Mo)[0],e=Xt().memoizedState;return[t,e]},useMutableSource:Cy,useSyncExternalStore:Ty,useId:zy,unstable_isNewReconciler:!1},p1={readContext:Wt,useCallback:Oy,useContext:Wt,useEffect:ef,useImperativeHandle:Fy,useInsertionEffect:My,useLayoutEffect:Dy,useMemo:by,useReducer:pc,useRef:ky,useState:function(){return pc(Mo)},useDebugValue:tf,useDeferredValue:function(t){var e=Xt();return Ne===null?e.memoizedState=t:jy(e,Ne.memoizedState,t)},useTransition:function(){var t=pc(Mo)[0],e=Xt().memoizedState;return[t,e]},useMutableSource:Cy,useSyncExternalStore:Ty,useId:zy,unstable_isNewReconciler:!1};function Kt(t,e){if(t&&t.defaultProps){e=ve({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Mh(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:ve({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ru={isMounted:function(t){return(t=t._reactInternals)?ur(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=ot(),r=xi(t),s=Nn(i,r);s.payload=e,n!=null&&(s.callback=n),e=_i(t,s,r),e!==null&&(Qt(e,t,r,i),Ka(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=ot(),r=xi(t),s=Nn(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=_i(t,s,r),e!==null&&(Qt(e,t,r,i),Ka(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ot(),i=xi(t),r=Nn(n,i);r.tag=2,e!=null&&(r.callback=e),e=_i(t,r,i),e!==null&&(Qt(e,t,i,n),Ka(e,t,i))}};function hp(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!To(n,i)||!To(r,s):!0}function Uy(t,e,n){var i=!1,r=Ti,s=e.contextType;return typeof s=="object"&&s!==null?s=Wt(s):(r=pt(e)?Qi:et.current,i=e.contextTypes,s=(i=i!=null)?as(t,r):Ti),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ru,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function dp(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&ru.enqueueReplaceState(e,e.state,null)}function Dh(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},Yd(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Wt(s):(s=pt(e)?Qi:et.current,r.context=as(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Mh(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&ru.enqueueReplaceState(r,r.state,null),El(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function hs(t,e){try{var n="",i=e;do n+=Uv(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function mc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Nh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var m1=typeof WeakMap=="function"?WeakMap:Map;function Wy(t,e,n){n=Nn(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Rl||(Rl=!0,Wh=i),Nh(t,e)},n}function Xy(t,e,n){n=Nn(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){Nh(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Nh(t,e),typeof i!="function"&&(yi===null?yi=new Set([this]):yi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function fp(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new m1;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=A1.bind(null,t,e,n),e.then(t,t))}function gp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function pp(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Nn(-1,1),e.tag=2,_i(n,e,1))),n.lanes|=1),t)}var _1=Un.ReactCurrentOwner,ft=!1;function nt(t,e,n,i){e.child=t===null?vy(e,null,n,i):us(e,t.child,n,i)}function mp(t,e,n,i,r){n=n.render;var s=e.ref;return Jr(e,r),i=Jd(t,e,n,i,s,r),n=Qd(),t!==null&&!ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Bn(t,e,r)):(pe&&n&&$d(e),e.flags|=1,nt(t,e,i,r),e.child)}function _p(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!cf(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Vy(t,e,s,i,r)):(t=tl(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:To,n(o,i)&&t.ref===e.ref)return Bn(t,e,r)}return e.flags|=1,t=vi(s,i),t.ref=e.ref,t.return=e,e.child=t}function Vy(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(To(s,i)&&t.ref===e.ref)if(ft=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(ft=!0);else return e.lanes=t.lanes,Bn(t,e,r)}return Fh(t,e,n,i,r)}function Yy(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ce(Ur,vt),vt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ce(Ur,vt),vt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,ce(Ur,vt),vt|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,ce(Ur,vt),vt|=i;return nt(t,e,r,n),e.child}function Hy(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Fh(t,e,n,i,r){var s=pt(n)?Qi:et.current;return s=as(e,s),Jr(e,r),n=Jd(t,e,n,i,s,r),i=Qd(),t!==null&&!ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Bn(t,e,r)):(pe&&i&&$d(e),e.flags|=1,nt(t,e,n,r),e.child)}function yp(t,e,n,i,r){if(pt(n)){var s=!0;ml(e)}else s=!1;if(Jr(e,r),e.stateNode===null)Ja(t,e),Uy(e,n,i),Dh(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Wt(u):(u=pt(n)?Qi:et.current,u=as(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&dp(e,o,i,u),ii=!1;var d=e.memoizedState;o.state=d,El(e,i,o,r),l=e.memoizedState,a!==i||d!==l||gt.current||ii?(typeof c=="function"&&(Mh(e,n,c,i),l=e.memoizedState),(a=ii||hp(e,n,a,i,d,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,wy(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Kt(e.type,a),o.props=u,h=e.pendingProps,d=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Wt(l):(l=pt(n)?Qi:et.current,l=as(e,l));var g=n.getDerivedStateFromProps;(c=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&dp(e,o,i,l),ii=!1,d=e.memoizedState,o.state=d,El(e,i,o,r);var f=e.memoizedState;a!==h||d!==f||gt.current||ii?(typeof g=="function"&&(Mh(e,n,g,i),f=e.memoizedState),(u=ii||hp(e,n,u,i,d,f,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,f,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,f,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=f),o.props=i,o.state=f,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return Oh(t,e,n,i,s,r)}function Oh(t,e,n,i,r,s){Hy(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&ip(e,n,!1),Bn(t,e,s);i=e.stateNode,_1.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=us(e,t.child,null,s),e.child=us(e,null,a,s)):nt(t,e,a,s),e.memoizedState=i.state,r&&ip(e,n,!0),e.child}function Ky(t){var e=t.stateNode;e.pendingContext?np(t,e.pendingContext,e.pendingContext!==e.context):e.context&&np(t,e.context,!1),Hd(t,e.containerInfo)}function xp(t,e,n,i,r){return ls(),Gd(r),e.flags|=256,nt(t,e,n,i),e.child}var bh={dehydrated:null,treeContext:null,retryLane:0};function jh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Zy(t,e,n){var i=e.pendingProps,r=ye.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),ce(ye,r&1),t===null)return Ah(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=au(o,i,0,null),t=Zi(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=jh(n),e.memoizedState=bh,t):nf(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return y1(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=vi(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=vi(a,s):(s=Zi(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?jh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=bh,i}return s=t.child,t=s.sibling,i=vi(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function nf(t,e){return e=au({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ca(t,e,n,i){return i!==null&&Gd(i),us(e,t.child,null,n),t=nf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function y1(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=mc(Error(M(422))),Ca(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=au({mode:"visible",children:i.children},r,0,null),s=Zi(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&us(e,t.child,null,o),e.child.memoizedState=jh(o),e.memoizedState=bh,s);if(!(e.mode&1))return Ca(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(M(419)),i=mc(s,i,void 0),Ca(t,e,o,i)}if(a=(o&t.childLanes)!==0,ft||a){if(i=We,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,$n(t,r),Qt(i,t,r,-1))}return uf(),i=mc(Error(M(421))),Ca(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=k1.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,Et=mi(r.nextSibling),St=e,pe=!0,qt=null,t!==null&&(Nt[Ft++]=Mn,Nt[Ft++]=Dn,Nt[Ft++]=er,Mn=t.id,Dn=t.overflow,er=e),e=nf(e,i.children),e.flags|=4096,e)}function vp(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),kh(t.return,e,n)}function _c(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function qy(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(nt(t,e,i.children,n),i=ye.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vp(t,n,e);else if(t.tag===19)vp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(ce(ye,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&wl(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),_c(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&wl(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}_c(e,!0,n,null,s);break;case"together":_c(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ja(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Bn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),nr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(M(153));if(e.child!==null){for(t=e.child,n=vi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function x1(t,e,n){switch(e.tag){case 3:Ky(e),ls();break;case 5:Sy(e);break;case 1:pt(e.type)&&ml(e);break;case 4:Hd(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;ce(xl,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(ce(ye,ye.current&1),e.flags|=128,null):n&e.child.childLanes?Zy(t,e,n):(ce(ye,ye.current&1),t=Bn(t,e,n),t!==null?t.sibling:null);ce(ye,ye.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return qy(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),ce(ye,ye.current),i)break;return null;case 22:case 23:return e.lanes=0,Yy(t,e,n)}return Bn(t,e,n)}var Jy,zh,Qy,e0;Jy=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zh=function(){};Qy=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Ui(_n.current);var s=null;switch(n){case"input":r=ah(t,r),i=ah(t,i),s=[];break;case"select":r=ve({},r,{value:void 0}),i=ve({},i,{value:void 0}),s=[];break;case"textarea":r=ch(t,r),i=ch(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=gl)}dh(n,i);var o;n=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(yo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(yo.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&de("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};e0=function(t,e,n,i){n!==i&&(e.flags|=4)};function Gs(t,e){if(!pe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ze(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function v1(t,e,n){var i=e.pendingProps;switch(Bd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(e),null;case 1:return pt(e.type)&&pl(),Ze(e),null;case 3:return i=e.stateNode,cs(),fe(gt),fe(et),Zd(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(wa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,qt!==null&&(Yh(qt),qt=null))),zh(t,e),Ze(e),null;case 5:Kd(e);var r=Ui(Ao.current);if(n=e.type,t!==null&&e.stateNode!=null)Qy(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(M(166));return Ze(e),null}if(t=Ui(_n.current),wa(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[dn]=e,i[Io]=s,t=(e.mode&1)!==0,n){case"dialog":de("cancel",i),de("close",i);break;case"iframe":case"object":case"embed":de("load",i);break;case"video":case"audio":for(r=0;r<Js.length;r++)de(Js[r],i);break;case"source":de("error",i);break;case"img":case"image":case"link":de("error",i),de("load",i);break;case"details":de("toggle",i);break;case"input":Lg(i,s),de("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},de("invalid",i);break;case"textarea":kg(i,s),de("invalid",i)}dh(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ea(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ea(i.textContent,a,t),r=["children",""+a]):yo.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&de("scroll",i)}switch(n){case"input":fa(i),Ag(i,s,!0);break;case"textarea":fa(i),Mg(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=gl)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=I_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[dn]=e,t[Io]=i,Jy(t,e,!1,!1),e.stateNode=t;e:{switch(o=fh(n,i),n){case"dialog":de("cancel",t),de("close",t),r=i;break;case"iframe":case"object":case"embed":de("load",t),r=i;break;case"video":case"audio":for(r=0;r<Js.length;r++)de(Js[r],t);r=i;break;case"source":de("error",t),r=i;break;case"img":case"image":case"link":de("error",t),de("load",t),r=i;break;case"details":de("toggle",t),r=i;break;case"input":Lg(t,i),r=ah(t,i),de("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=ve({},i,{value:void 0}),de("invalid",t);break;case"textarea":kg(t,i),r=ch(t,i),de("invalid",t);break;default:r=i}dh(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?k_(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&L_(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&xo(t,l):typeof l=="number"&&xo(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(yo.hasOwnProperty(s)?l!=null&&s==="onScroll"&&de("scroll",t):l!=null&&Rd(t,s,l,o))}switch(n){case"input":fa(t),Ag(t,i,!1);break;case"textarea":fa(t),Mg(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Ci(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?Hr(t,!!i.multiple,s,!1):i.defaultValue!=null&&Hr(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=gl)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ze(e),null;case 6:if(t&&e.stateNode!=null)e0(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(M(166));if(n=Ui(Ao.current),Ui(_n.current),wa(e)){if(i=e.stateNode,n=e.memoizedProps,i[dn]=e,(s=i.nodeValue!==n)&&(t=St,t!==null))switch(t.tag){case 3:Ea(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ea(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[dn]=e,e.stateNode=i}return Ze(e),null;case 13:if(fe(ye),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(pe&&Et!==null&&e.mode&1&&!(e.flags&128))yy(),ls(),e.flags|=98560,s=!1;else if(s=wa(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(M(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(M(317));s[dn]=e}else ls(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ze(e),s=!1}else qt!==null&&(Yh(qt),qt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||ye.current&1?Oe===0&&(Oe=3):uf())),e.updateQueue!==null&&(e.flags|=4),Ze(e),null);case 4:return cs(),zh(t,e),t===null&&Ro(e.stateNode.containerInfo),Ze(e),null;case 10:return Xd(e.type._context),Ze(e),null;case 17:return pt(e.type)&&pl(),Ze(e),null;case 19:if(fe(ye),s=e.memoizedState,s===null)return Ze(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Gs(s,!1);else{if(Oe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=wl(t),o!==null){for(e.flags|=128,Gs(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ce(ye,ye.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ie()>ds&&(e.flags|=128,i=!0,Gs(s,!1),e.lanes=4194304)}else{if(!i)if(t=wl(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!pe)return Ze(e),null}else 2*Ie()-s.renderingStartTime>ds&&n!==1073741824&&(e.flags|=128,i=!0,Gs(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ie(),e.sibling=null,n=ye.current,ce(ye,i?n&1|2:n&1),e):(Ze(e),null);case 22:case 23:return lf(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?vt&1073741824&&(Ze(e),e.subtreeFlags&6&&(e.flags|=8192)):Ze(e),null;case 24:return null;case 25:return null}throw Error(M(156,e.tag))}function E1(t,e){switch(Bd(e),e.tag){case 1:return pt(e.type)&&pl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return cs(),fe(gt),fe(et),Zd(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Kd(e),null;case 13:if(fe(ye),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(M(340));ls()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return fe(ye),null;case 4:return cs(),null;case 10:return Xd(e.type._context),null;case 22:case 23:return lf(),null;case 24:return null;default:return null}}var Ta=!1,Qe=!1,w1=typeof WeakSet=="function"?WeakSet:Set,O=null;function Gr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Se(t,e,i)}else n.current=null}function $h(t,e,n){try{n()}catch(i){Se(t,e,i)}}var Ep=!1;function S1(t,e){if(Sh=hl,t=sy(),zd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=t,d=null;t:for(;;){for(var g;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==s||i!==0&&h.nodeType!==3||(l=o+i),h.nodeType===3&&(o+=h.nodeValue.length),(g=h.firstChild)!==null;)d=h,h=g;for(;;){if(h===t)break t;if(d===n&&++u===r&&(a=o),d===s&&++c===i&&(l=o),(g=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ch={focusedElem:t,selectionRange:n},hl=!1,O=e;O!==null;)if(e=O,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,O=t;else for(;O!==null;){e=O;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var _=f.memoizedProps,x=f.memoizedState,m=e.stateNode,p=m.getSnapshotBeforeUpdate(e.elementType===e.type?_:Kt(e.type,_),x);m.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(M(163))}}catch(v){Se(e,e.return,v)}if(t=e.sibling,t!==null){t.return=e.return,O=t;break}O=e.return}return f=Ep,Ep=!1,f}function ho(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&$h(e,n,s)}r=r.next}while(r!==i)}}function su(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function Bh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function t0(t){var e=t.alternate;e!==null&&(t.alternate=null,t0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[dn],delete e[Io],delete e[Ph],delete e[s1],delete e[o1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function n0(t){return t.tag===5||t.tag===3||t.tag===4}function wp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||n0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Gh(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=gl));else if(i!==4&&(t=t.child,t!==null))for(Gh(t,e,n),t=t.sibling;t!==null;)Gh(t,e,n),t=t.sibling}function Uh(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(Uh(t,e,n),t=t.sibling;t!==null;)Uh(t,e,n),t=t.sibling}var Ve=null,Zt=!1;function Yn(t,e,n){for(n=n.child;n!==null;)i0(t,e,n),n=n.sibling}function i0(t,e,n){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(ql,n)}catch{}switch(n.tag){case 5:Qe||Gr(n,e);case 6:var i=Ve,r=Zt;Ve=null,Yn(t,e,n),Ve=i,Zt=r,Ve!==null&&(Zt?(t=Ve,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ve.removeChild(n.stateNode));break;case 18:Ve!==null&&(Zt?(t=Ve,n=n.stateNode,t.nodeType===8?cc(t.parentNode,n):t.nodeType===1&&cc(t,n),So(t)):cc(Ve,n.stateNode));break;case 4:i=Ve,r=Zt,Ve=n.stateNode.containerInfo,Zt=!0,Yn(t,e,n),Ve=i,Zt=r;break;case 0:case 11:case 14:case 15:if(!Qe&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&$h(n,e,o),r=r.next}while(r!==i)}Yn(t,e,n);break;case 1:if(!Qe&&(Gr(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Se(n,e,a)}Yn(t,e,n);break;case 21:Yn(t,e,n);break;case 22:n.mode&1?(Qe=(i=Qe)||n.memoizedState!==null,Yn(t,e,n),Qe=i):Yn(t,e,n);break;default:Yn(t,e,n)}}function Sp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new w1),e.forEach(function(i){var r=M1.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Yt(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ve=a.stateNode,Zt=!1;break e;case 3:Ve=a.stateNode.containerInfo,Zt=!0;break e;case 4:Ve=a.stateNode.containerInfo,Zt=!0;break e}a=a.return}if(Ve===null)throw Error(M(160));i0(s,o,r),Ve=null,Zt=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Se(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)r0(e,t),e=e.sibling}function r0(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Yt(e,t),ln(t),i&4){try{ho(3,t,t.return),su(3,t)}catch(_){Se(t,t.return,_)}try{ho(5,t,t.return)}catch(_){Se(t,t.return,_)}}break;case 1:Yt(e,t),ln(t),i&512&&n!==null&&Gr(n,n.return);break;case 5:if(Yt(e,t),ln(t),i&512&&n!==null&&Gr(n,n.return),t.flags&32){var r=t.stateNode;try{xo(r,"")}catch(_){Se(t,t.return,_)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&R_(r,s),fh(a,o);var u=fh(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?k_(r,h):c==="dangerouslySetInnerHTML"?L_(r,h):c==="children"?xo(r,h):Rd(r,c,h,u)}switch(a){case"input":lh(r,s);break;case"textarea":P_(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Hr(r,!!s.multiple,g,!1):d!==!!s.multiple&&(s.defaultValue!=null?Hr(r,!!s.multiple,s.defaultValue,!0):Hr(r,!!s.multiple,s.multiple?[]:"",!1))}r[Io]=s}catch(_){Se(t,t.return,_)}}break;case 6:if(Yt(e,t),ln(t),i&4){if(t.stateNode===null)throw Error(M(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(_){Se(t,t.return,_)}}break;case 3:if(Yt(e,t),ln(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{So(e.containerInfo)}catch(_){Se(t,t.return,_)}break;case 4:Yt(e,t),ln(t);break;case 13:Yt(e,t),ln(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(of=Ie())),i&4&&Sp(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Qe=(u=Qe)||c,Yt(e,t),Qe=u):Yt(e,t),ln(t),i&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(O=t,c=t.child;c!==null;){for(h=O=c;O!==null;){switch(d=O,g=d.child,d.tag){case 0:case 11:case 14:case 15:ho(4,d,d.return);break;case 1:Gr(d,d.return);var f=d.stateNode;if(typeof f.componentWillUnmount=="function"){i=d,n=d.return;try{e=i,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(_){Se(i,n,_)}}break;case 5:Gr(d,d.return);break;case 22:if(d.memoizedState!==null){Tp(h);continue}}g!==null?(g.return=d,O=g):Tp(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{r=h.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=A_("display",o))}catch(_){Se(t,t.return,_)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(_){Se(t,t.return,_)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Yt(e,t),ln(t),i&4&&Sp(t);break;case 21:break;default:Yt(e,t),ln(t)}}function ln(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(n0(n)){var i=n;break e}n=n.return}throw Error(M(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(xo(r,""),i.flags&=-33);var s=wp(t);Uh(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=wp(t);Gh(t,a,o);break;default:throw Error(M(161))}}catch(l){Se(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function C1(t,e,n){O=t,s0(t)}function s0(t,e,n){for(var i=(t.mode&1)!==0;O!==null;){var r=O,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Ta;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Qe;a=Ta;var u=Qe;if(Ta=o,(Qe=l)&&!u)for(O=r;O!==null;)o=O,l=o.child,o.tag===22&&o.memoizedState!==null?Rp(r):l!==null?(l.return=o,O=l):Rp(r);for(;s!==null;)O=s,s0(s),s=s.sibling;O=r,Ta=a,Qe=u}Cp(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,O=s):Cp(t)}}function Cp(t){for(;O!==null;){var e=O;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qe||su(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Qe)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Kt(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&lp(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}lp(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&So(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(M(163))}Qe||e.flags&512&&Bh(e)}catch(d){Se(e,e.return,d)}}if(e===t){O=null;break}if(n=e.sibling,n!==null){n.return=e.return,O=n;break}O=e.return}}function Tp(t){for(;O!==null;){var e=O;if(e===t){O=null;break}var n=e.sibling;if(n!==null){n.return=e.return,O=n;break}O=e.return}}function Rp(t){for(;O!==null;){var e=O;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{su(4,e)}catch(l){Se(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){Se(e,r,l)}}var s=e.return;try{Bh(e)}catch(l){Se(e,s,l)}break;case 5:var o=e.return;try{Bh(e)}catch(l){Se(e,o,l)}}}catch(l){Se(e,e.return,l)}if(e===t){O=null;break}var a=e.sibling;if(a!==null){a.return=e.return,O=a;break}O=e.return}}var T1=Math.ceil,Tl=Un.ReactCurrentDispatcher,rf=Un.ReactCurrentOwner,Gt=Un.ReactCurrentBatchConfig,ne=0,We=null,ke=null,Ye=0,vt=0,Ur=Ii(0),Oe=0,No=null,nr=0,ou=0,sf=0,fo=null,ut=null,of=0,ds=1/0,In=null,Rl=!1,Wh=null,yi=null,Ra=!1,li=null,Pl=0,go=0,Xh=null,Qa=-1,el=0;function ot(){return ne&6?Ie():Qa!==-1?Qa:Qa=Ie()}function xi(t){return t.mode&1?ne&2&&Ye!==0?Ye&-Ye:l1.transition!==null?(el===0&&(el=U_()),el):(t=le,t!==0||(t=window.event,t=t===void 0?16:Z_(t.type)),t):1}function Qt(t,e,n,i){if(50<go)throw go=0,Xh=null,Error(M(185));qo(t,n,i),(!(ne&2)||t!==We)&&(t===We&&(!(ne&2)&&(ou|=n),Oe===4&&oi(t,Ye)),mt(t,i),n===1&&ne===0&&!(e.mode&1)&&(ds=Ie()+500,nu&&Li()))}function mt(t,e){var n=t.callbackNode;lE(t,e);var i=cl(t,t===We?Ye:0);if(i===0)n!==null&&Fg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&Fg(n),e===1)t.tag===0?a1(Pp.bind(null,t)):py(Pp.bind(null,t)),i1(function(){!(ne&6)&&Li()}),n=null;else{switch(W_(i)){case 1:n=kd;break;case 4:n=B_;break;case 16:n=ul;break;case 536870912:n=G_;break;default:n=ul}n=f0(n,o0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function o0(t,e){if(Qa=-1,el=0,ne&6)throw Error(M(327));var n=t.callbackNode;if(Qr()&&t.callbackNode!==n)return null;var i=cl(t,t===We?Ye:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Il(t,i);else{e=i;var r=ne;ne|=2;var s=l0();(We!==t||Ye!==e)&&(In=null,ds=Ie()+500,Ki(t,e));do try{I1();break}catch(a){a0(t,a)}while(!0);Wd(),Tl.current=s,ne=r,ke!==null?e=0:(We=null,Ye=0,e=Oe)}if(e!==0){if(e===2&&(r=yh(t),r!==0&&(i=r,e=Vh(t,r))),e===1)throw n=No,Ki(t,0),oi(t,i),mt(t,Ie()),n;if(e===6)oi(t,i);else{if(r=t.current.alternate,!(i&30)&&!R1(r)&&(e=Il(t,i),e===2&&(s=yh(t),s!==0&&(i=s,e=Vh(t,s))),e===1))throw n=No,Ki(t,0),oi(t,i),mt(t,Ie()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(M(345));case 2:ji(t,ut,In);break;case 3:if(oi(t,i),(i&130023424)===i&&(e=of+500-Ie(),10<e)){if(cl(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){ot(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Rh(ji.bind(null,t,ut,In),e);break}ji(t,ut,In);break;case 4:if(oi(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Jt(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Ie()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*T1(i/1960))-i,10<i){t.timeoutHandle=Rh(ji.bind(null,t,ut,In),i);break}ji(t,ut,In);break;case 5:ji(t,ut,In);break;default:throw Error(M(329))}}}return mt(t,Ie()),t.callbackNode===n?o0.bind(null,t):null}function Vh(t,e){var n=fo;return t.current.memoizedState.isDehydrated&&(Ki(t,e).flags|=256),t=Il(t,e),t!==2&&(e=ut,ut=n,e!==null&&Yh(e)),t}function Yh(t){ut===null?ut=t:ut.push.apply(ut,t)}function R1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!en(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function oi(t,e){for(e&=~sf,e&=~ou,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Jt(e),i=1<<n;t[n]=-1,e&=~i}}function Pp(t){if(ne&6)throw Error(M(327));Qr();var e=cl(t,0);if(!(e&1))return mt(t,Ie()),null;var n=Il(t,e);if(t.tag!==0&&n===2){var i=yh(t);i!==0&&(e=i,n=Vh(t,i))}if(n===1)throw n=No,Ki(t,0),oi(t,e),mt(t,Ie()),n;if(n===6)throw Error(M(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ji(t,ut,In),mt(t,Ie()),null}function af(t,e){var n=ne;ne|=1;try{return t(e)}finally{ne=n,ne===0&&(ds=Ie()+500,nu&&Li())}}function ir(t){li!==null&&li.tag===0&&!(ne&6)&&Qr();var e=ne;ne|=1;var n=Gt.transition,i=le;try{if(Gt.transition=null,le=1,t)return t()}finally{le=i,Gt.transition=n,ne=e,!(ne&6)&&Li()}}function lf(){vt=Ur.current,fe(Ur)}function Ki(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,n1(n)),ke!==null)for(n=ke.return;n!==null;){var i=n;switch(Bd(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&pl();break;case 3:cs(),fe(gt),fe(et),Zd();break;case 5:Kd(i);break;case 4:cs();break;case 13:fe(ye);break;case 19:fe(ye);break;case 10:Xd(i.type._context);break;case 22:case 23:lf()}n=n.return}if(We=t,ke=t=vi(t.current,null),Ye=vt=e,Oe=0,No=null,sf=ou=nr=0,ut=fo=null,Gi!==null){for(e=0;e<Gi.length;e++)if(n=Gi[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}Gi=null}return t}function a0(t,e){do{var n=ke;try{if(Wd(),Za.current=Cl,Sl){for(var i=xe.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Sl=!1}if(tr=0,$e=Ne=xe=null,co=!1,ko=0,rf.current=null,n===null||n.return===null){Oe=1,No=e,ke=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Ye,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=gp(o);if(g!==null){g.flags&=-257,pp(g,o,a,s,e),g.mode&1&&fp(s,u,e),e=g,l=u;var f=e.updateQueue;if(f===null){var _=new Set;_.add(l),e.updateQueue=_}else f.add(l);break e}else{if(!(e&1)){fp(s,u,e),uf();break e}l=Error(M(426))}}else if(pe&&a.mode&1){var x=gp(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),pp(x,o,a,s,e),Gd(hs(l,a));break e}}s=l=hs(l,a),Oe!==4&&(Oe=2),fo===null?fo=[s]:fo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=Wy(s,l,e);ap(s,m);break e;case 1:a=l;var p=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(yi===null||!yi.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var v=Xy(s,a,e);ap(s,v);break e}}s=s.return}while(s!==null)}c0(n)}catch(w){e=w,ke===n&&n!==null&&(ke=n=n.return);continue}break}while(!0)}function l0(){var t=Tl.current;return Tl.current=Cl,t===null?Cl:t}function uf(){(Oe===0||Oe===3||Oe===2)&&(Oe=4),We===null||!(nr&268435455)&&!(ou&268435455)||oi(We,Ye)}function Il(t,e){var n=ne;ne|=2;var i=l0();(We!==t||Ye!==e)&&(In=null,Ki(t,e));do try{P1();break}catch(r){a0(t,r)}while(!0);if(Wd(),ne=n,Tl.current=i,ke!==null)throw Error(M(261));return We=null,Ye=0,Oe}function P1(){for(;ke!==null;)u0(ke)}function I1(){for(;ke!==null&&!Qv();)u0(ke)}function u0(t){var e=d0(t.alternate,t,vt);t.memoizedProps=t.pendingProps,e===null?c0(t):ke=e,rf.current=null}function c0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=E1(n,e),n!==null){n.flags&=32767,ke=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Oe=6,ke=null;return}}else if(n=v1(n,e,vt),n!==null){ke=n;return}if(e=e.sibling,e!==null){ke=e;return}ke=e=t}while(e!==null);Oe===0&&(Oe=5)}function ji(t,e,n){var i=le,r=Gt.transition;try{Gt.transition=null,le=1,L1(t,e,n,i)}finally{Gt.transition=r,le=i}return null}function L1(t,e,n,i){do Qr();while(li!==null);if(ne&6)throw Error(M(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(M(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(uE(t,s),t===We&&(ke=We=null,Ye=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ra||(Ra=!0,f0(ul,function(){return Qr(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Gt.transition,Gt.transition=null;var o=le;le=1;var a=ne;ne|=4,rf.current=null,S1(t,n),r0(n,t),KE(Ch),hl=!!Sh,Ch=Sh=null,t.current=n,C1(n),eE(),ne=a,le=o,Gt.transition=s}else t.current=n;if(Ra&&(Ra=!1,li=t,Pl=r),s=t.pendingLanes,s===0&&(yi=null),iE(n.stateNode),mt(t,Ie()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Rl)throw Rl=!1,t=Wh,Wh=null,t;return Pl&1&&t.tag!==0&&Qr(),s=t.pendingLanes,s&1?t===Xh?go++:(go=0,Xh=t):go=0,Li(),null}function Qr(){if(li!==null){var t=W_(Pl),e=Gt.transition,n=le;try{if(Gt.transition=null,le=16>t?16:t,li===null)var i=!1;else{if(t=li,li=null,Pl=0,ne&6)throw Error(M(331));var r=ne;for(ne|=4,O=t.current;O!==null;){var s=O,o=s.child;if(O.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(O=u;O!==null;){var c=O;switch(c.tag){case 0:case 11:case 15:ho(8,c,s)}var h=c.child;if(h!==null)h.return=c,O=h;else for(;O!==null;){c=O;var d=c.sibling,g=c.return;if(t0(c),c===u){O=null;break}if(d!==null){d.return=g,O=d;break}O=g}}}var f=s.alternate;if(f!==null){var _=f.child;if(_!==null){f.child=null;do{var x=_.sibling;_.sibling=null,_=x}while(_!==null)}}O=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,O=o;else e:for(;O!==null;){if(s=O,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ho(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,O=m;break e}O=s.return}}var p=t.current;for(O=p;O!==null;){o=O;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,O=y;else e:for(o=p;O!==null;){if(a=O,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:su(9,a)}}catch(w){Se(a,a.return,w)}if(a===o){O=null;break e}var v=a.sibling;if(v!==null){v.return=a.return,O=v;break e}O=a.return}}if(ne=r,Li(),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(ql,t)}catch{}i=!0}return i}finally{le=n,Gt.transition=e}}return!1}function Ip(t,e,n){e=hs(n,e),e=Wy(t,e,1),t=_i(t,e,1),e=ot(),t!==null&&(qo(t,1,e),mt(t,e))}function Se(t,e,n){if(t.tag===3)Ip(t,t,n);else for(;e!==null;){if(e.tag===3){Ip(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(yi===null||!yi.has(i))){t=hs(n,t),t=Xy(e,t,1),e=_i(e,t,1),t=ot(),e!==null&&(qo(e,1,t),mt(e,t));break}}e=e.return}}function A1(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=ot(),t.pingedLanes|=t.suspendedLanes&n,We===t&&(Ye&n)===n&&(Oe===4||Oe===3&&(Ye&130023424)===Ye&&500>Ie()-of?Ki(t,0):sf|=n),mt(t,e)}function h0(t,e){e===0&&(t.mode&1?(e=ma,ma<<=1,!(ma&130023424)&&(ma=4194304)):e=1);var n=ot();t=$n(t,e),t!==null&&(qo(t,e,n),mt(t,n))}function k1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),h0(t,n)}function M1(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(M(314))}i!==null&&i.delete(e),h0(t,n)}var d0;d0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||gt.current)ft=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ft=!1,x1(t,e,n);ft=!!(t.flags&131072)}else ft=!1,pe&&e.flags&1048576&&my(e,yl,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Ja(t,e),t=e.pendingProps;var r=as(e,et.current);Jr(e,n),r=Jd(null,e,i,t,r,n);var s=Qd();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,pt(i)?(s=!0,ml(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Yd(e),r.updater=ru,e.stateNode=r,r._reactInternals=e,Dh(e,i,t,n),e=Oh(null,e,i,!0,s,n)):(e.tag=0,pe&&s&&$d(e),nt(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(Ja(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=N1(i),t=Kt(i,t),r){case 0:e=Fh(null,e,i,t,n);break e;case 1:e=yp(null,e,i,t,n);break e;case 11:e=mp(null,e,i,t,n);break e;case 14:e=_p(null,e,i,Kt(i.type,t),n);break e}throw Error(M(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Kt(i,r),Fh(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Kt(i,r),yp(t,e,i,r,n);case 3:e:{if(Ky(e),t===null)throw Error(M(387));i=e.pendingProps,s=e.memoizedState,r=s.element,wy(t,e),El(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=hs(Error(M(423)),e),e=xp(t,e,i,n,r);break e}else if(i!==r){r=hs(Error(M(424)),e),e=xp(t,e,i,n,r);break e}else for(Et=mi(e.stateNode.containerInfo.firstChild),St=e,pe=!0,qt=null,n=vy(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ls(),i===r){e=Bn(t,e,n);break e}nt(t,e,i,n)}e=e.child}return e;case 5:return Sy(e),t===null&&Ah(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,Th(i,r)?o=null:s!==null&&Th(i,s)&&(e.flags|=32),Hy(t,e),nt(t,e,o,n),e.child;case 6:return t===null&&Ah(e),null;case 13:return Zy(t,e,n);case 4:return Hd(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=us(e,null,i,n):nt(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Kt(i,r),mp(t,e,i,r,n);case 7:return nt(t,e,e.pendingProps,n),e.child;case 8:return nt(t,e,e.pendingProps.children,n),e.child;case 12:return nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,ce(xl,i._currentValue),i._currentValue=o,s!==null)if(en(s.value,o)){if(s.children===r.children&&!gt.current){e=Bn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Nn(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),kh(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(M(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),kh(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}nt(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Jr(e,n),r=Wt(r),i=i(r),e.flags|=1,nt(t,e,i,n),e.child;case 14:return i=e.type,r=Kt(i,e.pendingProps),r=Kt(i.type,r),_p(t,e,i,r,n);case 15:return Vy(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Kt(i,r),Ja(t,e),e.tag=1,pt(i)?(t=!0,ml(e)):t=!1,Jr(e,n),Uy(e,i,r),Dh(e,i,r,n),Oh(null,e,i,!0,t,n);case 19:return qy(t,e,n);case 22:return Yy(t,e,n)}throw Error(M(156,e.tag))};function f0(t,e){return $_(t,e)}function D1(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jt(t,e,n,i){return new D1(t,e,n,i)}function cf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function N1(t){if(typeof t=="function")return cf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Id)return 11;if(t===Ld)return 14}return 2}function vi(t,e){var n=t.alternate;return n===null?(n=jt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function tl(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")cf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Dr:return Zi(n.children,r,s,e);case Pd:o=8,r|=8;break;case ih:return t=jt(12,n,e,r|2),t.elementType=ih,t.lanes=s,t;case rh:return t=jt(13,n,e,r),t.elementType=rh,t.lanes=s,t;case sh:return t=jt(19,n,e,r),t.elementType=sh,t.lanes=s,t;case S_:return au(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case E_:o=10;break e;case w_:o=9;break e;case Id:o=11;break e;case Ld:o=14;break e;case ni:o=16,i=null;break e}throw Error(M(130,t==null?t:typeof t,""))}return e=jt(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function Zi(t,e,n,i){return t=jt(7,t,i,e),t.lanes=n,t}function au(t,e,n,i){return t=jt(22,t,i,e),t.elementType=S_,t.lanes=n,t.stateNode={isHidden:!1},t}function yc(t,e,n){return t=jt(6,t,null,e),t.lanes=n,t}function xc(t,e,n){return e=jt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function F1(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qu(0),this.expirationTimes=Qu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qu(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function hf(t,e,n,i,r,s,o,a,l){return t=new F1(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=jt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yd(s),t}function O1(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mr,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function g0(t){if(!t)return Ti;t=t._reactInternals;e:{if(ur(t)!==t||t.tag!==1)throw Error(M(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(pt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(M(171))}if(t.tag===1){var n=t.type;if(pt(n))return gy(t,n,e)}return e}function p0(t,e,n,i,r,s,o,a,l){return t=hf(n,i,!0,t,r,s,o,a,l),t.context=g0(null),n=t.current,i=ot(),r=xi(n),s=Nn(i,r),s.callback=e??null,_i(n,s,r),t.current.lanes=r,qo(t,r,i),mt(t,i),t}function lu(t,e,n,i){var r=e.current,s=ot(),o=xi(r);return n=g0(n),e.context===null?e.context=n:e.pendingContext=n,e=Nn(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=_i(r,e,o),t!==null&&(Qt(t,r,o,s),Ka(t,r,o)),o}function Ll(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Lp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function df(t,e){Lp(t,e),(t=t.alternate)&&Lp(t,e)}function b1(){return null}var m0=typeof reportError=="function"?reportError:function(t){console.error(t)};function ff(t){this._internalRoot=t}uu.prototype.render=ff.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(M(409));lu(t,e,null,null)};uu.prototype.unmount=ff.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ir(function(){lu(null,t,null,null)}),e[zn]=null}};function uu(t){this._internalRoot=t}uu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Y_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<si.length&&e!==0&&e<si[n].priority;n++);si.splice(n,0,t),n===0&&K_(t)}};function gf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function cu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ap(){}function j1(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=Ll(o);s.call(u)}}var o=p0(e,i,t,0,null,!1,!1,"",Ap);return t._reactRootContainer=o,t[zn]=o.current,Ro(t.nodeType===8?t.parentNode:t),ir(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=Ll(l);a.call(u)}}var l=hf(t,0,!1,null,null,!1,!1,"",Ap);return t._reactRootContainer=l,t[zn]=l.current,Ro(t.nodeType===8?t.parentNode:t),ir(function(){lu(e,l,n,i)}),l}function hu(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=Ll(o);a.call(l)}}lu(e,o,t,r)}else o=j1(n,e,t,r,i);return Ll(o)}X_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=qs(e.pendingLanes);n!==0&&(Md(e,n|1),mt(e,Ie()),!(ne&6)&&(ds=Ie()+500,Li()))}break;case 13:ir(function(){var i=$n(t,1);if(i!==null){var r=ot();Qt(i,t,1,r)}}),df(t,1)}};Dd=function(t){if(t.tag===13){var e=$n(t,134217728);if(e!==null){var n=ot();Qt(e,t,134217728,n)}df(t,134217728)}};V_=function(t){if(t.tag===13){var e=xi(t),n=$n(t,e);if(n!==null){var i=ot();Qt(n,t,e,i)}df(t,e)}};Y_=function(){return le};H_=function(t,e){var n=le;try{return le=t,e()}finally{le=n}};ph=function(t,e,n){switch(e){case"input":if(lh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=tu(i);if(!r)throw Error(M(90));T_(i),lh(i,r)}}}break;case"textarea":P_(t,n);break;case"select":e=n.value,e!=null&&Hr(t,!!n.multiple,e,!1)}};N_=af;F_=ir;var z1={usingClientEntryPoint:!1,Events:[Qo,br,tu,M_,D_,af]},Us={findFiberByHostInstance:Bi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$1={bundleType:Us.bundleType,version:Us.version,rendererPackageName:Us.rendererPackageName,rendererConfig:Us.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Un.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=j_(t),t===null?null:t.stateNode},findFiberByHostInstance:Us.findFiberByHostInstance||b1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pa.isDisabled&&Pa.supportsFiber)try{ql=Pa.inject($1),mn=Pa}catch{}}Rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z1;Rt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gf(e))throw Error(M(200));return O1(t,e,null,n)};Rt.createRoot=function(t,e){if(!gf(t))throw Error(M(299));var n=!1,i="",r=m0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=hf(t,1,!1,null,null,n,!1,i,r),t[zn]=e.current,Ro(t.nodeType===8?t.parentNode:t),new ff(e)};Rt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(M(188)):(t=Object.keys(t).join(","),Error(M(268,t)));return t=j_(e),t=t===null?null:t.stateNode,t};Rt.flushSync=function(t){return ir(t)};Rt.hydrate=function(t,e,n){if(!cu(e))throw Error(M(200));return hu(null,t,e,!0,n)};Rt.hydrateRoot=function(t,e,n){if(!gf(t))throw Error(M(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=m0;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=p0(e,null,t,1,n??null,r,!1,s,o),t[zn]=e.current,Ro(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new uu(e)};Rt.render=function(t,e,n){if(!cu(e))throw Error(M(200));return hu(null,t,e,!1,n)};Rt.unmountComponentAtNode=function(t){if(!cu(t))throw Error(M(40));return t._reactRootContainer?(ir(function(){hu(null,null,t,!1,function(){t._reactRootContainer=null,t[zn]=null})}),!0):!1};Rt.unstable_batchedUpdates=af;Rt.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!cu(n))throw Error(M(200));if(t==null||t._reactInternals===void 0)throw Error(M(38));return hu(t,e,n,!1,i)};Rt.version="18.3.1-next-f1338f8080-20240426";function _0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_0)}catch(t){console.error(t)}}_0(),__.exports=Rt;var B1=__.exports,kp=B1;th.createRoot=kp.createRoot,th.hydrateRoot=kp.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fo(){return Fo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Fo.apply(this,arguments)}var ui;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ui||(ui={}));const Mp="popstate";function G1(t){t===void 0&&(t={});function e(i,r){let{pathname:s,search:o,hash:a}=i.location;return Hh("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:Al(r)}return W1(e,n,null,t)}function Le(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function pf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function U1(){return Math.random().toString(36).substr(2,8)}function Dp(t,e){return{usr:t.state,key:t.key,idx:e}}function Hh(t,e,n,i){return n===void 0&&(n=null),Fo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ts(e):e,{state:n,key:e&&e.key||i||U1()})}function Al(t){let{pathname:e="/",search:n="",hash:i=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function Ts(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substr(i),t=t.substr(0,i)),t&&(e.pathname=t)}return e}function W1(t,e,n,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a=ui.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(Fo({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function h(){a=ui.Pop;let x=c(),m=x==null?null:x-u;u=x,l&&l({action:a,location:_.location,delta:m})}function d(x,m){a=ui.Push;let p=Hh(_.location,x,m);u=c()+1;let y=Dp(p,u),v=_.createHref(p);try{o.pushState(y,"",v)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;r.location.assign(v)}s&&l&&l({action:a,location:_.location,delta:1})}function g(x,m){a=ui.Replace;let p=Hh(_.location,x,m);u=c();let y=Dp(p,u),v=_.createHref(p);o.replaceState(y,"",v),s&&l&&l({action:a,location:_.location,delta:0})}function f(x){let m=r.location.origin!=="null"?r.location.origin:r.location.href,p=typeof x=="string"?x:Al(x);return p=p.replace(/ $/,"%20"),Le(m,"No window.location.(origin|href) available to create URL for href: "+p),new URL(p,m)}let _={get action(){return a},get location(){return t(r,o)},listen(x){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(Mp,h),l=x,()=>{r.removeEventListener(Mp,h),l=null}},createHref(x){return e(r,x)},createURL:f,encodeLocation(x){let m=f(x);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:d,replace:g,go(x){return o.go(x)}};return _}var Np;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Np||(Np={}));function X1(t,e,n){return n===void 0&&(n="/"),V1(t,e,n)}function V1(t,e,n,i){let r=typeof e=="string"?Ts(e):e,s=mf(r.pathname||"/",n);if(s==null)return null;let o=y0(t);Y1(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=sw(s);a=nw(o[l],u)}return a}function y0(t,e,n,i){e===void 0&&(e=[]),n===void 0&&(n=[]),i===void 0&&(i="");let r=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Le(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let u=Ei([i,l.relativePath]),c=n.concat(l);s.children&&s.children.length>0&&(Le(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),y0(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:ew(u,s.index),routesMeta:c})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))r(s,o);else for(let l of x0(s.path))r(s,o,l)}),e}function x0(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=x0(i.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function Y1(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:tw(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const H1=/^:[\w-]+$/,K1=3,Z1=2,q1=1,J1=10,Q1=-2,Fp=t=>t==="*";function ew(t,e){let n=t.split("/"),i=n.length;return n.some(Fp)&&(i+=Q1),e&&(i+=Z1),n.filter(r=>!Fp(r)).reduce((r,s)=>r+(H1.test(s)?K1:s===""?q1:J1),i)}function tw(t,e){return t.length===e.length&&t.slice(0,-1).every((i,r)=>i===e[r])?t[t.length-1]-e[e.length-1]:0}function nw(t,e,n){let{routesMeta:i}=t,r={},s="/",o=[];for(let a=0;a<i.length;++a){let l=i[a],u=a===i.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=iw({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:Ei([s,h.pathname]),pathnameBase:cw(Ei([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=Ei([s,h.pathnameBase]))}return o}function iw(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=rw(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce((u,c,h)=>{let{paramName:d,isOptional:g}=c;if(d==="*"){let _=a[h]||"";o=s.slice(0,s.length-_.length).replace(/(.)\/+$/,"$1")}const f=a[h];return g&&!f?u[d]=void 0:u[d]=(f||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function rw(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),pf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let i=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(i.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(i.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function sw(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return pf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function mf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}const ow=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,aw=t=>ow.test(t);function lw(t,e){e===void 0&&(e="/");let{pathname:n,search:i="",hash:r=""}=typeof t=="string"?Ts(t):t,s;if(n)if(aw(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),pf(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?s=Op(n.substring(1),"/"):s=Op(n,e)}else s=e;return{pathname:s,search:hw(i),hash:dw(r)}}function Op(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function vc(t,e,n,i){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function uw(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function _f(t,e){let n=uw(t);return e?n.map((i,r)=>r===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function yf(t,e,n,i){i===void 0&&(i=!1);let r;typeof t=="string"?r=Ts(t):(r=Fo({},t),Le(!r.pathname||!r.pathname.includes("?"),vc("?","pathname","search",r)),Le(!r.pathname||!r.pathname.includes("#"),vc("#","pathname","hash",r)),Le(!r.search||!r.search.includes("#"),vc("#","search","hash",r)));let s=t===""||r.pathname==="",o=s?"/":r.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!i&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;r.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=lw(r,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Ei=t=>t.join("/").replace(/\/\/+/g,"/"),cw=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),hw=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,dw=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function fw(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const v0=["post","put","patch","delete"];new Set(v0);const gw=["get",...v0];new Set(gw);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oo(){return Oo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Oo.apply(this,arguments)}const xf=P.createContext(null),pw=P.createContext(null),Ai=P.createContext(null),du=P.createContext(null),ki=P.createContext({outlet:null,matches:[],isDataRoute:!1}),E0=P.createContext(null);function mw(t,e){let{relative:n}=e===void 0?{}:e;Rs()||Le(!1);let{basename:i,navigator:r}=P.useContext(Ai),{hash:s,pathname:o,search:a}=C0(t,{relative:n}),l=o;return i!=="/"&&(l=o==="/"?i:Ei([i,o])),r.createHref({pathname:l,search:a,hash:s})}function Rs(){return P.useContext(du)!=null}function Ps(){return Rs()||Le(!1),P.useContext(du).location}function w0(t){P.useContext(Ai).static||P.useLayoutEffect(t)}function S0(){let{isDataRoute:t}=P.useContext(ki);return t?Lw():_w()}function _w(){Rs()||Le(!1);let t=P.useContext(xf),{basename:e,future:n,navigator:i}=P.useContext(Ai),{matches:r}=P.useContext(ki),{pathname:s}=Ps(),o=JSON.stringify(_f(r,n.v7_relativeSplatPath)),a=P.useRef(!1);return w0(()=>{a.current=!0}),P.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){i.go(u);return}let h=yf(u,JSON.parse(o),s,c.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ei([e,h.pathname])),(c.replace?i.replace:i.push)(h,c.state,c)},[e,i,o,s,t])}function C0(t,e){let{relative:n}=e===void 0?{}:e,{future:i}=P.useContext(Ai),{matches:r}=P.useContext(ki),{pathname:s}=Ps(),o=JSON.stringify(_f(r,i.v7_relativeSplatPath));return P.useMemo(()=>yf(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function yw(t,e){return xw(t,e)}function xw(t,e,n,i){Rs()||Le(!1);let{navigator:r}=P.useContext(Ai),{matches:s}=P.useContext(ki),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Ps(),c;if(e){var h;let x=typeof e=="string"?Ts(e):e;l==="/"||(h=x.pathname)!=null&&h.startsWith(l)||Le(!1),c=x}else c=u;let d=c.pathname||"/",g=d;if(l!=="/"){let x=l.replace(/^\//,"").split("/");g="/"+d.replace(/^\//,"").split("/").slice(x.length).join("/")}let f=X1(t,{pathname:g}),_=Cw(f&&f.map(x=>Object.assign({},x,{params:Object.assign({},a,x.params),pathname:Ei([l,r.encodeLocation?r.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:Ei([l,r.encodeLocation?r.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,n,i);return e&&_?P.createElement(du.Provider,{value:{location:Oo({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:ui.Pop}},_):_}function vw(){let t=Iw(),e=fw(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),n?P.createElement("pre",{style:r},n):null,null)}const Ew=P.createElement(vw,null);class ww extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?P.createElement(ki.Provider,{value:this.props.routeContext},P.createElement(E0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Sw(t){let{routeContext:e,match:n,children:i}=t,r=P.useContext(xf);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),P.createElement(ki.Provider,{value:e},i)}function Cw(t,e,n,i){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),i===void 0&&(i=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=i)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let c=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);c>=0||Le(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(n&&i&&i.v7_partialHydration)for(let c=0;c<o.length;c++){let h=o[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=c),h.route.id){let{loaderData:d,errors:g}=n,f=h.route.loader&&d[h.route.id]===void 0&&(!g||g[h.route.id]===void 0);if(h.route.lazy||f){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,h,d)=>{let g,f=!1,_=null,x=null;n&&(g=a&&h.route.id?a[h.route.id]:void 0,_=h.route.errorElement||Ew,l&&(u<0&&d===0?(Aw("route-fallback"),f=!0,x=null):u===d&&(f=!0,x=h.route.hydrateFallbackElement||null)));let m=e.concat(o.slice(0,d+1)),p=()=>{let y;return g?y=_:f?y=x:h.route.Component?y=P.createElement(h.route.Component,null):h.route.element?y=h.route.element:y=c,P.createElement(Sw,{match:h,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:y})};return n&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?P.createElement(ww,{location:n.location,revalidation:n.revalidation,component:_,error:g,children:p(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):p()},null)}var T0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(T0||{}),R0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(R0||{});function Tw(t){let e=P.useContext(xf);return e||Le(!1),e}function Rw(t){let e=P.useContext(pw);return e||Le(!1),e}function Pw(t){let e=P.useContext(ki);return e||Le(!1),e}function P0(t){let e=Pw(),n=e.matches[e.matches.length-1];return n.route.id||Le(!1),n.route.id}function Iw(){var t;let e=P.useContext(E0),n=Rw(),i=P0();return e!==void 0?e:(t=n.errors)==null?void 0:t[i]}function Lw(){let{router:t}=Tw(T0.UseNavigateStable),e=P0(R0.UseNavigateStable),n=P.useRef(!1);return w0(()=>{n.current=!0}),P.useCallback(function(r,s){s===void 0&&(s={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Oo({fromRouteId:e},s)))},[t,e])}const bp={};function Aw(t,e,n){bp[t]||(bp[t]=!0)}function kw(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Mw(t){let{to:e,replace:n,state:i,relative:r}=t;Rs()||Le(!1);let{future:s,static:o}=P.useContext(Ai),{matches:a}=P.useContext(ki),{pathname:l}=Ps(),u=S0(),c=yf(e,_f(a,s.v7_relativeSplatPath),l,r==="path"),h=JSON.stringify(c);return P.useEffect(()=>u(JSON.parse(h),{replace:n,state:i,relative:r}),[u,h,r,n,i]),null}function Qn(t){Le(!1)}function Dw(t){let{basename:e="/",children:n=null,location:i,navigationType:r=ui.Pop,navigator:s,static:o=!1,future:a}=t;Rs()&&Le(!1);let l=e.replace(/^\/*/,"/"),u=P.useMemo(()=>({basename:l,navigator:s,static:o,future:Oo({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof i=="string"&&(i=Ts(i));let{pathname:c="/",search:h="",hash:d="",state:g=null,key:f="default"}=i,_=P.useMemo(()=>{let x=mf(c,l);return x==null?null:{location:{pathname:x,search:h,hash:d,state:g,key:f},navigationType:r}},[l,c,h,d,g,f,r]);return _==null?null:P.createElement(Ai.Provider,{value:u},P.createElement(du.Provider,{children:n,value:_}))}function Nw(t){let{children:e,location:n}=t;return yw(Kh(e),n)}new Promise(()=>{});function Kh(t,e){e===void 0&&(e=[]);let n=[];return P.Children.forEach(t,(i,r)=>{if(!P.isValidElement(i))return;let s=[...e,r];if(i.type===P.Fragment){n.push.apply(n,Kh(i.props.children,s));return}i.type!==Qn&&Le(!1),!i.props.index||!i.props.children||Le(!1);let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=Kh(i.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zh(){return Zh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Zh.apply(this,arguments)}function Fw(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function Ow(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function bw(t,e){return t.button===0&&(!e||e==="_self")&&!Ow(t)}const jw=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],zw="6";try{window.__reactRouterVersion=zw}catch{}const $w="startTransition",jp=Av[$w];function Bw(t){let{basename:e,children:n,future:i,window:r}=t,s=P.useRef();s.current==null&&(s.current=G1({window:r,v5Compat:!0}));let o=s.current,[a,l]=P.useState({action:o.action,location:o.location}),{v7_startTransition:u}=i||{},c=P.useCallback(h=>{u&&jp?jp(()=>l(h)):l(h)},[l,u]);return P.useLayoutEffect(()=>o.listen(c),[o,c]),P.useEffect(()=>kw(i),[i]),P.createElement(Dw,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:i})}const Gw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Uw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zp=P.forwardRef(function(e,n){let{onClick:i,relative:r,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:c,viewTransition:h}=e,d=Fw(e,jw),{basename:g}=P.useContext(Ai),f,_=!1;if(typeof u=="string"&&Uw.test(u)&&(f=u,Gw))try{let y=new URL(window.location.href),v=u.startsWith("//")?new URL(y.protocol+u):new URL(u),w=mf(v.pathname,g);v.origin===y.origin&&w!=null?u=w+v.search+v.hash:_=!0}catch{}let x=mw(u,{relative:r}),m=Ww(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:r,viewTransition:h});function p(y){i&&i(y),y.defaultPrevented||m(y)}return P.createElement("a",Zh({},d,{href:f||x,onClick:_||s?i:p,ref:n,target:l}))});var $p;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})($p||($p={}));var Bp;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Bp||(Bp={}));function Ww(t,e){let{target:n,replace:i,state:r,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=S0(),u=Ps(),c=C0(t,{relative:o});return P.useCallback(h=>{if(bw(h,n)){h.preventDefault();let d=i!==void 0?i:Al(u)===Al(c);l(t,{replace:d,state:r,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,c,i,r,n,t,s,o,a])}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xw=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),I0=(...t)=>t.filter((e,n,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Vw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yw=P.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},l)=>P.createElement("svg",{ref:l,...Vw,width:e,height:e,stroke:t,strokeWidth:i?Number(n)*24/Number(e):n,className:I0("lucide",r),...a},[...o.map(([u,c])=>P.createElement(u,c)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=(t,e)=>{const n=P.forwardRef(({className:i,...r},s)=>P.createElement(Yw,{ref:s,iconNode:e,className:I0(`lucide-${Xw(t)}`,i),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=It("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=It("CloudDrizzle",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 19v1",key:"1dk2by"}],["path",{d:"M8 14v1",key:"84yxot"}],["path",{d:"M16 19v1",key:"v220m7"}],["path",{d:"M16 14v1",key:"g12gj6"}],["path",{d:"M12 21v1",key:"q8vafk"}],["path",{d:"M12 16v1",key:"1mx6rx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kl=It("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Up=It("Hospital",[["path",{d:"M12 6v4",key:"16clxf"}],["path",{d:"M14 14h-4",key:"esezmu"}],["path",{d:"M14 18h-4",key:"16mqa2"}],["path",{d:"M14 8h-4",key:"z8ypaz"}],["path",{d:"M18 12h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2h2",key:"b1k337"}],["path",{d:"M18 22V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v18",key:"16g51d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=It("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=It("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zw=It("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=It("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=It("Satellite",[["path",{d:"M13 7 9 3 5 7l4 4",key:"vyckw6"}],["path",{d:"m17 11 4 4-4 4-4-4",key:"rchckc"}],["path",{d:"m8 12 4 4 6-6-4-4Z",key:"1sshf7"}],["path",{d:"m16 8 3-3",key:"x428zp"}],["path",{d:"M9 21a6 6 0 0 0-6-6",key:"1iajcf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=It("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=It("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=It("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=It("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);function nl(...t){return t.filter(Boolean).join(" ")}const tS=[{label:"Sources",path:"/sources",icon:kl},{label:"Dashboard",path:"/dashboard",icon:Kw},{label:"Map",path:"/map",icon:Zw},{label:"Timeline",path:"/timeline",icon:Hw},{label:"Settings",path:"/settings",icon:Jw}];function nS({isOnline:t=!1}){const e=Ps();return E.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 border-b border-primary/20 bg-background/80 backdrop-blur-md",children:E.jsxs("div",{className:"flex items-center justify-between px-6 py-3",children:[E.jsxs(zp,{to:"/",className:"flex items-center gap-3 group",children:[E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"w-10 h-10 clip-corner bg-primary/20 flex items-center justify-center border border-primary/50 group-hover:bg-primary/30 transition-colors",children:E.jsx(qw,{className:"w-5 h-5 text-primary"})}),E.jsx("div",{className:"absolute inset-0 bg-primary/20 animate-pulse-ring clip-corner pointer-events-none"})]}),E.jsx("span",{className:"text-xl font-bold tracking-wider text-primary text-glow",children:"RTAIP"})]}),E.jsx("nav",{className:"flex items-center gap-1",children:tS.map(n=>{const i=e.pathname===n.path,r=n.icon;return E.jsxs(zp,{to:n.path,className:nl("relative px-4 py-2 flex items-center gap-2 text-sm font-medium tracking-wide transition-all duration-300","hover:text-primary hover:bg-primary/10","clip-corner-sm",i?"text-primary bg-primary/20 border border-primary/30":"text-muted-foreground"),children:[E.jsx(r,{className:"w-4 h-4"}),E.jsx("span",{className:"hidden md:inline",children:n.label}),i&&E.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary box-glow"})]},n.path)})}),E.jsx("div",{className:"flex items-center gap-3",children:E.jsxs("div",{className:nl("flex items-center gap-2 px-3 py-1.5 text-xs font-medium tracking-wider uppercase clip-corner-sm",t?"bg-success/20 text-success border border-success/30":"bg-destructive/20 text-destructive border border-destructive/30"),children:[E.jsx("div",{className:nl("w-2 h-2 rounded-full",t?"bg-success animate-pulse":"bg-destructive")}),"Backend: ",t?"Online":"Offline"]})})]})})}const Jh=new Map,iS=2*60*1e3;function rS(t){const e=Jh.get(t);return e?Date.now()-e.ts>iS?(Jh.delete(t),null):e.data:null}function sS(t,e){Jh.set(t,{ts:Date.now(),data:e})}async function cr(t,e={}){const{timeoutMs:n=8e3,...i}=e,r=new AbortController,s=setTimeout(()=>r.abort(),n);try{const o=typeof t=="string"?`http:${t}`:`http:${String(t)}`;if((i.method||"GET")==="GET"){const l=rS(o);if(l)return l}const a=await fetch(t,{...i,signal:r.signal});return clearTimeout(s),(i.method||"GET")==="GET"&&a.ok&&sS(typeof t=="string"?`http:${t}`:`http:${String(t)}`,a.clone()),a}catch(o){throw clearTimeout(s),o}}function rr(){const e=typeof window<"u"?window.localStorage.getItem("backendUrl"):null;return e&&e.trim()||void 0||null}async function Qh(){const t=rr();if(!t)return[];try{const n=await(await cr(`${t.replace(/\/$/,"")}/events`,{timeoutMs:7e3})).json();return(Array.isArray(n)?n:[]).map((r,s)=>({id:String(r.id??s),timestamp:r.timestamp??new Date().toISOString(),source:String(r.source||"unknown"),latitude:typeof r.latitude=="number"?r.latitude:null,longitude:typeof r.longitude=="number"?r.longitude:null,confidence:typeof r.confidence=="number"?r.confidence:.5,data:r.data||{}}))}catch{return[]}}function sr(t){var r,s,o,a;const e=String(t.source||"").toLowerCase();let n=.3;if(e.includes("usgs")){const l=typeof((r=t.data)==null?void 0:r.mag)=="number"?t.data.mag:0;n=Math.min(1,Math.max(0,(l-2)/6))}else if(e.includes("noaa")){const l=String(((s=t.data)==null?void 0:s.event)||"").toLowerCase();n=l.includes("warning")?.8:l.includes("watch")?.6:.4}else if(e.includes("gdacs")){const l=String(((o=t.data)==null?void 0:o.alertlevel)||"").toLowerCase();n=l==="red"?.9:l==="orange"?.7:.5}else if(e.includes("fema")){const l=String(((a=t.data)==null?void 0:a.incidentType)||"").toLowerCase();n=l.includes("hurricane")?.7:l.includes("flood")?.6:.4}const i=typeof t.confidence=="number"?t.confidence:.5;return Math.max(0,Math.min(1,n*(.6+.4*i)))}function vf(t){const n=t.map(sr).reduce((r,s)=>r+s,0);return Math.round(Math.min(1e3,n*40))}function Wi(t,e=1){const n=new Map;return t.forEach(i=>{if(i.latitude==null||i.longitude==null)return;const r=Math.floor(i.latitude/e)*e,s=Math.floor(i.longitude/e)*e,o=`${r}:${s}`,a=sr(i),l=n.get(o)||{latSum:0,lonSum:0,n:0,score:0};l.latSum+=i.latitude,l.lonSum+=i.longitude,l.n+=1,l.score+=a,n.set(o,l)}),Array.from(n.entries()).map(([i,r])=>({lat:r.latSum/r.n,lon:r.lonSum/r.n,score:r.score})).sort((i,r)=>r.score-i.score).slice(0,5)}function L0(t){const n=Date.now()-72*36e5,i=t.filter(a=>{const l=new Date(a.timestamp).getTime();return!isNaN(l)&&l>=n}),r={};i.forEach(a=>{const l=String(a.source||"").toLowerCase(),u=l.includes("usgs")?"seismic":l.includes("noaa")?"weather":l.includes("gdacs")||l.includes("fema")?"disaster":"other";r[u]=(r[u]||0)+sr(a)});const s=Object.values(r).reduce((a,l)=>a+l,0)||1,o={};return Object.keys(r).forEach(a=>{o[a]=Math.round(r[a]/s*100)}),o}function oS(t){return Wi(t,1).flatMap(n=>[{lat:n.lat,lon:n.lon,weight:n.score},{lat:n.lat+.5,lon:n.lon,weight:n.score*.6},{lat:n.lat-.4,lon:n.lon+.3,weight:n.score*.5}])}function aS(t){const e=["usgs","noaa","gdacs","fema","hifld","census"],n={};e.forEach(r=>{n[r]={},e.forEach(s=>{n[r][s]=0})});const i=t.filter(r=>r.latitude!=null&&r.longitude!=null);for(let r=0;r<i.length;r++)for(let s=r+1;s<i.length;s++){const o=i[r],a=i[s],l=e.find(d=>String(o.source).toLowerCase().includes(d))||"other",u=e.find(d=>String(a.source).toLowerCase().includes(d))||"other",c=Math.abs(new Date(o.timestamp).getTime()-new Date(a.timestamp).getTime()),h=Math.abs(o.latitude-a.latitude)+Math.abs(o.longitude-a.longitude);c<=6*36e5&&h<=2&&(n[l][u]+=(sr(o)+sr(a))/2)}return n}async function fu(){try{const e=await(await cr("https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson")).json();return(Array.isArray(e==null?void 0:e.features)?e.features:[]).map((i,r)=>{var u,c,h,d;const s=Array.isArray((u=i.geometry)==null?void 0:u.coordinates)?i.geometry.coordinates:[],o=typeof s[0]=="number"?s[0]:null,a=typeof s[1]=="number"?s[1]:null,l=typeof((c=i.properties)==null?void 0:c.time)=="number"?new Date(i.properties.time).toISOString():new Date().toISOString();return{id:String(i.id||`usgs-${r}`),timestamp:l,source:"usgs_seismic",latitude:a,longitude:o,confidence:1,data:{mag:(h=i.properties)==null?void 0:h.mag,place:(d=i.properties)==null?void 0:d.place}}})}catch{return[]}}async function gu(){try{const e=await(await cr("https://api.weather.gov/alerts/active")).json();return(Array.isArray(e==null?void 0:e.features)?e.features:[]).map((i,r)=>{var u,c,h,d,g,f;const s=i.geometry;let o=null,a=null;try{if(s&&s.type==="Polygon"){const _=((u=s.coordinates)==null?void 0:u[0])||[];if(_.length>0){const x=_.reduce((m,p)=>({lon:m.lon+((p==null?void 0:p[0])||0),lat:m.lat+((p==null?void 0:p[1])||0)}),{lon:0,lat:0});o=x.lon/_.length,a=x.lat/_.length}}}catch{}const l=((c=i.properties)==null?void 0:c.effective)||((h=i.properties)==null?void 0:h.sent)||((d=i.properties)==null?void 0:d.onset)||new Date().toISOString();return{id:String(i.id||`noaa-${r}`),timestamp:l,source:"noaa_weather",latitude:a,longitude:o,confidence:1,data:{headline:(g=i.properties)==null?void 0:g.headline,event:(f=i.properties)==null?void 0:f.event}}})}catch{return[]}}async function pu(t,e){try{const i=await(await cr(`https://www.gdacs.org/gdacsapi/api/events/geteventlist/SEARCH?eventlist=EQ;TC;FL;WF;VO;DR&fromdate=${t}&todate=${e}`)).json();return(Array.isArray(i==null?void 0:i.features)?i.features:[]).map((s,o)=>{var g;let a=null,l=null;const u=s.geometry;try{if(u&&u.type==="Point"&&Array.isArray(u.coordinates))a=typeof u.coordinates[0]=="number"?u.coordinates[0]:null,l=typeof u.coordinates[1]=="number"?u.coordinates[1]:null;else if(u&&u.type==="Polygon"){const f=((g=u.coordinates)==null?void 0:g[0])||[];if(f.length>0){const _=f.reduce((x,m)=>({lon:x.lon+((m==null?void 0:m[0])||0),lat:x.lat+((m==null?void 0:m[1])||0)}),{lon:0,lat:0});a=_.lon/f.length,l=_.lat/f.length}}}catch{}const c=s.properties||{},h=c.fromdate||c.todate||new Date().toISOString();return{id:c.eventid&&c.episodeid?`${c.eventid}-${c.episodeid}`:String(c.eventid||`gdacs-${o}`),timestamp:h,source:"gdacs_disasters",latitude:l,longitude:a,confidence:1,data:{title:c.name||c.description||"GDACS Event",type:c.eventtype,alertlevel:c.alertlevel}}})}catch{return[]}}async function mu(){try{const n=await(await cr("https://gis.fema.gov/arcgis/rest/services/IncidentManagement/DisasterDeclarationsSummaries/FeatureServer/0/query?where=1%3D1&outFields=declarationDate,incidentType,declaredCountyArea,declaredState,disasterNumber&returnGeometry=true&outSR=4326&f=json")).json();return(Array.isArray(n==null?void 0:n.features)?n.features:[]).map((r,s)=>{const o=r.attributes||{},a=r.geometry||{},l=typeof o.declarationDate=="number"?o.declarationDate:null,u=l?new Date(l).toISOString():new Date().toISOString(),c=typeof a.x=="number"?a.x:null,h=typeof a.y=="number"?a.y:null;return{id:String(o.disasterNumber||`fema-${s}`),timestamp:u,source:"fema_disasters",latitude:h,longitude:c,confidence:1,data:{incidentType:o.incidentType,county:o.declaredCountyArea,state:o.declaredState}}})}catch{return[]}}async function _u(){try{const n=await(await cr("https://maps.nccs.nasa.gov/mapping/rest/services/hifld_open/public_health/FeatureServer/0/query?where=1%3D1&outFields=name,type,state&returnGeometry=true&f=json")).json();return(Array.isArray(n==null?void 0:n.features)?n.features:[]).map((r,s)=>{const o=r.attributes||{},a=r.geometry||{},l=typeof a.x=="number"?a.x:null,u=typeof a.y=="number"?a.y:null;return{id:String(o.id||`hifld-${s}`),timestamp:new Date().toISOString(),source:"hifld_infra",latitude:u,longitude:l,confidence:1,data:{name:o.name,type:o.type,state:o.state}}})}catch{return[]}}async function yu(){try{const n=await(await cr("https://tigerweb.geo.census.gov/arcgis/rest/services/TIGERweb/State_County/MapServer/11/query?where=1%3D1&outFields=NAME,STATE,INTPTLAT,INTPTLON,GEOID&returnGeometry=false&f=json")).json();return(Array.isArray(n==null?void 0:n.features)?n.features:[]).map((r,s)=>{const o=r.attributes||{},a=o.INTPTLAT!=null?parseFloat(o.INTPTLAT):null,l=o.INTPTLON!=null?parseFloat(o.INTPTLON):null;return{id:String(o.GEOID||`census-${s}`),timestamp:new Date().toISOString(),source:"census_pop",latitude:typeof a=="number"&&isFinite(a)?a:null,longitude:typeof l=="number"&&isFinite(l)?l:null,confidence:1,data:{name:o.NAME,state:o.STATE}}})}catch{return[]}}const ct={ADD:"add",REMOVE:"remove"},fs={PROPERTYCHANGE:"propertychange"},J={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class ta{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function lS(t,e,n){let i,r;n=n||Fn;let s=0,o=t.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+n(t[i],e),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function Fn(t,e){return t>e?1:t<e?-1:0}function uS(t,e){return t<e?1:t>e?-1:0}function Ef(t,e,n){if(t[0]<=e)return 0;const i=t.length;if(e<=t[i-1])return i-1;if(typeof n=="function"){for(let r=1;r<i;++r){const s=t[r];if(s===e)return r;if(s<e)return n(e,t[r-1],s)>0?r-1:r}return i-1}if(n>0){for(let r=1;r<i;++r)if(t[r]<e)return r-1;return i-1}if(n<0){for(let r=1;r<i;++r)if(t[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(t[r]==e)return r;if(t[r]<e)return t[r-1]-e<e-t[r]?r-1:r}return i-1}function cS(t,e,n){for(;e<n;){const i=t[e];t[e]=t[n],t[n]=i,++e,--n}}function wf(t,e){const n=Array.isArray(e)?e:[e],i=n.length;for(let r=0;r<i;r++)t[t.length]=n[r]}function Wn(t,e){const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function hS(t,e,n){const i=e||Fn;return t.every(function(r,s){if(s===0)return!0;const o=i(t[s-1],r);return!(o>0||o===0)})}function bo(){return!0}function xu(){return!1}function jo(){}function A0(t){let e,n,i;return function(){const r=Array.prototype.slice.call(arguments);return(!n||this!==i||!Wn(r,n))&&(i=this,n=r,e=t.apply(this,arguments)),e}}function dS(t){function e(){let n;try{n=t()}catch(i){return Promise.reject(i)}return n instanceof Promise?n:Promise.resolve(n)}return e()}function Is(t){for(const e in t)delete t[e]}function gs(t){let e;for(e in t)return!1;return!e}class Xn{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class vu extends ta{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,n){if(!e||!n)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(n)||r.push(n)}dispatchEvent(e){const n=typeof e=="string",i=n?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=n?new Xn(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let u=0,c=r.length;u<c;++u)if("handleEvent"in r[u]?l=r[u].handleEvent(s):l=r[u].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[i]===0){let u=a[i];for(delete a[i];u--;)this.removeEventListener(i,jo);delete o[i]}return l}disposeInternal(){this.listeners_&&Is(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,n){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(n);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=jo,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function ee(t,e,n,i,r){if(r){const o=n;n=function(a){return t.removeEventListener(e,n),o.call(i??this,a)}}else i&&i!==t&&(n=n.bind(i));const s={target:t,type:e,listener:n};return t.addEventListener(e,n),s}function Ml(t,e,n,i){return ee(t,e,n,i,!0)}function ge(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),Is(t))}class na extends vu{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(J.CHANGE)}getRevision(){return this.revision_}onInternal(e,n){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=ee(this,e[s],n);return r}return ee(this,e,n)}onceInternal(e,n){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Ml(this,e[s],n)}else i=Ml(this,e,n);return n.ol_key=i,i}unInternal(e,n){const i=n.ol_key;if(i)fS(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],n);else this.removeEventListener(e,n)}}na.prototype.on;na.prototype.once;na.prototype.un;function fS(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)ge(t[e]);else ge(t)}function re(){throw new Error("Unimplemented abstract method.")}let gS=0;function X(t){return t.ol_uid||(t.ol_uid=String(++gS))}class Vp extends Xn{constructor(e,n,i){super(e),this.key=n,this.oldValue=i}}class xn extends na{constructor(e){super(),this.on,this.once,this.un,X(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let n;return this.values_&&this.values_.hasOwnProperty(e)&&(n=this.values_[e]),n}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,n){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new Vp(i,e,n)),i=fs.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new Vp(i,e,n))}addChangeListener(e,n){this.addEventListener(`change:${e}`,n)}removeChangeListener(e,n){this.removeEventListener(`change:${e}`,n)}set(e,n,i){const r=this.values_||(this.values_={});if(i)r[e]=n;else{const s=r[e];r[e]=n,s!==n&&this.notify(e,s)}}setProperties(e,n){for(const i in e)this.set(i,e[i],n)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,n){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],gs(this.values_)&&(this.values_=null),n||this.notify(e,i)}}}const Yp={LENGTH:"length"};class Ia extends Xn{constructor(e,n,i){super(e),this.element=n,this.index=i}}class zt extends xn{constructor(e,n){if(super(),this.on,this.once,this.un,n=n||{},this.unique_=!!n.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let n=0,i=e.length;n<i;++n)this.push(e[n]);return this}forEach(e){const n=this.array_;for(let i=0,r=n.length;i<r;++i)e(n[i],i,n)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(Yp.LENGTH)}insertAt(e,n){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n),this.array_.splice(e,0,n),this.updateLength_(),this.dispatchEvent(new Ia(ct.ADD,n,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const n=this.getLength();return this.insertAt(n,e),this.getLength()}remove(e){const n=this.array_;for(let i=0,r=n.length;i<r;++i)if(n[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const n=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Ia(ct.REMOVE,n,e)),n}setAt(e,n){const i=this.getLength();if(e>=i){this.insertAt(e,n);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n,e);const r=this.array_[e];this.array_[e]=n,this.dispatchEvent(new Ia(ct.REMOVE,r,e)),this.dispatchEvent(new Ia(ct.ADD,n,e))}updateLength_(){this.set(Yp.LENGTH,this.array_.length)}assertUnique_(e,n){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==n)throw new Error("Duplicate item added to a unique collection")}}class Ir extends Xn{constructor(e,n,i){super(e),this.map=n,this.frameState=i!==void 0?i:null}}class ei extends Ir{constructor(e,n,i,r,s,o){super(e,n,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const we={SINGLECLICK:"singleclick",CLICK:J.CLICK,DBLCLICK:J.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},or=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",pS=or.includes("safari")&&!or.includes("chrom"),mS=pS&&(or.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(or)),_S=or.includes("webkit")&&!or.includes("edge"),k0=or.includes("macintosh"),yS=typeof devicePixelRatio<"u"?devicePixelRatio:1,wt=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,M0=typeof Image<"u"&&Image.prototype.decode,D0=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return t}(),ed={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class xS extends vu{constructor(e,n){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=n===void 0?1:n,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=ee(i,ed.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=ee(i,ed.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(J.TOUCHMOVE,this.boundHandleTouchMove_,D0?{passive:!1}:!1)}emulateClick_(e){let n=new ei(we.CLICK,this.map_,e);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new ei(we.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new ei(we.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const n=e,i=n.pointerId;if(n.type==we.POINTERUP||n.type==we.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==n.target){delete this.trackedTouches_[r];break}}else(n.type==we.POINTERDOWN||n.type==we.POINTERMOVE)&&(this.trackedTouches_[i]=n);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const n=new ei(we.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(ge),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const n=new ei(we.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(n),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(ee(i,we.POINTERMOVE,this.handlePointerMove_,this),ee(i,we.POINTERUP,this.handlePointerUp_,this),ee(this.element_,we.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(ee(this.element_.getRootNode(),we.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const n=new ei(we.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(n)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const n=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new ei(we.POINTERMOVE,this.map_,e,n))}handleTouchMove_(e){const n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(ge(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(J.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(ge(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(ge),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const ti={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},qe={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},G={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function te(t,e){if(!t)throw new Error(e)}const Dl=1/0;class vS{constructor(e,n){this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Is(this.queuedElements_)}dequeue(){const e=this.elements_,n=this.priorities_,i=e[0];e.length==1?(e.length=0,n.length=0):(e[0]=e.pop(),n[0]=n.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){te(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const n=this.priorityFunction_(e);return n!=Dl?(this.elements_.push(e),this.priorities_.push(n),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const n=this.elements_,i=this.priorities_,r=n.length,s=n[e],o=i[e],a=e;for(;e<r>>1;){const l=this.getLeftChildIndex_(e),u=this.getRightChildIndex_(e),c=u<r&&i[u]<i[l]?u:l;n[e]=n[c],i[e]=i[c],e=c}n[e]=s,i[e]=o,this.siftDown_(a,e)}siftDown_(e,n){const i=this.elements_,r=this.priorities_,s=i[n],o=r[n];for(;n>e;){const a=this.getParentIndex_(n);if(r[a]>o)i[n]=i[a],r[n]=r[a],n=a;else break}i[n]=s,r[n]=o}reprioritize(){const e=this.priorityFunction_,n=this.elements_,i=this.priorities_;let r=0;const s=n.length;let o,a,l;for(a=0;a<s;++a)o=n[a],l=e(o),l==Dl?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=l,n[r++]=o);n.length=r,i.length=r,this.heapify_()}}class ES extends vS{constructor(e,n){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=n,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const n=super.enqueue(e);return n&&e[0].addEventListener(J.CHANGE,this.boundHandleTileChange_),n}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const n=e.target,i=n.getState();if(i===G.LOADED||i===G.ERROR||i===G.EMPTY){i!==G.ERROR&&n.removeEventListener(J.CHANGE,this.boundHandleTileChange_);const r=n.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,n){let i=0;for(;this.tilesLoading_<e&&i<n&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===G.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function wS(t,e,n,i,r){if(!t||!(n in t.wantedTiles)||!t.wantedTiles[n][e.getKey()])return Dl;const s=t.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}const Be={ANIMATING:0,INTERACTING:1},Ht={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function _e(t,e,n){return Math.min(Math.max(t,e),n)}function SS(t,e,n,i,r,s){const o=r-n,a=s-i;if(o!==0||a!==0){const l=((t-n)*o+(e-i)*a)/(o*o+a*a);l>1?(n=r,i=s):l>0&&(n+=o*l,i+=a*l)}return es(t,e,n,i)}function es(t,e,n,i){const r=n-t,s=i-e;return r*r+s*s}function CS(t){const e=t.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(t[i][i]);for(let a=i+1;a<e;a++){const l=Math.abs(t[a][i]);l>s&&(s=l,r=a)}if(s===0)return null;const o=t[r];t[r]=t[i],t[i]=o;for(let a=i+1;a<e;a++){const l=-t[a][i]/t[i][i];for(let u=i;u<e+1;u++)i==u?t[a][u]=0:t[a][u]+=l*t[i][u]}}const n=new Array(e);for(let i=e-1;i>=0;i--){n[i]=t[i][e]/t[i][i];for(let r=i-1;r>=0;r--)t[r][e]-=t[r][i]*n[i]}return n}function Hp(t){return t*180/Math.PI}function wi(t){return t*Math.PI/180}function ts(t,e){const n=t%e;return n*e<0?n+e:n}function Ot(t,e,n){return t+n*(e-t)}function Eu(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function La(t,e){return Math.floor(Eu(t,e))}function Aa(t,e){return Math.ceil(Eu(t,e))}function td(t,e,n){if(t>=e&&t<n)return t;const i=n-e;return((t-e)%i+i)%i+e}function Kp(t,e,n){return function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const l=e?0:s[0]*r,u=e?0:s[1]*r,c=a?a[0]:0,h=a?a[1]:0;let d=t[0]+l/2+c,g=t[2]-l/2+c,f=t[1]+u/2+h,_=t[3]-u/2+h;d>g&&(d=(g+d)/2,g=d),f>_&&(f=(_+f)/2,_=f);let x=_e(i[0],d,g),m=_e(i[1],f,_);if(o&&n&&r){const p=30*r;x+=-p*Math.log(1+Math.max(0,d-i[0])/p)+p*Math.log(1+Math.max(0,i[0]-g)/p),m+=-p*Math.log(1+Math.max(0,f-i[1])/p)+p*Math.log(1+Math.max(0,i[1]-_)/p)}return[x,m]}}function TS(t){return t}const ze={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Zp(t){const e=Tt();for(let n=0,i=t.length;n<i;++n)po(e,t[n]);return e}function wu(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function N0(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function F0(t,e,n){let i,r;return e<t[0]?i=t[0]-e:t[2]<e?i=e-t[2]:i=0,n<t[1]?r=t[1]-n:t[3]<n?r=n-t[3]:r=0,i*i+r*r}function ps(t,e){return O0(t,e[0],e[1])}function Qs(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function O0(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function nd(t,e){const n=t[0],i=t[1],r=t[2],s=t[3],o=e[0],a=e[1];let l=ze.UNKNOWN;return o<n?l=l|ze.LEFT:o>r&&(l=l|ze.RIGHT),a<i?l=l|ze.BELOW:a>s&&(l=l|ze.ABOVE),l===ze.UNKNOWN&&(l=ze.INTERSECTING),l}function Tt(){return[1/0,1/0,-1/0,-1/0]}function Gn(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]}function Su(t){return Gn(1/0,1/0,-1/0,-1/0,t)}function b0(t,e){const n=t[0],i=t[1];return Gn(n,i,n,i,e)}function Sf(t,e,n,i,r){const s=Su(r);return j0(s,t,e,n,i)}function ms(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function RS(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function po(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function j0(t,e,n,i,r){for(;n<i;n+=r)PS(t,e[n],e[n+1]);return t}function PS(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function Cf(t,e){let n;return n=e(Cu(t)),n||(n=e(Tu(t)),n)||(n=e(Ru(t)),n)||(n=e(hr(t)),n)?n:!1}function id(t){let e=0;return Pu(t)||(e=ae(t)*rt(t)),e}function Cu(t){return[t[0],t[1]]}function Tu(t){return[t[2],t[1]]}function ar(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function IS(t,e){let n;if(e==="bottom-left")n=Cu(t);else if(e==="bottom-right")n=Tu(t);else if(e==="top-left")n=hr(t);else if(e==="top-right")n=Ru(t);else throw new Error("Invalid corner");return n}function rd(t,e,n,i,r){const[s,o,a,l,u,c,h,d]=z0(t,e,n,i);return Gn(Math.min(s,a,u,h),Math.min(o,l,c,d),Math.max(s,a,u,h),Math.max(o,l,c,d),r)}function z0(t,e,n,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(n),a=Math.sin(n),l=r*o,u=r*a,c=s*o,h=s*a,d=t[0],g=t[1];return[d-l+h,g-u-c,d-l-h,g-u+c,d+l-h,g+u+c,d+l+h,g+u-c,d-l+h,g-u-c]}function rt(t){return t[3]-t[1]}function qi(t,e,n){const i=n||Tt();return it(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):Su(i),i}function hr(t){return[t[0],t[3]]}function Ru(t){return[t[2],t[3]]}function ae(t){return t[2]-t[0]}function it(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Pu(t){return t[2]<t[0]||t[3]<t[1]}function LS(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function AS(t,e,n){let i=!1;const r=nd(t,e),s=nd(t,n);if(r===ze.INTERSECTING||s===ze.INTERSECTING)i=!0;else{const o=t[0],a=t[1],l=t[2],u=t[3],c=e[0],h=e[1],d=n[0],g=n[1],f=(g-h)/(d-c);let _,x;s&ze.ABOVE&&!(r&ze.ABOVE)&&(_=d-(g-u)/f,i=_>=o&&_<=l),!i&&s&ze.RIGHT&&!(r&ze.RIGHT)&&(x=g-(d-l)*f,i=x>=a&&x<=u),!i&&s&ze.BELOW&&!(r&ze.BELOW)&&(_=d-(g-a)/f,i=_>=o&&_<=l),!i&&s&ze.LEFT&&!(r&ze.LEFT)&&(x=g-(d-o)*f,i=x>=a&&x<=u)}return i}function $0(t,e){const n=e.getExtent(),i=ar(t);if(e.canWrapX()&&(i[0]<n[0]||i[0]>=n[2])){const r=ae(n),o=Math.floor((i[0]-n[0])/r)*r;t[0]-=o,t[2]-=o}return t}function B0(t,e,n){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[i[0],t[1],i[2],t[3]]];$0(t,e);const r=ae(i);if(ae(t)>r&&!n)return[[i[0],t[1],i[2],t[3]]];if(t[0]<i[0])return[[t[0]+r,t[1],i[2],t[3]],[i[0],t[1],t[2],t[3]]];if(t[2]>i[2])return[[t[0],t[1],i[2],t[3]],[i[0],t[1],t[2]-r,t[3]]]}return[t]}function kS(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function Nl(t,e){let n=!0;for(let i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n}function Tf(t,e){const n=Math.cos(e),i=Math.sin(e),r=t[0]*n-t[1]*i,s=t[1]*n+t[0]*i;return t[0]=r,t[1]=s,t}function MS(t,e){return t[0]*=e,t[1]*=e,t}function G0(t,e){if(e.canWrapX()){const n=ae(e.getExtent()),i=DS(t,e,n);i&&(t[0]-=i*n)}return t}function DS(t,e,n){const i=e.getExtent();let r=0;return e.canWrapX()&&(t[0]<i[0]||t[0]>i[2])&&(n=n||ae(i),r=Math.floor((t[0]-i[0])/n)),r}function U0(t){return Math.pow(t,3)}function Ls(t){return 1-U0(1-t)}function NS(t){return 3*t*t-2*t*t*t}function FS(t){return t}const OS=63710088e-1;function qp(t,e,n){n=n||OS;const i=wi(t[1]),r=wi(e[1]),s=(r-i)/2,o=wi(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*n*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function W0(...t){console.warn(...t)}const Rf={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Pf{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Rf[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const ia=6378137,Wr=Math.PI*ia,bS=[-Wr,-Wr,Wr,Wr],jS=[-180,-85,180,85],ka=ia*Math.log(Math.tan(Math.PI/2));class yr extends Pf{constructor(e){super({code:e,units:"m",extent:bS,global:!0,worldExtent:jS,getPointResolution:function(n,i){return n/Math.cosh(i[1]/ia)}})}}const Jp=[new yr("EPSG:3857"),new yr("EPSG:102100"),new yr("EPSG:102113"),new yr("EPSG:900913"),new yr("http://www.opengis.net/def/crs/EPSG/0/3857"),new yr("http://www.opengis.net/gml/srs/epsg.xml#3857")];function zS(t,e,n,i){const r=t.length;n=n>1?n:2,i=i??n,e===void 0&&(n>2?e=t.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Wr*t[s]/180;let o=ia*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));o>ka?o=ka:o<-ka&&(o=-ka),e[s+1]=o}return e}function $S(t,e,n,i){const r=t.length;n=n>1?n:2,i=i??n,e===void 0&&(n>2?e=t.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*t[s]/Wr,e[s+1]=360*Math.atan(Math.exp(t[s+1]/ia))/Math.PI-90;return e}const BS=6378137,Qp=[-180,-90,180,90],GS=Math.PI*BS/180;class Fi extends Pf{constructor(e,n){super({code:e,units:"degrees",extent:Qp,axisOrientation:n,global:!0,metersPerUnit:GS,worldExtent:Qp})}}const em=[new Fi("CRS:84"),new Fi("EPSG:4326","neu"),new Fi("urn:ogc:def:crs:OGC:1.3:CRS84"),new Fi("urn:ogc:def:crs:OGC:2:84"),new Fi("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Fi("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Fi("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let sd={};function US(t){return sd[t]||sd[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function WS(t,e){sd[t]=e}let ns={};function zo(t,e,n){const i=t.getCode(),r=e.getCode();i in ns||(ns[i]={}),ns[i][r]=n}function Ec(t,e){return t in ns&&e in ns[t]?ns[t][e]:null}const Fl=.9996,Ut=.00669438,Iu=Ut*Ut,Lu=Iu*Ut,Xi=Ut/(1-Ut),tm=Math.sqrt(1-Ut),_s=(1-tm)/(1+tm),X0=_s*_s,If=X0*_s,Lf=If*_s,V0=Lf*_s,Y0=1-Ut/4-3*Iu/64-5*Lu/256,XS=3*Ut/8+3*Iu/32+45*Lu/1024,VS=15*Iu/256+45*Lu/1024,YS=35*Lu/3072,HS=3/2*_s-27/32*If+269/512*V0,KS=21/16*X0-55/32*Lf,ZS=151/96*If-417/128*V0,qS=1097/512*Lf,Ol=6378137;function JS(t,e,n){const i=t-5e5,o=(n.north?e:e-1e7)/Fl/(Ol*Y0),a=o+HS*Math.sin(2*o)+KS*Math.sin(4*o)+ZS*Math.sin(6*o)+qS*Math.sin(8*o),l=Math.sin(a),u=l*l,c=Math.cos(a),h=l/c,d=h*h,g=d*d,f=1-Ut*u,_=Math.sqrt(1-Ut*u),x=Ol/_,m=(1-Ut)/f,p=Xi*c**2,y=p*p,v=i/(x*Fl),w=v*v,C=w*v,R=C*v,T=R*v,I=T*v,A=a-h/m*(w/2-R/24*(5+3*d+10*p-4*y-9*Xi))+I/720*(61+90*d+298*p+45*g-252*Xi-3*y);let j=(v-C/6*(1+2*d+p)+T/120*(5-2*p+28*d-3*y+8*Xi+24*g))/c;return j=td(j+wi(H0(n.number)),-Math.PI,Math.PI),[Hp(j),Hp(A)]}const nm=-80,im=84,QS=-180,eC=180;function tC(t,e,n){t=td(t,QS,eC),e<nm?e=nm:e>im&&(e=im);const i=wi(e),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,l=a*a,u=wi(t),c=H0(n.number),h=wi(c),d=Ol/Math.sqrt(1-Ut*r**2),g=Xi*s**2,f=s*td(u-h,-Math.PI,Math.PI),_=f*f,x=_*f,m=x*f,p=m*f,y=p*f,v=Ol*(Y0*i-XS*Math.sin(2*i)+VS*Math.sin(4*i)-YS*Math.sin(6*i)),w=Fl*d*(f+x/6*(1-a+g)+p/120*(5-18*a+l+72*g-58*Xi))+5e5;let C=Fl*(v+d*o*(_/2+m/24*(5-a+9*g+4*g**2)+y/720*(61-58*a+l+600*g-330*Xi)));return n.north||(C+=1e7),[w,C]}function H0(t){return(t-1)*6-180+3}const nC=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function K0(t){let e=0;for(const r of nC){const s=t.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let n=0,i=!1;return e>32700&&e<32761?n=e-32700:e>32600&&e<32661&&(i=!0,n=e-32600),n?{number:n,north:i}:null}function rm(t,e){return function(n,i,r,s){const o=n.length;r=r>1?r:2,s=s??r,i||(r>2?i=n.slice():i=new Array(o));for(let a=0;a<o;a+=s){const l=n[a],u=n[a+1],c=t(l,u,e);i[a]=c[0],i[a+1]=c[1]}return i}}function iC(t){return K0(t)?new Pf({code:t,units:"m"}):null}function rC(t){const e=K0(t.getCode());return e?{forward:rm(tC,e),inverse:rm(JS,e)}:null}const sC=[rC],oC=[iC];let od=!0;function Z0(t){od=!1}function Af(t,e){if(e!==void 0){for(let n=0,i=t.length;n<i;++n)e[n]=t[n];e=e}else e=t.slice();return e}function ad(t){WS(t.getCode(),t),zo(t,t,Af)}function aC(t){t.forEach(ad)}function _t(t){if(typeof t!="string")return t;const e=US(t);if(e)return e;for(const n of oC){const i=n(t);if(i)return i}return null}function sm(t,e,n,i){t=_t(t);let r;const s=t.getPointResolutionFunc();if(s)r=s(e,n);else{const o=t.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const a=Mf(t,_t("EPSG:4326"));if(!a&&o!=="degrees")r=e*t.getMetersPerUnit();else{let u=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];u=a(u,u,2);const c=qp(u.slice(0,2),u.slice(2,4)),h=qp(u.slice(4,6),u.slice(6,8));r=(c+h)/2}const l=t.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function om(t){aC(t),t.forEach(function(e){t.forEach(function(n){e!==n&&zo(e,n,Af)})})}function lC(t,e,n,i){t.forEach(function(r){e.forEach(function(s){zo(r,s,n),zo(s,r,i)})})}function kf(t,e){return t?typeof t=="string"?_t(t):t:_t(e)}function uC(t){return function(e,n,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,n=n!==void 0?n:new Array(s);for(let o=0;o<s;o+=r){const a=t(e.slice(o,o+i)),l=a.length;for(let u=0,c=r;u<c;++u)n[o+u]=u>=l?e[o+u]:a[u]}return n}}function Ma(t,e){return Z0(),Df(t,"EPSG:4326","EPSG:3857")}function il(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Mf(t,e)===Af)&&n}function Mf(t,e){const n=t.getCode(),i=e.getCode();let r=Ec(n,i);if(r)return r;let s=null,o=null;for(const l of sC)s||(s=l(t)),o||(o=l(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=wc(s.inverse,o.forward);else{const l=Ec(n,a);l&&(r=wc(l,o.forward))}else{const l=Ec(a,i);l&&(r=wc(s.inverse,l))}return r&&(ad(t),ad(e),zo(t,e,r)),r}function wc(t,e){return function(n,i,r,s){return i=t(n,i,r,s),e(i,i,r,s)}}function bl(t,e){const n=_t(t),i=_t(e);return Mf(n,i)}function Df(t,e,n){const i=bl(e,n);if(!i){const r=_t(e).getCode(),s=_t(n).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(t,void 0,t.length)}function ld(t,e){return t}function Rn(t,e){return od&&!Nl(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(od=!1,W0("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function q0(t,e){return t}function ci(t,e){return t}function cC(){om(Jp),om(em),lC(em,Jp,zS,$S)}cC();const hC=new Array(6);function be(){return[1,0,0,1,0,0]}function J0(t,e){const n=t[0],i=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=e[0],u=e[1],c=e[2],h=e[3],d=e[4],g=e[5];return t[0]=n*l+r*u,t[1]=i*l+s*u,t[2]=n*c+r*h,t[3]=i*c+s*h,t[4]=n*d+r*g+o,t[5]=i*d+s*g+a,t}function dC(t,e,n,i,r,s,o){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=o,t}function Q0(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Pe(t,e){const n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function fC(t,e,n){return J0(t,dC(hC,1,0,0,1,e,n))}function tn(t,e,n,i,r,s,o,a){const l=Math.sin(s),u=Math.cos(s);return t[0]=i*u,t[1]=r*l,t[2]=-i*l,t[3]=r*u,t[4]=o*i*u-a*i*l+e,t[5]=o*r*l+a*r*u+n,t}function $o(t,e){const n=gC(e);te(n!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return t[0]=o/n,t[1]=-r/n,t[2]=-s/n,t[3]=i/n,t[4]=(s*l-o*a)/n,t[5]=-(i*l-r*a)/n,t}function gC(t){return t[0]*t[3]-t[1]*t[2]}const pC=[1e5,1e5,1e5,1e5,2,2];function mC(t){return"matrix("+t.join(", ")+")"}function ud(t){return t.substring(7,t.length-1).split(",").map(parseFloat)}function _C(t,e){const n=ud(t),i=ud(e);for(let r=0;r<6;++r)if(Math.round((n[r]-i[r])*pC[r])!==0)return!1;return!0}function yn(t,e,n,i,r,s,o){s=s||[],o=o||2;let a=0;for(let l=e;l<n;l+=i){const u=t[l],c=t[l+1];s[a++]=r[0]*u+r[2]*c+r[4],s[a++]=r[1]*u+r[3]*c+r[5];for(let h=2;h<o;h++)s[a++]=t[l+h]}return s&&s.length!=a&&(s.length=a),s}function Nf(t,e,n,i,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),u=s[0],c=s[1];let h=0;for(let d=e;d<n;d+=i){const g=t[d]-u,f=t[d+1]-c;o[h++]=u+g*a-f*l,o[h++]=c+g*l+f*a;for(let _=d+2;_<d+i;++_)o[h++]=t[_]}return o&&o.length!=h&&(o.length=h),o}function yC(t,e,n,i,r,s,o,a){a=a||[];const l=o[0],u=o[1];let c=0;for(let h=e;h<n;h+=i){const d=t[h]-l,g=t[h+1]-u;a[c++]=l+r*d,a[c++]=u+s*g;for(let f=h+2;f<h+i;++f)a[c++]=t[f]}return a&&a.length!=c&&(a.length=c),a}function xC(t,e,n,i,r,s,o){o=o||[];let a=0;for(let l=e;l<n;l+=i){o[a++]=t[l]+r,o[a++]=t[l+1]+s;for(let u=l+2;u<l+i;++u)o[a++]=t[u]}return o&&o.length!=a&&(o.length=a),o}const am=be(),vC=[NaN,NaN];class EC extends xn{constructor(){super(),this.extent_=Tt(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=A0((e,n,i)=>{if(!i)return this.getSimplifiedGeometry(n);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(n)})}simplifyTransformed(e,n){return this.simplifyTransformedInternal(this.getRevision(),e,n)}clone(){return re()}closestPointXY(e,n,i,r){return re()}containsXY(e,n){return this.closestPointXY(e,n,vC,Number.MIN_VALUE)===0}getClosestPoint(e,n){return n=n||[NaN,NaN],this.closestPointXY(e[0],e[1],n,1/0),n}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return re()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&Su(n),this.extentRevision_=this.getRevision()}return LS(this.extent_,e)}rotate(e,n){re()}scale(e,n,i){re()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return re()}getType(){return re()}applyTransform(e){re()}intersectsExtent(e){return re()}translate(e,n){re()}transform(e,n){const i=_t(e),r=i.getUnits()=="tile-pixels"?function(s,o,a){const l=i.getExtent(),u=i.getWorldExtent(),c=rt(u)/rt(l);tn(am,u[0],u[3],c,-c,0,0,0);const h=yn(s,0,s.length,a,am,o),d=bl(i,n);return d?d(h,h,a):h}:bl(i,n);return this.applyTransform(r),this}}class Au extends EC{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Sf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return re()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=this.getSimplifiedGeometryInternal(e);return n.getFlatCoordinates().length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,n){this.stride=lm(e),this.layout=e,this.flatCoordinates=n}setCoordinates(e,n){re()}setLayout(e,n,i){let r;if(e)r=lm(e);else{for(let s=0;s<i;++s){if(n.length===0){this.layout="XY",this.stride=2;return}n=n[0]}r=n.length,e=wC(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,n){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Nf(i,0,i.length,r,e,n,i),this.changed()}}scale(e,n,i){n===void 0&&(n=e),i||(i=ar(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();yC(r,0,r.length,s,e,n,i,r),this.changed()}}translate(e,n){const i=this.getFlatCoordinates();if(i){const r=this.getStride();xC(i,0,i.length,r,e,n,i),this.changed()}}}function wC(t){let e;return t==2?e="XY":t==3?e="XYZ":t==4&&(e="XYZM"),e}function lm(t){let e;return t=="XY"?e=2:t=="XYZ"||t=="XYM"?e=3:t=="XYZM"&&(e=4),e}function SC(t,e,n){const i=t.getFlatCoordinates();if(!i)return null;const r=t.getStride();return yn(i,0,i.length,r,e,n)}function ex(t,e,n,i){let r=0;const s=t[n-i],o=t[n-i+1];let a=0,l=0;for(;e<n;e+=i){const u=t[e]-s,c=t[e+1]-o;r+=l*u-a*c,a=u,l=c}return r/2}function CC(t,e,n,i){let r=0;for(let s=0,o=n.length;s<o;++s){const a=n[s];r+=ex(t,e,a,i),e=a}return r}function um(t,e,n,i,r,s,o){const a=t[e],l=t[e+1],u=t[n]-a,c=t[n+1]-l;let h;if(u===0&&c===0)h=e;else{const d=((r-a)*u+(s-l)*c)/(u*u+c*c);if(d>1)h=n;else if(d>0){for(let g=0;g<i;++g)o[g]=Ot(t[e+g],t[n+g],d);o.length=i;return}else h=e}for(let d=0;d<i;++d)o[d]=t[h+d];o.length=i}function tx(t,e,n,i,r){let s=t[e],o=t[e+1];for(e+=i;e<n;e+=i){const a=t[e],l=t[e+1],u=es(s,o,a,l);u>r&&(r=u),s=a,o=l}return r}function TC(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){const a=n[s];r=tx(t,e,a,i,r),e=a}return r}function nx(t,e,n,i,r,s,o,a,l,u,c){if(e==n)return u;let h,d;if(r===0){if(d=es(o,a,t[e],t[e+1]),d<u){for(h=0;h<i;++h)l[h]=t[e+h];return l.length=i,d}return u}c=c||[NaN,NaN];let g=e+i;for(;g<n;)if(um(t,g-i,g,i,o,a,c),d=es(o,a,c[0],c[1]),d<u){for(u=d,h=0;h<i;++h)l[h]=c[h];l.length=i,g+=i}else g+=i*Math.max((Math.sqrt(d)-Math.sqrt(u))/r|0,1);if(um(t,n-i,e,i,o,a,c),d=es(o,a,c[0],c[1]),d<u){for(u=d,h=0;h<i;++h)l[h]=c[h];l.length=i}return u}function RC(t,e,n,i,r,s,o,a,l,u,c){c=c||[NaN,NaN];for(let h=0,d=n.length;h<d;++h){const g=n[h];u=nx(t,e,g,i,r,s,o,a,l,u,c),e=g}return u}function ix(t,e,n,i){for(let r=0,s=n.length;r<s;++r)t[e++]=n[r];return e}function rx(t,e,n,i){for(let r=0,s=n.length;r<s;++r){const o=n[r];for(let a=0;a<i;++a)t[e++]=o[a]}return e}function PC(t,e,n,i,r){r=r||[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=rx(t,e,n[o],i);r[s++]=l,e=l}return r.length=s,r}function Xr(t,e,n,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<n;o+=i)r[s++]=t.slice(o,o+i);return r.length=s,r}function jl(t,e,n,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];r[s++]=Xr(t,e,l,i,r[s]),e=l}return r.length=s,r}function cm(t,e,n,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];r[s++]=l.length===1&&l[0]===e?[]:jl(t,e,l,i,r[s]),e=l[l.length-1]}return r.length=s,r}function Ff(t,e,n,i,r,s,o){const a=(n-e)/i;if(a<3){for(;e<n;e+=i)s[o++]=t[e],s[o++]=t[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const u=[e,n-i];let c=0;for(;u.length>0;){const h=u.pop(),d=u.pop();let g=0;const f=t[d],_=t[d+1],x=t[h],m=t[h+1];for(let p=d+i;p<h;p+=i){const y=t[p],v=t[p+1],w=SS(y,v,f,_,x,m);w>g&&(c=p,g=w)}g>r&&(l[(c-e)/i]=1,d+i<c&&u.push(d,c),c+i<h&&u.push(c,h))}for(let h=0;h<a;++h)l[h]&&(s[o++]=t[e+h*i],s[o++]=t[e+h*i+1]);return o}function IC(t,e,n,i,r,s,o,a){for(let l=0,u=n.length;l<u;++l){const c=n[l];o=Ff(t,e,c,i,r,s,o),a.push(o),e=c}return o}function zi(t,e){return e*Math.round(t/e)}function LC(t,e,n,i,r,s,o){if(e==n)return o;let a=zi(t[e],r),l=zi(t[e+1],r);e+=i,s[o++]=a,s[o++]=l;let u,c;do if(u=zi(t[e],r),c=zi(t[e+1],r),e+=i,e==n)return s[o++]=u,s[o++]=c,o;while(u==a&&c==l);for(;e<n;){const h=zi(t[e],r),d=zi(t[e+1],r);if(e+=i,h==u&&d==c)continue;const g=u-a,f=c-l,_=h-a,x=d-l;if(g*x==f*_&&(g<0&&_<g||g==_||g>0&&_>g)&&(f<0&&x<f||f==x||f>0&&x>f)){u=h,c=d;continue}s[o++]=u,s[o++]=c,a=u,l=c,u=h,c=d}return s[o++]=u,s[o++]=c,o}function sx(t,e,n,i,r,s,o,a){for(let l=0,u=n.length;l<u;++l){const c=n[l];o=LC(t,e,c,i,r,s,o),a.push(o),e=c}return o}class Bo extends Au{constructor(e,n){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}clone(){return new Bo(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,n,i,r){return r<F0(this.getExtent(),e,n)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(tx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),nx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,n,i,r))}getArea(){return ex(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Xr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const n=[];return n.length=Ff(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new Bo(n,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=rx(this.flatCoordinates,0,e,this.stride),this.changed()}}class is extends Au{constructor(e,n){super(),this.setCoordinates(e,n)}clone(){const e=new is(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,i,r){const s=this.flatCoordinates,o=es(e,n,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return b0(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return O0(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ix(this.flatCoordinates,0,e,this.stride),this.changed()}}function AC(t,e,n,i,r){return!Cf(r,function(o){return!Vi(t,e,n,i,o[0],o[1])})}function Vi(t,e,n,i,r,s){let o=0,a=t[n-i],l=t[n-i+1];for(;e<n;e+=i){const u=t[e],c=t[e+1];l<=s?c>s&&(u-a)*(s-l)-(r-a)*(c-l)>0&&o++:c<=s&&(u-a)*(s-l)-(r-a)*(c-l)<0&&o--,a=u,l=c}return o!==0}function ox(t,e,n,i,r,s){if(n.length===0||!Vi(t,e,n[0],i,r,s))return!1;for(let o=1,a=n.length;o<a;++o)if(Vi(t,n[o-1],n[o],i,r,s))return!1;return!0}function Of(t,e,n,i,r,s,o){let a,l,u,c,h,d,g;const f=r[s+1],_=[];for(let p=0,y=n.length;p<y;++p){const v=n[p];for(c=t[v-i],d=t[v-i+1],a=e;a<v;a+=i)h=t[a],g=t[a+1],(f<=d&&g<=f||d<=f&&f<=g)&&(u=(f-d)/(g-d)*(h-c)+c,_.push(u)),c=h,d=g}let x=NaN,m=-1/0;for(_.sort(Fn),c=_[0],a=1,l=_.length;a<l;++a){h=_[a];const p=Math.abs(h-c);p>m&&(u=(c+h)/2,ox(t,e,n,i,u,f)&&(x=u,m=p)),c=h}return isNaN(x)&&(x=r[s]),o?(o.push(x,f,m),o):[x,f,m]}function kC(t,e,n,i,r){let s=[];for(let o=0,a=n.length;o<a;++o){const l=n[o];s=Of(t,e,l,i,r,2*o,s),e=l[l.length-1]}return s}function MC(t,e,n,i,r){let s;for(e+=i;e<n;e+=i)if(s=r(t.slice(e-i,e),t.slice(e,e+i)),s)return s;return!1}function ax(t,e,n,i,r,s){return s=s??j0(Tt(),t,e,n,i),it(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:MC(t,e,n,i,function(o,a){return AS(r,o,a)}):!1}function lx(t,e,n,i,r){return!!(ax(t,e,n,i,r)||Vi(t,e,n,i,r[0],r[1])||Vi(t,e,n,i,r[0],r[3])||Vi(t,e,n,i,r[2],r[1])||Vi(t,e,n,i,r[2],r[3]))}function DC(t,e,n,i,r){if(!lx(t,e,n[0],i,r))return!1;if(n.length===1)return!0;for(let s=1,o=n.length;s<o;++s)if(AC(t,n[s-1],n[s],i,r)&&!ax(t,n[s-1],n[s],i,r))return!1;return!0}function NC(t,e,n,i){for(;e<n-i;){for(let r=0;r<i;++r){const s=t[e+r];t[e+r]=t[n-i+r],t[n-i+r]=s}e+=i,n-=i}}function bf(t,e,n,i){let r=0,s=t[n-i],o=t[n-i+1];for(;e<n;e+=i){const a=t[e],l=t[e+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function FC(t,e,n,i,r){r=r!==void 0?r:!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=bf(t,e,a,i);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;e=a}return!0}function hm(t,e,n,i,r){r=r!==void 0?r:!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=bf(t,e,a,i);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&NC(t,e,a,i),e=a}return e}function ux(t,e){const n=[];let i=0,r=0,s;for(let o=0,a=e.length;o<a;++o){const l=e[o],u=bf(t,i,l,2);if(s===void 0&&(s=u),u===s)n.push(e.slice(r,o+1));else{if(n.length===0)continue;n[n.length-1].push(e[r])}r=o+1,i=l}return n}class Go extends Au{constructor(e,n,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,n!==void 0&&i?(this.setFlatCoordinates(n,e),this.ends_=i):this.setCoordinates(e,n)}appendLinearRing(e){this.flatCoordinates?wf(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Go(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,i,r){return r<F0(this.getExtent(),e,n)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(TC(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),RC(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,n,i,r))}containsXY(e,n){return ox(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,n)}getArea(){return CC(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),hm(n,0,this.ends_,this.stride,e)):n=this.flatCoordinates,jl(n,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=ar(this.getExtent());this.flatInteriorPoint_=Of(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new is(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Bo(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,n=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],u=new Bo(n.slice(s,l),e);r.push(u),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;FC(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=hm(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],i=[];return n.length=sx(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),n,0,i),new Go(n,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return DC(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=PC(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function dm(t){if(Pu(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],i=t[2],r=t[3],s=[e,n,e,r,i,r,i,n,e,n];return new Go(s,"XY",[s.length])}function jf(t,e,n,i){const r=ae(e)/n[0],s=rt(e)/n[1];return i?Math.min(t,Math.max(r,s)):Math.min(t,Math.min(r,s))}function zf(t,e,n){let i=Math.min(t,e);const r=50;return i*=Math.log(1+r*Math.max(0,t/e-1))/r+1,n&&(i=Math.max(i,n),i/=Math.log(1+r*Math.max(0,n/t-1))/r+1),_e(i,n/2,e*2)}function OC(t,e,n,i){return e=e!==void 0?e:!0,function(r,s,o,a){if(r!==void 0){const l=t[0],u=t[t.length-1],c=n?jf(l,n,o,i):l;if(a)return e?zf(r,c,u):_e(r,u,c);const h=Math.min(c,r),d=Math.floor(Ef(t,h,s));return t[d]>c&&d<t.length-1?t[d+1]:t[d]}}}function bC(t,e,n,i,r,s){return i=i!==void 0?i:!0,n=n!==void 0?n:0,function(o,a,l,u){if(o!==void 0){const c=r?jf(e,r,l,s):e;if(u)return i?zf(o,c,n):_e(o,n,c);const h=1e-9,d=Math.ceil(Math.log(e/c)/Math.log(t)-h),g=-a*(.5-h)+.5,f=Math.min(c,o),_=Math.floor(Math.log(e/f)/Math.log(t)+g),x=Math.max(d,_),m=e/Math.pow(t,x);return _e(m,n,c)}}}function fm(t,e,n,i,r){return n=n!==void 0?n:!0,function(s,o,a,l){if(s!==void 0){const u=i?jf(t,i,a,r):t;return!n||!l?_e(s,e,u):zf(s,u,e)}}}function $f(t){if(t!==void 0)return 0}function gm(t){if(t!==void 0)return t}function jC(t){const e=2*Math.PI/t;return function(n,i){if(i)return n;if(n!==void 0)return n=Math.floor(n/e+.5)*e,n}}function zC(t){const e=wi(5);return function(n,i){return i||n===void 0?n:Math.abs(n)<=e?0:n}}const $C=42,Bf=256,Sc=0;class fn extends xn{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=kf(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Z0(),e.center&&(e.center=Rn(e.center,this.projection_)),e.extent&&(e.extent=ci(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const n=Object.assign({},e);for(const a in Ht)delete n[a];this.setProperties(n,!0);const i=GC(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=BC(e),s=i.constraint,o=UC(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let n=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];n=n||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-n[3]+n[1]-r[1]),a=s/2*(r[0]-n[0]+n[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Object.assign({},n,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const n=new Array(arguments.length);for(let i=0;i<n.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Rn(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Rn(r.anchor,this.getProjection())),n[i]=r}this.animateInternal.apply(this,n)}animateInternal(e){let n=arguments.length,i;n>1&&typeof arguments[n-1]=="function"&&(i=arguments[n-1],--n);let r=0;for(;r<n&&!this.isDef();++r){const c=arguments[r];c.center&&this.setCenterInternal(c.center),c.zoom!==void 0?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),c.rotation!==void 0&&this.setRotation(c.rotation)}if(r===n){i&&Da(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const u=[];for(;r<n;++r){const c=arguments[r],h={start:s,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||NS,callback:i};if(c.center&&(h.sourceCenter=o,h.targetCenter=c.center.slice(),o=h.targetCenter),c.zoom!==void 0?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(c.zoom),a=h.targetResolution):c.resolution&&(h.sourceResolution=a,h.targetResolution=c.resolution,a=h.targetResolution),c.rotation!==void 0){h.sourceRotation=l;const d=ts(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=l+d,l=h.targetRotation}WC(h)?h.complete=!0:s+=h.duration,u.push(h)}this.animations_.push(u),this.setHint(Be.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Be.ANIMATING]>0}getInteracting(){return this.hints_[Be.INTERACTING]>0}cancelAnimations(){this.setHint(Be.ANIMATING,-this.hints_[Be.ANIMATING]);let e;for(let n=0,i=this.animations_.length;n<i;++n){const r=this.animations_[n];if(r[0].callback&&Da(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let n=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;const u=e-l.start;let c=l.duration>0?u/l.duration:1;c>=1?(l.complete=!0,c=1):s=!1;const h=l.easing(c);if(l.sourceCenter){const d=l.sourceCenter[0],g=l.sourceCenter[1],f=l.targetCenter[0],_=l.targetCenter[1];this.nextCenter_=l.targetCenter;const x=d+h*(f-d),m=g+h*(_-g);this.targetCenter_=[x,m]}if(l.sourceResolution&&l.targetResolution){const d=h===1?l.targetResolution:l.sourceResolution+h*(l.targetResolution-l.sourceResolution);if(l.anchor){const g=this.getViewportSize_(this.getRotation()),f=this.constraints_.resolution(d,0,g,!0);this.targetCenter_=this.calculateCenterZoom(f,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=h===1?ts(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+h*(l.targetRotation-l.sourceRotation);if(l.anchor){const g=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(g,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),n=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(Be.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Da(o,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,n){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-n[0],r[1]-n[1]],Tf(i,e-this.getRotation()),kS(i,n)),i}calculateCenterZoom(e,n){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=n[0]-e*(n[0]-r[0])/s,a=n[1]-e*(n[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(e){const n=this.viewportSize_;if(e){const i=n[0],r=n[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return n}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&ld(e,this.getProjection())}getCenterInternal(){return this.get(Ht.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const n=this.calculateExtentInternal(e);return q0(n,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const n=this.getCenterInternal();te(n,"The view center is not defined");const i=this.getResolution();te(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return te(r!==void 0,"The view rotation is not defined"),rd(n,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Ht.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,n){return this.getResolutionForExtentInternal(ci(e,this.getProjection()),n)}getResolutionForExtentInternal(e,n){n=n||this.getViewportSizeMinusPadding_();const i=ae(e)/n[0],r=rt(e)/n[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const n=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(n/i)/Math.log(e);return function(s){return n/Math.pow(e,s*r)}}getRotation(){return this.get(Ht.ROTATION)}getValueForResolutionFunction(e){const n=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/n;return function(o){return Math.log(i/o)/n/s}}getViewportSizeMinusPadding_(e){let n=this.getViewportSize_(e);const i=this.padding_;return i&&(n=[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]),n}getState(){const e=this.getProjection(),n=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=Cc(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],n,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const n=this.getResolution();return n!==void 0&&(e=this.getZoomForResolution(n)),e}getZoomForResolution(e){let n=this.minZoom_||0,i,r;if(this.resolutions_){const s=Ef(this.resolutions_,e,1);n=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return n+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){var n;if((n=this.resolutions_)!=null&&n.length){if(this.resolutions_.length===1)return this.resolutions_[0];const i=_e(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[i]/this.resolutions_[i+1];return this.resolutions_[i]/Math.pow(r,_e(e-i,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,n){let i;if(te(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){te(!Pu(e),"Cannot fit empty extent provided as `geometry`");const r=ci(e,this.getProjection());i=dm(r)}else if(e.getType()==="Circle"){const r=ci(e.getExtent(),this.getProjection());i=dm(r),i.rotate(this.getRotation(),ar(r))}else i=e;this.fitInternal(i,n)}rotatedExtentForGeometry(e){const n=this.getRotation(),i=Math.cos(n),r=Math.sin(-n),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let h=0,d=s.length;h<d;h+=o){const g=s[h]*i-s[h+1]*r,f=s[h]*r+s[h+1]*i;a=Math.min(a,g),l=Math.min(l,f),u=Math.max(u,g),c=Math.max(c,f)}return[a,l,u,c]}fitInternal(e,n){n=n||{};let i=n.size;i||(i=this.getViewportSizeMinusPadding_());const r=n.padding!==void 0?n.padding:[0,0,0,0],s=n.nearest!==void 0?n.nearest:!1;let o;n.minResolution!==void 0?o=n.minResolution:n.maxZoom!==void 0?o=this.getResolutionForZoom(n.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const u=this.getRotation(),c=Math.sin(u),h=Math.cos(u),d=ar(a);d[0]+=(r[1]-r[3])/2*l,d[1]+=(r[0]-r[2])/2*l;const g=d[0]*h-d[1]*c,f=d[1]*h+d[0]*c,_=this.getConstrainedCenter([g,f],l),x=n.callback?n.callback:jo;n.duration!==void 0?this.animateInternal({resolution:l,center:_,duration:n.duration,easing:n.easing},x):(this.targetResolution_=l,this.targetCenter_=_,this.applyTargetState_(!1,!0),Da(x,!0))}centerOn(e,n,i){this.centerOnInternal(Rn(e,this.getProjection()),n,i)}centerOnInternal(e,n,i){this.setCenterInternal(Cc(e,n,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,n,i,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),l=Cc(e,r,[a[0]/2+o[3],a[1]/2+o[0]],n,i);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const n=ld(this.targetCenter_,this.getProjection());this.setCenter([n[0]+e[0],n[1]+e[1]])}adjustCenterInternal(e){const n=this.targetCenter_;this.setCenterInternal([n[0]+e[0],n[1]+e[1]])}adjustResolution(e,n){n=n&&Rn(n,this.getProjection()),this.adjustResolutionInternal(e,n)}adjustResolutionInternal(e,n){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);n&&(this.targetCenter_=this.calculateCenterZoom(s,n)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,n){this.adjustResolution(Math.pow(this.zoomFactor_,-e),n)}adjustRotation(e,n){n&&(n=Rn(n,this.getProjection())),this.adjustRotationInternal(e,n)}adjustRotationInternal(e,n){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);n&&(this.targetCenter_=this.calculateCenterRotate(r,n)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Rn(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,n){return this.hints_[e]+=n,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,n){const i=this.getAnimating()||this.getInteracting()||n,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(Ht.ROTATION)!==r&&this.set(Ht.ROTATION,r),this.get(Ht.RESOLUTION)!==o&&(this.set(Ht.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Ht.CENTER)||!Nl(this.get(Ht.CENTER),a))&&this.set(Ht.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,n,i){e=e!==void 0?e:200;const r=n||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!Nl(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:Ls,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Be.INTERACTING,1)}endInteraction(e,n,i){i=i&&Rn(i,this.getProjection()),this.endInteractionInternal(e,n,i)}endInteractionInternal(e,n,i){this.getInteracting()&&(this.setHint(Be.INTERACTING,-1),this.resolveConstraints(e,n,i))}getConstrainedCenter(e,n){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,n||this.getResolution(),i)}getConstrainedZoom(e,n){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,n))}getConstrainedResolution(e,n){n=n||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,n,i)}}function Da(t,e){setTimeout(function(){t(e)},0)}function BC(t){if(t.extent!==void 0){const n=t.smoothExtentConstraint!==void 0?t.smoothExtentConstraint:!0;return Kp(t.extent,t.constrainOnlyCenter,n)}const e=kf(t.projection,"EPSG:3857");if(t.multiWorld!==!0&&e.isGlobal()){const n=e.getExtent().slice();return n[0]=-1/0,n[2]=1/0,Kp(n,!1,!1)}return TS}function GC(t){let e,n,i,o=t.minZoom!==void 0?t.minZoom:Sc,a=t.maxZoom!==void 0?t.maxZoom:28;const l=t.zoomFactor!==void 0?t.zoomFactor:2,u=t.multiWorld!==void 0?t.multiWorld:!1,c=t.smoothResolutionConstraint!==void 0?t.smoothResolutionConstraint:!0,h=t.showFullExtent!==void 0?t.showFullExtent:!1,d=kf(t.projection,"EPSG:3857"),g=d.getExtent();let f=t.constrainOnlyCenter,_=t.extent;if(!u&&!_&&d.isGlobal()&&(f=!1,_=g),t.resolutions!==void 0){const x=t.resolutions;n=x[o],i=x[a]!==void 0?x[a]:x[x.length-1],t.constrainResolution?e=OC(x,c,!f&&_,h):e=fm(n,i,c,!f&&_,h)}else{const m=(g?Math.max(ae(g),rt(g)):360*Rf.degrees/d.getMetersPerUnit())/Bf/Math.pow(2,Sc),p=m/Math.pow(2,28-Sc);n=t.maxResolution,n!==void 0?o=0:n=m/Math.pow(l,o),i=t.minResolution,i===void 0&&(t.maxZoom!==void 0?t.maxResolution!==void 0?i=n/Math.pow(l,a):i=m/Math.pow(l,a):i=p),a=o+Math.floor(Math.log(n/i)/Math.log(l)),i=n/Math.pow(l,a-o),t.constrainResolution?e=bC(l,n,i,c,!f&&_,h):e=fm(n,i,c,!f&&_,h)}return{constraint:e,maxResolution:n,minResolution:i,minZoom:o,zoomFactor:l}}function UC(t){if(t.enableRotation!==void 0?t.enableRotation:!0){const n=t.constrainRotation;return n===void 0||n===!0?zC():n===!1?gm:typeof n=="number"?jC(n):gm}return $f}function WC(t){return!(t.sourceCenter&&t.targetCenter&&!Nl(t.sourceCenter,t.targetCenter)||t.sourceResolution!==t.targetResolution||t.sourceRotation!==t.targetRotation)}function Cc(t,e,n,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=t[0]*s-t[1]*o,l=t[1]*s+t[0]*o;a+=(e[0]/2-n[0])*i,l+=(n[1]-e[1]/2)*i,o=-o;const u=a*s-l*o,c=l*s+a*o;return[u,c]}const Na="ol-hidden",ku="ol-unselectable",Gf="ol-control",pm="ol-collapsed",XC=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),mm=["style","variant","weight","size","lineHeight","family"],cd={normal:400,bold:700},hd=function(t){const e=t.match(XC);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=mm.length;i<r;++i){const s=e[i+1];s!==void 0&&(n[mm[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(n.weight))&&n.weight in cd&&(n.weight=cd[n.weight]),n.families=n.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),n};function Me(t,e,n,i){let r;return n&&n.length?r=n.shift():wt?r=new class extends OffscreenCanvas{constructor(){super(...arguments);Yu(this,"style",{})}}(t??300,e??150):r=document.createElement("canvas"),t&&(r.width=t),e&&(r.height=e),r.getContext("2d",i)}let Tc;function zl(){return Tc||(Tc=Me(1,1)),Tc}function Mu(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function _m(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function VC(t){for(;t.lastChild;)t.lastChild.remove()}function YC(t,e){const n=t.childNodes;for(let i=0;;++i){const r=n[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){t.appendChild(s);continue}if(!s){t.removeChild(r),--i;continue}t.insertBefore(s,r)}}}function cx(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const n=this.childNodes.indexOf(e);if(n===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(n,1),e},insertBefore:function(e,n){const i=this.childNodes.indexOf(n);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,n,i){return n==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,n,i)}})}function hi(t){return typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}class Uf extends xn{constructor(e){super();const n=e.element;n&&!e.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),this.element=n||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){var e;(e=this.element)==null||e.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){var n;this.map_&&((n=this.element)==null||n.remove());for(let i=0,r=this.listenerKeys.length;i<r;++i)ge(this.listenerKeys[i]);if(this.listenerKeys.length=0,this.map_=e,e){const i=this.target_??e.getOverlayContainerStopEvent();this.element&&i.appendChild(this.element),this.render!==jo&&this.listenerKeys.push(ee(e,ti.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class HC extends Uf{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const n=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:n+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:n+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(J.CLICK,this.handleClick_.bind(this),!1);const u=n+" "+ku+" "+Gf+(this.collapsed_&&this.collapsible_?" "+pm:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=u,c.appendChild(this.toggleButton_),c.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const n=this.getMap().getAllLayers(),i=new Set(n.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!n.some(s=>{var o;return((o=s.getSource())==null?void 0:o.getAttributionsCollapsible())===!1});this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=await Promise.all(this.collectSourceAttributions_(e).map(r=>dS(()=>r))),i=n.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Wn(n,this.renderedAttributions_)){VC(this.ulElement_);for(let r=0,s=n.length;r<s;++r){const o=document.createElement("li");o.innerHTML=n[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=n}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(pm),this.collapsed_?_m(this.collapseLabel_,this.label_):_m(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class KC extends Uf{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const n=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=n+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(J.CLICK,this.handleClick_.bind(this),!1);const a=n+" "+ku+" "+Gf,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Na)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const n=this.getMap().getView();if(!n)return;const i=n.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:Ls}):n.setRotation(0))}render(e){const n=e.frameState;if(!n)return;const i=n.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Na);!s&&i===0?this.element.classList.add(Na):s&&i!==0&&this.element.classList.remove(Na)}this.label_.style.transform=r}this.rotation_=i}}class ZC extends Uf{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const n=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:n+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:n+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",u=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=r,c.setAttribute("type","button"),c.title=l,c.appendChild(typeof o=="string"?document.createTextNode(o):o),c.addEventListener(J.CLICK,this.handleClick_.bind(this,i),!1);const h=document.createElement("button");h.className=s,h.setAttribute("type","button"),h.title=u,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(J.CLICK,this.handleClick_.bind(this,-i),!1);const d=n+" "+ku+" "+Gf,g=this.element;g.className=d,g.appendChild(c),g.appendChild(h),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,n){n.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Ls})):i.setZoom(s)}}}function qC(t){t=t||{};const e=new zt;return(t.zoom!==void 0?t.zoom:!0)&&e.push(new ZC(t.zoomOptions)),(t.rotate!==void 0?t.rotate:!0)&&e.push(new KC(t.rotateOptions)),(t.attribution!==void 0?t.attribution:!0)&&e.push(new HC(t.attributionOptions)),e}class JC{constructor(e,n,i){this.decay_=e,this.minVelocity_=n,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,n){this.points_.push(e,n,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,n=this.points_.length-3;if(this.points_[n+2]<e)return!1;let i=n-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[n+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[n]-this.points_[i],o=this.points_[n+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const ym={ACTIVE:"active"};class ra extends xn{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(ym.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(ym.ACTIVE,e)}setMap(e){this.map_=e}}function QC(t,e,n){const i=t.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];t.animateInternal({duration:n!==void 0?n:250,easing:FS,center:t.getConstrainedCenter(r)})}}function Wf(t,e,n,i){const r=t.getZoom();if(r===void 0)return;const s=t.getConstrainedZoom(r+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:i!==void 0?i:250,easing:Ls})}class eT extends ra{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let n=!1;if(e.type==we.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();Wf(a,o,s,this.duration_),i.preventDefault(),n=!0}return!n}}function dd(t){const e=arguments;return function(n){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](n),!!i);++r);return i}}const tT=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},nT=function(t){const e=t.map.getTargetElement(),n=e.getRootNode(),i=t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(i):e.contains(i)},hx=function(t){const e=t.map.getTargetElement(),n=e.getRootNode();return(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")?nT(t):!0},iT=bo,dx=function(t){const e=t.originalEvent;return"pointerId"in e&&e.button==0&&!(_S&&k0&&e.ctrlKey)},fx=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},rT=function(t){const e=t.originalEvent;return k0?e.metaKey:e.ctrlKey},sT=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},gx=function(t){const e=t.originalEvent,n=e.target.tagName;return n!=="INPUT"&&n!=="SELECT"&&n!=="TEXTAREA"&&!e.target.isContentEditable},Rc=function(t){const e=t.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},oT=function(t){const e=t.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class sa extends ra{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==we.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==we.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==we.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,n=this.stopDown(i)}else e.type==we.POINTERMOVE&&this.handleMoveEvent(e);return!n}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Xf(t){const e=t.length;let n=0,i=0;for(let r=0;r<e;r++)n+=t[r].clientX,i+=t[r].clientY;return{clientX:n/e,clientY:i/e}}class aT extends sa{constructor(e){super({stopDown:xu}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const n=e.condition?e.condition:dd(fx,oT);this.condition_=e.onFocusOnly?dd(hx,n):n,this.noKinetic_=!1}handleDragEvent(e){const n=e.map;this.panning_||(this.panning_=!0,n.getView().beginInteraction());const i=this.targetPointers,r=n.getEventPixel(Xf(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();MS(s,a.getResolution()),Tf(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const n=e.map,i=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=n.getPixelFromCoordinateInternal(o),l=n.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:Ls})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class lT extends sa{constructor(e){e=e||{},super({stopDown:xu}),this.condition_=e.condition?e.condition:tT,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!Rc(e))return;const n=e.map,i=n.getView();if(i.getConstraints().rotation===$f)return;const r=n.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return Rc(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return Rc(e)&&dx(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class uT extends ta{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,n=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],n[0])+i,r.top=Math.min(e[1],n[1])+i,r.width=Math.abs(n[0]-e[0])+i,r.height=Math.abs(n[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,n){this.startPixel_=e,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,n=this.endPixel_,r=[e,[e[0],n[1]],n,[n[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Go([r])}getGeometry(){return this.geometry_}}const xr={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ws extends Xn{constructor(e,n,i){super(e),this.coordinate=n,this.mapBrowserEvent=i}}class cT extends sa{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new uT(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??dx,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,n,i){const r=i[0]-n[0],s=i[1]-n[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ws(xr.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const n=this.boxEndCondition_(e,this.startPixel_,e.pixel);return n&&this.onBoxEnd(e),this.dispatchEvent(new Ws(n?xr.BOXEND:xr.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ws(xr.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ws(xr.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ws(xr.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class hT extends cT{constructor(e){e=e||{};const n=e.condition?e.condition:sT;super({condition:n,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:Ls})}}const Oi={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class dT extends ra{constructor(e){super(),e=e||{},this.defaultCondition_=function(n){return fx(n)&&gx(n)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let n=!1;if(e.type==J.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Oi.DOWN||r==Oi.LEFT||r==Oi.RIGHT||r==Oi.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,u=0;r==Oi.DOWN?u=-a:r==Oi.LEFT?l=-a:r==Oi.RIGHT?l=a:u=a;const c=[l,u];Tf(c,o.getRotation()),QC(o,c,this.duration_),i.preventDefault(),n=!0}}return!n}}class fT extends ra{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(n){return!rT(n)&&gx(n)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let n=!1;if(e.type==J.KEYDOWN||e.type==J.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();Wf(a,o,void 0,this.duration_),i.preventDefault(),n=!0}}return!n}}const gT=40,pT=300;class mT extends ra{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const n=e.condition?e.condition:iT;this.condition_=e.onFocusOnly?dd(hx,n):n,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==J.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=gT;break;case WheelEvent.DOM_DELTA_PAGE:s*=pT;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(e){const n=e.getView();n.getAnimating()&&n.cancelAnimations();let i=-_e(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Wf(n,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class _T extends sa{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=xu),super(n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let n=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==$f&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Xf(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(n,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}class yT extends sa{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=xu),super(n),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let n=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(n=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,u=l.getView();n!=1&&(this.lastScaleDelta_=n),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Xf(this.targetPointers))),l.render(),u.adjustResolutionInternal(n,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}function xT(t){t=t||{};const e=new zt,n=new JC(-.005,.05,100);return(t.altShiftDragRotate!==void 0?t.altShiftDragRotate:!0)&&e.push(new lT),(t.doubleClickZoom!==void 0?t.doubleClickZoom:!0)&&e.push(new eT({delta:t.zoomDelta,duration:t.zoomDuration})),(t.dragPan!==void 0?t.dragPan:!0)&&e.push(new aT({onFocusOnly:t.onFocusOnly,kinetic:n})),(t.pinchRotate!==void 0?t.pinchRotate:!0)&&e.push(new _T),(t.pinchZoom!==void 0?t.pinchZoom:!0)&&e.push(new yT({duration:t.zoomDuration})),(t.keyboard!==void 0?t.keyboard:!0)&&(e.push(new dT),e.push(new fT({delta:t.zoomDelta,duration:t.zoomDuration}))),(t.mouseWheelZoom!==void 0?t.mouseWheelZoom:!0)&&e.push(new mT({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(t.shiftDragZoom!==void 0?t.shiftDragZoom:!0)&&e.push(new hT({duration:t.zoomDuration})),e}const oe={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class px extends xn{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const n=Object.assign({},e);typeof e.properties=="object"&&(delete n.properties,Object.assign(n,e.properties)),n[oe.OPACITY]=e.opacity!==void 0?e.opacity:1,te(typeof n[oe.OPACITY]=="number","Layer opacity must be a number"),n[oe.VISIBLE]=e.visible!==void 0?e.visible:!0,n[oe.Z_INDEX]=e.zIndex,n[oe.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,n[oe.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,n[oe.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,n[oe.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=n.className!==void 0?n.className:"ol-layer",delete n.className,this.setProperties(n),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const n=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return n.opacity=_e(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=i===void 0&&!n.managed?1/0:i,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n}getLayersArray(e){return re()}getLayerStatesArray(e){return re()}getExtent(){return this.get(oe.EXTENT)}getMaxResolution(){return this.get(oe.MAX_RESOLUTION)}getMinResolution(){return this.get(oe.MIN_RESOLUTION)}getMinZoom(){return this.get(oe.MIN_ZOOM)}getMaxZoom(){return this.get(oe.MAX_ZOOM)}getOpacity(){return this.get(oe.OPACITY)}getSourceState(){return re()}getVisible(){return this.get(oe.VISIBLE)}getZIndex(){return this.get(oe.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(oe.EXTENT,e)}setMaxResolution(e){this.set(oe.MAX_RESOLUTION,e)}setMinResolution(e){this.set(oe.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(oe.MAX_ZOOM,e)}setMinZoom(e){this.set(oe.MIN_ZOOM,e)}setOpacity(e){te(typeof e=="number","Layer opacity must be a number"),this.set(oe.OPACITY,e)}setVisible(e){this.set(oe.VISIBLE,e)}setZIndex(e){this.set(oe.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const Hn={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class ri extends Xn{constructor(e,n){super(e),this.layer=n}}const Pc={LAYERS:"layers"};class As extends px{constructor(e){e=e||{};const n=Object.assign({},e);delete n.layers;let i=e.layers;super(n),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Pc.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new zt(i.slice(),{unique:!0}):te(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new zt(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(ge),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(ee(e,ct.ADD,this.handleLayersAdd_,this),ee(e,ct.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(ge);Is(this.listenerKeys_);const n=e.getArray();for(let i=0,r=n.length;i<r;i++){const s=n[i];this.registerLayerListeners_(s),this.dispatchEvent(new ri(Hn.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const n=[ee(e,fs.PROPERTYCHANGE,this.handleLayerChange_,this),ee(e,J.CHANGE,this.handleLayerChange_,this)];e instanceof As&&n.push(ee(e,Hn.ADDLAYER,this.handleLayerGroupAdd_,this),ee(e,Hn.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[X(e)]=n}handleLayerGroupAdd_(e){this.dispatchEvent(new ri(Hn.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new ri(Hn.REMOVELAYER,e.layer))}handleLayersAdd_(e){const n=e.element;this.registerLayerListeners_(n),this.dispatchEvent(new ri(Hn.ADDLAYER,n)),this.changed()}handleLayersRemove_(e){const n=e.element,i=X(n);this.listenerKeys_[i].forEach(ge),delete this.listenerKeys_[i],this.dispatchEvent(new ri(Hn.REMOVELAYER,n)),this.changed()}getLayers(){return this.get(Pc.LAYERS)}setLayers(e){const n=this.getLayers();if(n){const i=n.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new ri(Hn.REMOVELAYER,i[r]))}this.set(Pc.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(n){n.getLayersArray(e)}),e}getLayerStatesArray(e){const n=e!==void 0?e:[],i=n.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(n)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,a=n.length;o<a;o++){const l=n[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=qi(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return n}getSourceState(){return"ready"}}const Ge={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class Du extends px{constructor(e){const n=Object.assign({},e);delete n.source,super(n),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(oe.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(oe.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(ge(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=ee(e,J.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let n;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof fn?n={viewState:e.getState(),extent:e.calculateExtent()}:n=e,!n.layerStatesArray&&i&&(n.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(n.layerStatesArray){if(r=n.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return Vf(r,n.viewState)&&(!s||it(s,n.extent))}getAttributions(e){var s;if(!this.isVisible(e))return[];const n=(s=this.getSource())==null?void 0:s.getAttributions();if(!n)return[];const i=e instanceof fn?e.getViewStateAndExtent():e;let r=n(i);return Array.isArray(r)||(r=[r]),r}render(e,n){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,n)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,n){}renderDeferred(e){const n=this.getRenderer();n&&n.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(oe.MAP,e)}getMapInternal(){return this.get(oe.MAP)}setMap(e){this.mapPrecomposeKey_&&(ge(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(ge(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=ee(e,Ge.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=ee(this,J.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const n=e.frameState.layerStatesArray,i=this.getLayerState(!1);te(!n.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(i)}setSource(e){this.set(oe.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Vf(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const i=e.zoom;return i>t.minZoom&&i<=t.maxZoom}function mx(t,e,n=0,i=t.length-1,r=vT){for(;i>n;){if(i-n>600){const l=i-n+1,u=e-n+1,c=Math.log(l),h=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*h*(l-h)/l)*(u-l/2<0?-1:1),g=Math.max(n,Math.floor(e-u*h/l+d)),f=Math.min(i,Math.floor(e+(l-u)*h/l+d));mx(t,e,g,f,r)}const s=t[e];let o=n,a=i;for(Xs(t,n,e),r(t[i],s)>0&&Xs(t,n,i);o<a;){for(Xs(t,o,a),o++,a--;r(t[o],s)<0;)o++;for(;r(t[a],s)>0;)a--}r(t[n],s)===0?Xs(t,n,a):(a++,Xs(t,a,i)),a<=e&&(n=a+1),e<=a&&(i=a-1)}}function Xs(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function vT(t,e){return t<e?-1:t>e?1:0}let _x=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const i=[];if(!Oa(e,n))return i;const r=this.toBBox,s=[];for(;n;){for(let o=0;o<n.children.length;o++){const a=n.children[o],l=n.leaf?r(a):a;Oa(e,l)&&(n.leaf?i.push(a):Lc(e,l)?this._all(a,i):s.push(a))}n=s.pop()}return i}collides(e){let n=this.data;if(!Oa(e,n))return!1;const i=[];for(;n;){for(let r=0;r<n.children.length;r++){const s=n.children[r],o=n.leaf?this.toBBox(s):s;if(Oa(e,o)){if(n.leaf||Lc(e,o))return!0;i.push(s)}}n=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Lr([]),this}remove(e,n){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let a,l,u;for(;i||s.length;){if(i||(i=s.pop(),l=s[s.length-1],a=o.pop(),u=!0),i.leaf){const c=ET(e,i.children,n);if(c!==-1)return i.children.splice(c,1),s.push(i),this._condense(s),this}!u&&!i.leaf&&Lc(i,r)?(s.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],u=!1):i=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const i=[];for(;e;)e.leaf?n.push(...e.children):i.push(...e.children),e=i.pop();return n}_build(e,n,i,r){const s=i-n+1;let o=this._maxEntries,a;if(s<=o)return a=Lr(e.slice(n,i+1)),vr(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Lr([]),a.leaf=!1,a.height=r;const l=Math.ceil(s/o),u=l*Math.ceil(Math.sqrt(o));xm(e,n,i,u,this.compareMinX);for(let c=n;c<=i;c+=u){const h=Math.min(c+u-1,i);xm(e,c,h,l,this.compareMinY);for(let d=c;d<=h;d+=l){const g=Math.min(d+l-1,h);a.children.push(this._build(e,d,g,r-1))}}return vr(a,this.toBBox),a}_chooseSubtree(e,n,i,r){for(;r.push(n),!(n.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let l=0;l<n.children.length;l++){const u=n.children[l],c=Ic(u),h=CT(e,u)-c;h<o?(o=h,s=c<s?c:s,a=u):h===o&&c<s&&(s=c,a=u)}n=a||n.children[0]}return n}_insert(e,n,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,n,s);for(o.children.push(e),to(o,r);n>=0&&s[n].children.length>this._maxEntries;)this._split(s,n),n--;this._adjustParentBBoxes(r,s,n)}_split(e,n){const i=e[n],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=Lr(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,vr(i,this.toBBox),vr(a,this.toBBox),n?e[n-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,n){this.data=Lr([e,n]),this.data.height=e.height+1,this.data.leaf=!1,vr(this.data,this.toBBox)}_chooseSplitIndex(e,n,i){let r,s=1/0,o=1/0;for(let a=n;a<=i-n;a++){const l=eo(e,0,a,this.toBBox),u=eo(e,a,i,this.toBBox),c=TT(l,u),h=Ic(l)+Ic(u);c<s?(s=c,r=a,o=h<o?h:o):c===s&&h<o&&(o=h,r=a)}return r||i-n}_chooseSplitAxis(e,n,i){const r=e.leaf?this.compareMinX:wT,s=e.leaf?this.compareMinY:ST,o=this._allDistMargin(e,n,i,r),a=this._allDistMargin(e,n,i,s);o<a&&e.children.sort(r)}_allDistMargin(e,n,i,r){e.children.sort(r);const s=this.toBBox,o=eo(e,0,n,s),a=eo(e,i-n,i,s);let l=Fa(o)+Fa(a);for(let u=n;u<i-n;u++){const c=e.children[u];to(o,e.leaf?s(c):c),l+=Fa(o)}for(let u=i-n-1;u>=n;u--){const c=e.children[u];to(a,e.leaf?s(c):c),l+=Fa(a)}return l}_adjustParentBBoxes(e,n,i){for(let r=i;r>=0;r--)to(n[r],e)}_condense(e){for(let n=e.length-1,i;n>=0;n--)e[n].children.length===0?n>0?(i=e[n-1].children,i.splice(i.indexOf(e[n]),1)):this.clear():vr(e[n],this.toBBox)}};function ET(t,e,n){if(!n)return e.indexOf(t);for(let i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function vr(t,e){eo(t,0,t.children.length,e,t)}function eo(t,e,n,i,r){r||(r=Lr(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<n;s++){const o=t.children[s];to(r,t.leaf?i(o):o)}return r}function to(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function wT(t,e){return t.minX-e.minX}function ST(t,e){return t.minY-e.minY}function Ic(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Fa(t){return t.maxX-t.minX+(t.maxY-t.minY)}function CT(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function TT(t,e){const n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,s-i)}function Lc(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Oa(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Lr(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function xm(t,e,n,i,r){const s=[e,n];for(;s.length;){if(n=s.pop(),e=s.pop(),n-e<=i)continue;const o=e+Math.ceil((n-e)/i/2)*i;mx(t,o,e,n,r),s.push(e,o,o,n)}}const Yf=[NaN,NaN,NaN,0];let Ac;function RT(){return Ac||(Ac=Me(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Ac}const PT=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,IT=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,LT=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,AT=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function ba(t,e){return t.endsWith("%")?Number(t.substring(0,t.length-1))/e:Number(t)}function mo(t){throw new Error('failed to parse "'+t+'" as color')}function yx(t){if(t.toLowerCase().startsWith("rgb")){const s=t.match(IT)||t.match(PT)||t.match(LT);if(s){const o=s[4],a=100/255;return[_e(ba(s[1],a)+.5|0,0,255),_e(ba(s[2],a)+.5|0,0,255),_e(ba(s[3],a)+.5|0,0,255),o!==void 0?_e(ba(o,100),0,1):1]}mo(t)}if(t.startsWith("#")){if(AT.test(t)){const s=t.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,u=s.length;l<u;l+=o){let c=parseInt(s.substring(l,l+o),16);o===1&&(c+=c<<4),a[l/o]=c}return a[3]=a[3]/255,a}mo(t)}const e=RT();e.fillStyle="#abcdef";let n=e.fillStyle;e.fillStyle=t,e.fillStyle===n&&(e.fillStyle="#fedcba",n=e.fillStyle,e.fillStyle=t,e.fillStyle===n&&mo(t));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return yx(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=Eu(r[3]/255,3),r}function kT(t){return typeof t=="string"?t:Kf(t)}const MT=1024,Vs={};let kc=0;function DT(t){if(t.length===4)return t;const e=t.slice();return e[3]=1,e}function Mc(t){return t>.0031308?Math.pow(t,1/2.4)*269.025-14.025:t*3294.6}function Dc(t){return t>.2068965?Math.pow(t,3):(t-4/29)*(108/841)}function Nc(t){return t>10.314724?Math.pow((t+14.025)/269.025,2.4):t/3294.6}function Fc(t){return t>.0088564?Math.pow(t,1/3):t/(108/841)+4/29}function vm(t){const e=Nc(t[0]),n=Nc(t[1]),i=Nc(t[2]),r=Fc(e*.222488403+n*.716873169+i*.06060791),s=500*(Fc(e*.452247074+n*.399439023+i*.148375274)-r),o=200*(r-Fc(e*.016863605+n*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,t[3]]}function NT(t){const e=(t[0]+16)/116,n=t[1],i=t[2]*Math.PI/180,r=Dc(e),s=Dc(e+n/500*Math.cos(i)),o=Dc(e-n/200*Math.sin(i)),a=Mc(s*3.021973625-r*1.617392459-o*.404875592),l=Mc(s*-.943766287+r*1.916279586+o*.027607165),u=Mc(s*.069407491-r*.22898585+o*1.159737864);return[_e(a+.5|0,0,255),_e(l+.5|0,0,255),_e(u+.5|0,0,255),t[3]]}function Hf(t){if(t==="none")return Yf;if(Vs.hasOwnProperty(t))return Vs[t];if(kc>=MT){let n=0;for(const i in Vs)n++&3||(delete Vs[i],--kc)}const e=yx(t);e.length!==4&&mo(t);for(const n of e)isNaN(n)&&mo(t);return Vs[t]=e,++kc,e}function nn(t){return Array.isArray(t)?t:Hf(t)}function Kf(t){let e=t[0];e!=(e|0)&&(e=e+.5|0);let n=t[1];n!=(n|0)&&(n=n+.5|0);let i=t[2];i!=(i|0)&&(i=i+.5|0);const r=t[3]===void 0?1:Math.round(t[3]*1e3)/1e3;return"rgba("+e+","+n+","+i+","+r+")"}function Em(t){return t[0]>0&&t[1]>0}function FT(t,e,n){return n===void 0&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function st(t,e){return Array.isArray(t)?t:(e===void 0?e=[t,t]:(e[0]=t,e[1]=t),e)}let dr=0;const Ae=1<<dr++,z=1<<dr++,Fe=1<<dr++,me=1<<dr++,yt=1<<dr++,$t=1<<dr++,ja=Math.pow(2,dr)-1,Zf={[Ae]:"boolean",[z]:"number",[Fe]:"string",[me]:"color",[yt]:"number[]",[$t]:"size"},OT=Object.keys(Zf).map(Number).sort(Fn);function bT(t){return t in Zf}function Vr(t){const e=[];for(const n of OT)no(t,n)&&e.push(Zf[n]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function no(t,e){return(t&e)===e}function hn(t,e){return t===e}class De{constructor(e,n){if(!bT(e))throw new Error(`literal expressions must have a specific type, got ${Vr(e)}`);this.type=e,this.value=n}}class xx{constructor(e,n,...i){this.type=e,this.operator=n,this.args=i}}function qf(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ue(t,e,n){switch(typeof t){case"boolean":{if(hn(e,Fe))return new De(Fe,t?"true":"false");if(!no(e,Ae))throw new Error(`got a boolean, but expected ${Vr(e)}`);return new De(Ae,t)}case"number":{if(hn(e,$t))return new De($t,st(t));if(hn(e,Ae))return new De(Ae,!!t);if(hn(e,Fe))return new De(Fe,t.toString());if(!no(e,z))throw new Error(`got a number, but expected ${Vr(e)}`);return new De(z,t)}case"string":{if(hn(e,me))return new De(me,Hf(t));if(hn(e,Ae))return new De(Ae,!!t);if(!no(e,Fe))throw new Error(`got a string, but expected ${Vr(e)}`);return new De(Fe,t)}}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(t.length===0)throw new Error("empty expression");if(typeof t[0]=="string")return HT(t,e,n);for(const i of t)if(typeof i!="number")throw new Error("expected an array of numbers");if(hn(e,$t)){if(t.length!==2)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new De($t,t)}if(hn(e,me)){if(t.length===3)return new De(me,[...t,1]);if(t.length===4)return new De(me,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!no(e,yt))throw new Error(`got an array of numbers, but expected ${Vr(e)}`);return new De(yt,t)}const S={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},jT={[S.Get]:V(Z(1,1/0),wm),[S.Var]:V(Z(1,1),zT),[S.Has]:V(Z(1,1/0),wm),[S.Id]:V($T,Er),[S.Concat]:V(Z(2,1/0),se(Fe)),[S.GeometryType]:V(BT,Er),[S.LineMetric]:V(Er),[S.Resolution]:V(Oc,Er),[S.Zoom]:V(Oc,Er),[S.Time]:V(Oc,Er),[S.Any]:V(Z(2,1/0),se(Ae)),[S.All]:V(Z(2,1/0),se(Ae)),[S.Not]:V(Z(1,1),se(Ae)),[S.Equal]:V(Z(2,2),se(ja)),[S.NotEqual]:V(Z(2,2),se(ja)),[S.GreaterThan]:V(Z(2,2),se(z)),[S.GreaterThanOrEqualTo]:V(Z(2,2),se(z)),[S.LessThan]:V(Z(2,2),se(z)),[S.LessThanOrEqualTo]:V(Z(2,2),se(z)),[S.Multiply]:V(Z(2,1/0),Sm),[S.Coalesce]:V(Z(2,1/0),Sm),[S.Divide]:V(Z(2,2),se(z)),[S.Add]:V(Z(2,1/0),se(z)),[S.Subtract]:V(Z(2,2),se(z)),[S.Clamp]:V(Z(3,3),se(z)),[S.Mod]:V(Z(2,2),se(z)),[S.Pow]:V(Z(2,2),se(z)),[S.Abs]:V(Z(1,1),se(z)),[S.Floor]:V(Z(1,1),se(z)),[S.Ceil]:V(Z(1,1),se(z)),[S.Round]:V(Z(1,1),se(z)),[S.Sin]:V(Z(1,1),se(z)),[S.Cos]:V(Z(1,1),se(z)),[S.Atan]:V(Z(1,2),se(z)),[S.Sqrt]:V(Z(1,1),se(z)),[S.Match]:V(Z(4,1/0),Cm,UT),[S.Between]:V(Z(3,3),se(z)),[S.Interpolate]:V(Z(6,1/0),Cm,WT),[S.Case]:V(Z(3,1/0),GT,XT),[S.In]:V(Z(2,2),VT),[S.Number]:V(Z(1,1/0),se(ja)),[S.String]:V(Z(1,1/0),se(ja)),[S.Array]:V(Z(1,1/0),se(z)),[S.Color]:V(Z(1,4),se(z)),[S.Band]:V(Z(1,3),se(z)),[S.Palette]:V(Z(2,2),YT),[S.ToString]:V(Z(1,1),se(Ae|z|Fe|me))};function wm(t,e,n){const i=t.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=t[s+1];switch(typeof o){case"number":{r[s]=new De(z,o);break}case"string":{r[s]=new De(Fe,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&n.properties.add(String(o))}return r}function zT(t,e,n){const i=t[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return n.variables.add(i),[new De(Fe,i)]}function $T(t,e,n){n.featureId=!0}function BT(t,e,n){n.geometryType=!0}function Oc(t,e,n){n.mapState=!0}function Er(t,e,n){const i=t[0];if(t.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Z(t,e){return function(n,i,r){const s=n[0],o=n.length-1;if(t===e){if(o!==t){const a=t===1?"":"s";throw new Error(`expected ${t} argument${a} for ${s}, got ${o}`)}}else if(o<t||o>e){const a=e===1/0?`${t} or more`:`${t} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function Sm(t,e,n){const i=t.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Ue(t[s+1],e,n);r[s]=o}return r}function se(t){return function(e,n,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=Ue(e[o+1],t,i);s[o]=a}return s}}function GT(t,e,n){const i=t[0],r=t.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function Cm(t,e,n){const i=t[0],r=t.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function UT(t,e,n){const i=t.length-1,r=Fe|z|Ae,s=Ue(t[1],r,n),o=Ue(t[t.length-1],e,n),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const u=Ue(t[l+2],s.type,n);a[l]=u}catch(u){throw new Error(`failed to parse argument ${l+1} of match expression: ${u.message}`)}try{const u=Ue(t[l+3],o.type,n);a[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+2} of match expression: ${u.message}`)}}return[s,...a,o]}function WT(t,e,n){const i=t[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);r=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new De(z,r);let o;try{o=Ue(t[2],z,n)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(t.length-3);for(let l=0;l<a.length;l+=2){try{const u=Ue(t[l+3],z,n);a[l]=u}catch(u){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${u.message}`)}try{const u=Ue(t[l+4],e,n);a[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${u.message}`)}}return[s,o,...a]}function XT(t,e,n){const i=Ue(t[t.length-1],e,n),r=new Array(t.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Ue(t[s+1],Ae,n);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Ue(t[s+2],i.type,n);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function VT(t,e,n){let i=t[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Fe}else r=z;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const l=Ue(i[a],r,n);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[Ue(t[1],r,n),...s]}function YT(t,e,n){let i;try{i=Ue(t[1],z,n)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=t[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=Ue(r[o],me,n)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof De))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function V(...t){return function(e,n,i){const r=e[0];let s;for(let o=0;o<t.length;o++){const a=t[o](e,n,i);if(o==t.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new xx(n,r,...s)}}function HT(t,e,n){const i=t[0],r=jT[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(t,e,n)}function Jf(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Jf(t.getGeometries()[0]);default:return""}}function vx(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Vn(t,e,n){const i=Ue(t,e,n);return rn(i)}function rn(t,e){if(t instanceof De){if(t.type===me&&typeof t.value=="string"){const i=Hf(t.value);return function(){return i}}return function(){return t.value}}const n=t.operator;switch(n){case S.Number:case S.String:case S.Coalesce:return KT(t);case S.Get:case S.Var:case S.Has:return ZT(t);case S.Id:return i=>i.featureId;case S.GeometryType:return i=>i.geometryType;case S.Concat:{const i=t.args.map(r=>rn(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case S.Resolution:return i=>i.resolution;case S.Any:case S.All:case S.Between:case S.In:case S.Not:return JT(t);case S.Equal:case S.NotEqual:case S.LessThan:case S.LessThanOrEqualTo:case S.GreaterThan:case S.GreaterThanOrEqualTo:return qT(t);case S.Multiply:case S.Divide:case S.Add:case S.Subtract:case S.Clamp:case S.Mod:case S.Pow:case S.Abs:case S.Floor:case S.Ceil:case S.Round:case S.Sin:case S.Cos:case S.Atan:case S.Sqrt:return QT(t);case S.Case:return eR(t);case S.Match:return tR(t);case S.Interpolate:return nR(t);case S.ToString:return iR(t);default:throw new Error(`Unsupported operator ${n}`)}}function KT(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=rn(t.args[s]);switch(n){case S.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case S.Number:case S.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===n)return a}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}function ZT(t,e){const i=t.args[0].value;switch(t.operator){case S.Get:return r=>{const s=t.args;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const c=s[a].value;o=o[c]}return o};case S.Var:return r=>r.variables[i];case S.Has:return r=>{const s=t.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const c=s[a].value;if(!o||!Object.hasOwn(o,c))return!1;o=o[c]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}function qT(t,e){const n=t.operator,i=rn(t.args[0]),r=rn(t.args[1]);switch(n){case S.Equal:return s=>i(s)===r(s);case S.NotEqual:return s=>i(s)!==r(s);case S.LessThan:return s=>i(s)<r(s);case S.LessThanOrEqualTo:return s=>i(s)<=r(s);case S.GreaterThan:return s=>i(s)>r(s);case S.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${n}`)}}function JT(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=rn(t.args[s]);switch(n){case S.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case S.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case S.Between:return s=>{const o=r[0](s),a=r[1](s),l=r[2](s);return o>=a&&o<=l};case S.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case S.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${n}`)}}function QT(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=rn(t.args[s]);switch(n){case S.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case S.Divide:return s=>r[0](s)/r[1](s);case S.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case S.Subtract:return s=>r[0](s)-r[1](s);case S.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const l=r[2](s);return o>l?l:o};case S.Mod:return s=>r[0](s)%r[1](s);case S.Pow:return s=>Math.pow(r[0](s),r[1](s));case S.Abs:return s=>Math.abs(r[0](s));case S.Floor:return s=>Math.floor(r[0](s));case S.Ceil:return s=>Math.ceil(r[0](s));case S.Round:return s=>Math.round(r[0](s));case S.Sin:return s=>Math.sin(r[0](s));case S.Cos:return s=>Math.cos(r[0](s));case S.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case S.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${n}`)}}function eR(t,e){const n=t.args.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=rn(t.args[r]);return r=>{for(let s=0;s<n-1;s+=2)if(i[s](r))return i[s+1](r);return i[n-1](r)}}function tR(t,e){const n=t.args.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=rn(t.args[r]);return r=>{const s=i[0](r);for(let o=1;o<n-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[n-1](r)}}function nR(t,e){const n=t.args.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=rn(t.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,l;for(let u=2;u<n;u+=2){const c=i[u](r);let h=i[u+1](r);const d=Array.isArray(h);if(d&&(h=DT(h)),c>=o)return u===2?h:d?rR(s,o,a,l,c,h):io(s,o,a,l,c,h);a=c,l=h}return l}}function iR(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=rn(t.args[s]);switch(n){case S.ToString:return s=>{const o=r[0](s);return t.args[0].type===me?Kf(o):o.toString()};default:throw new Error(`Unsupported convert operator ${n}`)}}function io(t,e,n,i,r,s){const o=r-n;if(o===0)return i;const a=e-n,l=t===1?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1);return i+l*(s-i)}function rR(t,e,n,i,r,s){if(r-n===0)return i;const a=vm(i),l=vm(s);let u=l[2]-a[2];u>180?u-=360:u<-180&&(u+=360);const c=[io(t,e,n,a[0],r,l[0]),io(t,e,n,a[1],r,l[1]),a[2]+io(t,e,n,0,r,u),io(t,e,n,i[3],r,s[3])];return NT(c)}const q={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function sR(t,e,n){const i=t;let r=!0,s=!1,o=!1;const a=[Ml(i,J.LOAD,function(){o=!0,s||e()})];return i.src&&M0?(s=!0,i.decode().then(function(){r&&e()}).catch(function(l){r&&(o?e():n())})):a.push(Ml(i,J.ERROR,n)),function(){r=!1,a.forEach(ge)}}function oR(t,e){return new Promise((n,i)=>{function r(){o(),n(t)}function s(){o(),i(new Error("Image load error"))}function o(){t.removeEventListener("load",r),t.removeEventListener("error",s)}t.addEventListener("load",r),t.addEventListener("error",s)})}function aR(t,e){return e&&(t.src=e),t.src&&M0?new Promise((n,i)=>t.decode().then(()=>n(t)).catch(r=>t.complete&&t.width?n(t):i(r))):oR(t)}class lR{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const n in this.cache_){const i=this.cache_[n];!(e++&3)&&!i.hasListener()&&(delete this.cache_[n],delete this.patternCache_[n],--this.cacheSize_)}}}get(e,n,i){const r=bc(e,n,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,n,i){const r=bc(e,n,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,n,i,r,s){const o=bc(e,n,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===q.IDLE&&r.load(),r.getImageState()===q.LOADING?r.ready().then(()=>{this.patternCache_[o]=zl().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=zl().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function bc(t,e,n){const i=n?nn(n):"null";return e+":"+t+":"+i}const Bt=new lR;let Ys=null;class Ex extends vu{constructor(e,n,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?q.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=n,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===q.LOADED){Ys||(Ys=Me(1,1,void 0,{willReadFrequently:!0})),Ys.drawImage(this.image_,0,0);try{Ys.getImageData(0,0,1,1),this.tainted_=!1}catch{Ys=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(J.CHANGE)}handleImageError_(){this.imageState_=q.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=q.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],n=this.size_[1],i=Me(e,n);i.fillRect(0,0,e,n),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===q.IDLE){this.image_||this.initializeImage_(),this.imageState_=q.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&aR(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==q.LOADED)return;const n=this.image_,i=Me(Math.ceil(n.width*e),Math.ceil(n.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(n,0,0),i.globalCompositeOperation="multiply",i.fillStyle=kT(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(n,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===q.LOADED||this.imageState_===q.ERROR)e();else{const n=()=>{(this.imageState_===q.LOADED||this.imageState_===q.ERROR)&&(this.removeEventListener(J.CHANGE,n),e())};this.addEventListener(J.CHANGE,n)}})),this.ready_}}function $l(t,e,n,i,r,s){let o=e===void 0?void 0:Bt.get(e,n,r);return o||(o=new Ex(t,t&&"src"in t?t.src||void 0:e,n,i,r),Bt.set(e,n,r,o,s)),s&&o&&!Bt.getPattern(e,n,r)&&Bt.set(e,n,r,o,s),o}function pn(t){return t?Array.isArray(t)?Kf(t):typeof t=="object"&&"src"in t?uR(t):t:null}function uR(t){if(!t.offset||!t.size)return Bt.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,n=Bt.getPattern(e,void 0,t.color);if(n)return n;const i=Bt.get(t.src,"anonymous",null);if(i.getImageState()!==q.LOADED)return null;const r=Me(t.size[0],t.size[1]);return r.drawImage(i.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),$l(r.canvas,e,void 0,q.LOADED,t.color,!0),Bt.getPattern(e,void 0,t.color)}const wx="10px sans-serif",ht="#000",ys="round",On=[],bn=0,xs="round",Uo=10,Wo="#000",Xo="center",Bl="middle",Yi=[0,0,0,0],Vo=1,Ar=new xn;let Hs=null,Tm;const fd={},cR=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function hR(t,e,n){return`${t} ${e} 16px "${n}"`}const dR=function(){let e,n;async function i(s){await n.ready;const o=await n.load(s);if(o.length===0)return!1;const a=hd(s),l=a.families[0].toLowerCase(),u=a.weight;return o.some(c=>{const h=c.family.replace(/^['"]|['"]$/g,"").toLowerCase(),d=cd[c.weight]||c.weight;return h===l&&c.style===a.style&&d==u})}async function r(){await n.ready;let s=!0;const o=Ar.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const u=a[l];let c=o[u];c<100&&(await i(u)?(Is(fd),Ar.set(u,100)):(c+=10,Ar.set(u,c,!0),c<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){n||(n=wt?self.fonts:document.fonts);const o=hd(s);if(!o)return;const a=o.families;let l=!1;for(const u of a){if(cR.has(u))continue;const c=hR(o.style,o.weight,u);Ar.get(c)===void 0&&(Ar.set(c,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(r,100))}}(),fR=function(){let t;return function(e){let n=fd[e];if(n==null){if(wt){const i=hd(e),r=Sx(e,"g");n=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);fd[e]=n}return n}}();function Sx(t,e){return Hs||(Hs=Me(1,1)),t!=Tm&&(Hs.font=t,Tm=Hs.font),Hs.measureText(e)}function Cx(t,e){return Sx(t,e).width}function Rm(t,e,n){if(e in n)return n[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Cx(t,s)),0);return n[e]=i,i}function gR(t,e){const n=[],i=[],r=[];let s=0,o=0,a=0,l=0;for(let u=0,c=e.length;u<=c;u+=2){const h=e[u];if(h===`
`||u===c){s=Math.max(s,o),r.push(o),o=0,a+=l,l=0;continue}const d=e[u+1]||t.font,g=Cx(d,h);n.push(g),o+=g;const f=fR(d);i.push(f),l=Math.max(l,f)}return{width:s,height:a,widths:n,heights:i,lineWidths:r}}function pR(t,e,n,i,r,s,o,a,l,u,c){t.save(),n!==1&&(t.globalAlpha===void 0?t.globalAlpha=h=>h.globalAlpha*=n:t.globalAlpha*=n),e&&t.transform.apply(t,e),i.contextInstructions?(t.translate(l,u),t.scale(c[0],c[1]),mR(i,t)):c[0]<0||c[1]<0?(t.translate(l,u),t.scale(c[0],c[1]),t.drawImage(i,r,s,o,a,0,0,o,a)):t.drawImage(i,r,s,o,a,l,u,o*c[0],a*c[1]),t.restore()}function mR(t,e){const n=t.contextInstructions;for(let i=0,r=n.length;i<r;i+=2)Array.isArray(n[i+1])?e[n[i]].apply(e,n[i+1]):e[n[i]]=n[i+1]}class Nu{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=st(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Nu({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return re()}getImage(e){return re()}getHitDetectionImage(){return re()}getPixelRatio(e){return 1}getImageState(){return re()}getImageSize(){return re()}getOrigin(){return re()}getSize(){return re()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=st(e)}listenImageChange(e){re()}load(){re()}unlistenImageChange(e){re()}ready(){return Promise.resolve()}}class Fu extends Nu{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?q.LOADING:q.LOADED,this.imageState_===q.LOADING&&this.ready().then(()=>this.imageState_=q.LOADED),this.render()}clone(){const e=this.getScale(),n=new Fu({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}getAnchor(){const e=this.size_,n=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-n[0]/i[0],e[1]/2+n[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){var s,o;const n=(s=this.fill_)==null?void 0:s.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${n}`+Object.values(this.renderOptions_).join(",");let r=(o=Bt.get(i,null,null))==null?void 0:o.getImage(1);if(!r){const a=this.renderOptions_,l=Math.ceil(a.size*e),u=Me(l,l);this.draw_(a,u,e),r=u.canvas,Bt.set(i,null,null,new Ex(r,void 0,null,q.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,n,i){if(n===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return n;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const C=r;r=s,s=C}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),u=Math.sqrt(s*s-l*l),c=r-u,h=Math.sqrt(l*l+c*c),d=h/l;if(e==="miter"&&d<=i)return d*n;const g=n/2/d,f=n/2*(c/h),x=Math.sqrt((r+g)*(r+g)+f*f)-r;if(this.radius2_===void 0||e==="bevel")return x*2;const m=r*Math.sin(a),p=Math.sqrt(r*r-m*m),y=s-p,w=Math.sqrt(m*m+y*y)/m;if(w<=i){const C=w*n/2-s-r;return 2*Math.max(x,C)}return x*2}createRenderOptions(){let e=ys,n=xs,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=pn(this.stroke_.getColor()??Wo),a=this.stroke_.getWidth()??Vo,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??xs,e=this.stroke_.getLineCap()??ys,i=this.stroke_.getMiterLimit()??Uo);const l=this.calculateLineJoinSize_(n,a,i),u=Math.max(this.radius,this.radius2_||0),c=Math.ceil(2*u+l);return{strokeStyle:o,strokeWidth:a,size:c,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:n,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,n,i){if(n.scale(i,i),n.translate(e.size/2,e.size/2),this.createPath_(n),this.fill_){let r=this.fill_.getColor();r===null&&(r=ht),n.fillStyle=pn(r),n.fill()}e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineCap=e.lineCap,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}createHitDetectionCanvas_(e){let n;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=nn(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(n=Me(e.size,e.size),this.drawHitDetectionCanvas_(e,n))}return n?n.canvas:this.getImage(1)}createPath_(e){let n=this.points_;const i=this.radius;if(n===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(n*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/n;for(let a=0;a<n;a++){const l=s+a*o,u=a%2===0?i:r;e.lineTo(u*Math.cos(l),u*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,n){n.translate(e.size/2,e.size/2),this.createPath_(n),n.fillStyle=ht,n.fill(),e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class vs extends Fu{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),n=new vs({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}setRadius(e){this.radius=e,this.render()}}class Ri{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Ri({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const n=$l(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));n.ready().then(()=>{this.patternImage_=null}),n.getImageState()===q.IDLE&&n.load(),n.getImageState()===q.LOADING&&(this.patternImage_=n)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?X(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:nn(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function Pm(t,e,n,i){return n!==void 0&&i!==void 0?[n/t,i/e]:n!==void 0?n/t:i!==void 0?i/e:1}class Ou extends Nu{constructor(e){e=e||{};const n=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:n,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;te(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||X(o)),te(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),te(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=q.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?q.LOADED:q.IDLE:l=q.LOADING:l=q.LOADED),this.color_=e.color!==void 0?nn(e.color):null,this.iconImage_=$l(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let u,c;if(e.size)[u,c]=e.size;else{const h=this.getImage(1);if(h.width&&h.height)u=h.width,c=h.height;else if(h instanceof HTMLImageElement){this.initialOptions_=e;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const g=this.iconImage_.getSize();this.setScale(Pm(g[0],g[1],e.width,e.height))};this.listenImageChange(d);return}}u!==void 0&&this.setScale(Pm(u,c,e.width,e.height))}}clone(){let e,n,i;return this.initialOptions_?(n=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Ou({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:n,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const n=this.getDisplacement(),i=this.getScaleArray();return[e[0]-n[0]/i[0],e[1]+n[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const n=this.getSize(),i=this.iconImage_.getSize();if(!n||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-n[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-n[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=$l(null,e,this.crossOrigin_,q.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==q.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==q.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(J.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(J.CHANGE,e)}ready(){return this.iconImage_.ready()}}class Es{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Es({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}class Ji{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=Im,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Ji({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(n){return n.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=Im,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function _R(t){let e;if(typeof t=="function")e=t;else{let n;Array.isArray(t)?n=t:(te(typeof t.getZIndex=="function","Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}let jc=null;function Tx(t,e){if(!jc){const n=new Ri({color:"rgba(255,255,255,0.4)"}),i=new Es({color:"#3399CC",width:1.25});jc=[new Ji({image:new vs({fill:n,stroke:i,radius:5}),fill:n,stroke:i})]}return jc}function Im(t){return t.getGeometry()}const yR="#333";class Qf{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=st(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Ri({color:yR}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Qf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Ri?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=st(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}function xR(t){return!0}function vR(t){const e=qf(),n=ER(t,e),i=vx();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=Jf(r.getGeometry())),n(i)}}function Lm(t){const e=qf(),n=t.length,i=new Array(n);for(let o=0;o<n;++o)i[o]=gd(t[o],e);const r=vx(),s=new Array(n);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,e.featureId){const u=o.getId();u!==void 0?r.featureId=u:r.featureId=null}let l=0;for(let u=0;u<n;++u){const c=i[u](r);c&&(s[l]=c,l+=1)}return s.length=l,s}}function ER(t,e){const n=t.length,i=new Array(n);for(let r=0;r<n;++r){const s=t[r],o="filter"in s?Vn(s.filter,Ae,e):xR;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let u=0;u<l;++u)a[u]=gd(s.style[u],e)}else a=[gd(s.style,e)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<n;++a){const l=i[a].filter;if(l(r)&&!(t[a].else&&o)){o=!0;for(const u of i[a].styles){const c=u(r);c&&s.push(c)}}}return s}}function gd(t,e){const n=Yo(t,"",e),i=Ho(t,"",e),r=wR(t,e),s=SR(t,e),o=dt(t,"z-index",e);if(!n&&!i&&!r&&!s&&!gs(t))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new Ji;return function(l){let u=!0;if(n){const c=n(l);c&&(u=!1),a.setFill(c)}if(i){const c=i(l);c&&(u=!1),a.setStroke(c)}if(r){const c=r(l);c&&(u=!1),a.setText(c)}if(s){const c=s(l);c&&(u=!1),a.setImage(c)}return o&&a.setZIndex(o(l)),u?null:a}}function Yo(t,e,n){let i;if(e+"fill-pattern-src"in t)i=PR(t,e+"fill-",n);else{if(t[e+"fill-color"]==="none")return s=>null;i=eg(t,e+"fill-color",n)}if(!i)return null;const r=new Ri;return function(s){const o=i(s);return o===Yf?null:(r.setColor(o),r)}}function Ho(t,e,n){const i=dt(t,e+"stroke-width",n),r=eg(t,e+"stroke-color",n);if(!i&&!r)return null;const s=An(t,e+"stroke-line-cap",n),o=An(t,e+"stroke-line-join",n),a=Rx(t,e+"stroke-line-dash",n),l=dt(t,e+"stroke-line-dash-offset",n),u=dt(t,e+"stroke-miter-limit",n),c=new Es;return function(h){if(r){const d=r(h);if(d===Yf)return null;c.setColor(d)}if(i&&c.setWidth(i(h)),s){const d=s(h);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");c.setLineCap(d)}if(o){const d=o(h);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(d)}return a&&c.setLineDash(a(h)),l&&c.setLineDashOffset(l(h)),u&&c.setMiterLimit(u(h)),c}}function wR(t,e){const n="text-",i=An(t,n+"value",e);if(!i)return null;const r=Yo(t,n,e),s=Yo(t,n+"background-",e),o=Ho(t,n,e),a=Ho(t,n+"background-",e),l=An(t,n+"font",e),u=dt(t,n+"max-angle",e),c=dt(t,n+"offset-x",e),h=dt(t,n+"offset-y",e),d=rs(t,n+"overflow",e),g=An(t,n+"placement",e),f=dt(t,n+"repeat",e),_=bu(t,n+"scale",e),x=rs(t,n+"rotate-with-view",e),m=dt(t,n+"rotation",e),p=An(t,n+"align",e),y=An(t,n+"justify",e),v=An(t,n+"baseline",e),w=rs(t,n+"keep-upright",e),C=Rx(t,n+"padding",e),R=ju(t,n+"declutter-mode"),T=new Qf({declutterMode:R});return function(I){if(T.setText(i(I)),r&&T.setFill(r(I)),s&&T.setBackgroundFill(s(I)),o&&T.setStroke(o(I)),a&&T.setBackgroundStroke(a(I)),l&&T.setFont(l(I)),u&&T.setMaxAngle(u(I)),c&&T.setOffsetX(c(I)),h&&T.setOffsetY(h(I)),d&&T.setOverflow(d(I)),g){const A=g(I);if(A!=="point"&&A!=="line")throw new Error("Expected point or line for text-placement");T.setPlacement(A)}if(f&&T.setRepeat(f(I)),_&&T.setScale(_(I)),x&&T.setRotateWithView(x(I)),m&&T.setRotation(m(I)),p){const A=p(I);if(A!=="left"&&A!=="center"&&A!=="right"&&A!=="end"&&A!=="start")throw new Error("Expected left, right, center, start, or end for text-align");T.setTextAlign(A)}if(y){const A=y(I);if(A!=="left"&&A!=="right"&&A!=="center")throw new Error("Expected left, right, or center for text-justify");T.setJustify(A)}if(v){const A=v(I);if(A!=="bottom"&&A!=="top"&&A!=="middle"&&A!=="alphabetic"&&A!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");T.setTextBaseline(A)}return C&&T.setPadding(C(I)),w&&T.setKeepUpright(w(I)),T}}function SR(t,e){return"icon-src"in t?CR(t,e):"shape-points"in t?TR(t,e):"circle-radius"in t?RR(t,e):null}function CR(t,e){const n="icon-",i=n+"src",r=Px(t[i],i),s=Gl(t,n+"anchor",e),o=bu(t,n+"scale",e),a=dt(t,n+"opacity",e),l=Gl(t,n+"displacement",e),u=dt(t,n+"rotation",e),c=rs(t,n+"rotate-with-view",e),h=km(t,n+"anchor-origin"),d=Mm(t,n+"anchor-x-units"),g=Mm(t,n+"anchor-y-units"),f=kR(t,n+"color"),_=LR(t,n+"cross-origin"),x=AR(t,n+"offset"),m=km(t,n+"offset-origin"),p=Ul(t,n+"width"),y=Ul(t,n+"height"),v=IR(t,n+"size"),w=ju(t,n+"declutter-mode"),C=new Ou({src:r,anchorOrigin:h,anchorXUnits:d,anchorYUnits:g,color:f,crossOrigin:_,offset:x,offsetOrigin:m,height:y,width:p,size:v,declutterMode:w});return function(R){return a&&C.setOpacity(a(R)),l&&C.setDisplacement(l(R)),u&&C.setRotation(u(R)),c&&C.setRotateWithView(c(R)),o&&C.setScale(o(R)),s&&C.setAnchor(s(R)),C}}function TR(t,e){const n="shape-",i=n+"points",r=n+"radius",s=pd(t[i],i),o=pd(t[r],r),a=Yo(t,n,e),l=Ho(t,n,e),u=bu(t,n+"scale",e),c=Gl(t,n+"displacement",e),h=dt(t,n+"rotation",e),d=rs(t,n+"rotate-with-view",e),g=Ul(t,n+"radius2"),f=Ul(t,n+"angle"),_=ju(t,n+"declutter-mode"),x=new Fu({points:s,radius:o,radius2:g,angle:f,declutterMode:_});return function(m){return a&&x.setFill(a(m)),l&&x.setStroke(l(m)),c&&x.setDisplacement(c(m)),h&&x.setRotation(h(m)),d&&x.setRotateWithView(d(m)),u&&x.setScale(u(m)),x}}function RR(t,e){const n="circle-",i=Yo(t,n,e),r=Ho(t,n,e),s=dt(t,n+"radius",e),o=bu(t,n+"scale",e),a=Gl(t,n+"displacement",e),l=dt(t,n+"rotation",e),u=rs(t,n+"rotate-with-view",e),c=ju(t,n+"declutter-mode"),h=new vs({radius:5,declutterMode:c});return function(d){return s&&h.setRadius(s(d)),i&&h.setFill(i(d)),r&&h.setStroke(r(d)),a&&h.setDisplacement(a(d)),l&&h.setRotation(l(d)),u&&h.setRotateWithView(u(d)),o&&h.setScale(o(d)),h}}function dt(t,e,n){if(!(e in t))return;const i=Vn(t[e],z,n);return function(r){return pd(i(r),e)}}function An(t,e,n){if(!(e in t))return null;const i=Vn(t[e],Fe,n);return function(r){return Px(i(r),e)}}function PR(t,e,n){const i=An(t,e+"pattern-src",n),r=Am(t,e+"pattern-offset",n),s=Am(t,e+"pattern-size",n),o=eg(t,e+"color",n);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function rs(t,e,n){if(!(e in t))return null;const i=Vn(t[e],Ae,n);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function eg(t,e,n){if(!(e in t))return null;const i=Vn(t[e],me,n);return function(r){return Ix(i(r),e)}}function Rx(t,e,n){if(!(e in t))return null;const i=Vn(t[e],yt,n);return function(r){return oa(i(r),e)}}function Gl(t,e,n){if(!(e in t))return null;const i=Vn(t[e],yt,n);return function(r){const s=oa(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function Am(t,e,n){if(!(e in t))return null;const i=Vn(t[e],yt,n);return function(r){return Lx(i(r),e)}}function bu(t,e,n){if(!(e in t))return null;const i=Vn(t[e],yt|z,n);return function(r){return MR(i(r),e)}}function Ul(t,e){const n=t[e];if(n!==void 0){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}}function IR(t,e){const n=t[e];if(n!==void 0){if(typeof n=="number")return st(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return n}}function LR(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}}function km(t,e){const n=t[e];if(n!==void 0){if(n!=="bottom-left"&&n!=="bottom-right"&&n!=="top-left"&&n!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function Mm(t,e){const n=t[e];if(n!==void 0){if(n!=="pixels"&&n!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return n}}function AR(t,e){const n=t[e];if(n!==void 0)return oa(n,e)}function ju(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);if(n!=="declutter"&&n!=="obstacle"&&n!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function kR(t,e){const n=t[e];if(n!==void 0)return Ix(n,e)}function oa(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let i=0;i<n;++i)if(typeof t[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return t}function Px(t,e){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}function pd(t,e){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}function Ix(t,e){if(typeof t=="string")return t;const n=oa(t,e),i=n.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function Lx(t,e){const n=oa(t,e);if(n.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return n}function MR(t,e){return typeof t=="number"?t:Lx(t,e)}const Dm={RENDER_ORDER:"renderOrder"};class zu extends Du{constructor(e){e=e||{};const n=Object.assign({},e);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,super(n),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Dm.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,n){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new _x(9)),this.getRenderer().renderDeclutter(e,n)}setRenderOrder(e){this.set(Dm.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Tx:e;const n=DR(e);this.styleFunction_=e===null?void 0:_R(n),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function DR(t){if(t===void 0)return Tx;if(!t)return null;if(typeof t=="function"||t instanceof Ji)return t;if(!Array.isArray(t))return Lm([t]);if(t.length===0)return[];const e=t.length,n=t[0];if(n instanceof Ji){const r=new Array(e);for(let s=0;s<e;++s){const o=t[s];if(!(o instanceof Ji))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in n){const r=new Array(e);for(let s=0;s<e;++s){const o=t[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return vR(r)}return Lm(t)}class _o extends Xn{constructor(e,n,i,r){super(e),this.inversePixelTransform=n,this.frameState=i,this.context=r}}class NR extends ta{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,n){re()}calculateMatrices2D(e){const n=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;tn(i,e.size[0]/2,e.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),$o(r,i)}forEachFeatureAtCoordinate(e,n,i,r,s,o,a,l){let u;const c=n.viewState;function h(v,w,C,R){return s.call(o,w,v?C:null,R)}const d=c.projection,g=G0(e.slice(),d),f=[[0,0]];if(d.canWrapX()&&r){const v=d.getExtent(),w=ae(v);f.push([-w,0],[w,0])}const _=n.layerStatesArray,x=_.length,m=[],p=[];for(let v=0;v<f.length;v++)for(let w=x-1;w>=0;--w){const C=_[w],R=C.layer;if(R.hasRenderer()&&Vf(C,c)&&a.call(l,R)){const T=R.getRenderer(),I=R.getSource();if(T&&I){const A=I.getWrapX()?g:e,j=h.bind(null,C.managed);p[0]=A[0]+f[v][0],p[1]=A[1]+f[v][1],u=T.forEachFeatureAtCoordinate(p,n,i,j,m)}if(u)return u}}if(m.length===0)return;const y=1/m.length;return m.forEach((v,w)=>v.distanceSq+=w*y),m.sort((v,w)=>v.distanceSq-w.distanceSq),m.some(v=>u=v.callback(v.feature,v.layer,v.geometry)),u}hasFeatureAtCoordinate(e,n,i,r,s,o){return this.forEachFeatureAtCoordinate(e,n,i,r,bo,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){re()}scheduleExpireIconCache(e){Bt.canExpireCache()&&e.postRenderFunctions.push(FR)}}function FR(t,e){Bt.expire()}class OR extends NR{constructor(e){super(e),this.fontChangeListenerKey_=ee(Ar,fs.PROPERTYCHANGE,e.redrawText,e),this.element_=wt?cx():document.createElement("div");const n=this.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",this.element_.className=ku+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,n){const i=this.getMap();if(i.hasListener(e)){const r=new _o(e,void 0,n);i.dispatchEvent(r)}}disposeInternal(){ge(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Ge.PRECOMPOSE,e);const n=e.layerStatesArray.sort((u,c)=>u.zIndex-c.zIndex);n.some(u=>u.layer instanceof zu&&u.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let u=0,c=n.length;u<c;++u){const h=n[u];e.layerIndex=u;const d=h.layer,g=d.getSourceState();if(!Vf(h,r)||g!="ready"&&g!="undefined"){d.unrender();continue}const f=d.render(e,o);f&&(f!==o&&(this.children_.push(f),o=f),s.push(h))}this.declutter(e,s),YC(this.element_,this.children_);const l=this.getMap().getTargetElement();if(hi(l)){const u=l.getContext("2d");for(const c of this.children_){const h=c.firstElementChild||c,d=c.style.backgroundColor;if(d&&(!hi(h)||h.width>0)&&(u.fillStyle=d,u.fillRect(0,0,l.width,l.height)),hi(h)&&h.width>0){const g=c.style.opacity||h.style.opacity;u.globalAlpha=g===""?1:Number(g);const f=h.style.transform;if(f)u.setTransform(...ud(f));else{const _=parseFloat(h.style.width)/h.width,x=parseFloat(h.style.height)/h.height;u.setTransform(_,0,0,x,0,0)}u.drawImage(h,0,0)}}u.globalAlpha=1,u.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Ge.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,n){if(e.declutter){for(let i=n.length-1;i>=0;--i){const r=n[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}n.forEach(i=>i.layer.renderDeferred(e))}}}function Ax(t){if(t instanceof Du){t.setMapInternal(null);return}t instanceof As&&t.getLayers().forEach(Ax)}function kx(t,e){if(t instanceof Du){t.setMapInternal(e);return}if(t instanceof As){const n=t.getLayers().getArray();for(let i=0,r=n.length;i<r;++i)kx(n[i],e)}}let bR=class extends xn{constructor(e){super(),e=e||{},this.on,this.once,this.un;const n=jR(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:yS,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=be(),this.pixelToCoordinateTransform_=be(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,wt||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=n.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,wt||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=n.controls||(wt?new zt:qC()),this.interactions=n.interactions||(wt?new zt:xT({onFocusOnly:!0})),this.overlays_=n.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new ES(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(qe.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(qe.VIEW,this.handleViewChanged_),this.addChangeListener(qe.SIZE,this.handleSizeChanged_),this.addChangeListener(qe.TARGET,this.handleTargetChanged_),this.setProperties(n.values);const i=this;e.view&&!(e.view instanceof fn)&&e.view.then(function(r){i.setView(new fn(r))}),this.controls.addEventListener(ct.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ct.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ct.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ct.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ct.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ct.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){kx(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const n=e.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=e),e.setMap(this)}disposeInternal(){var e;this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),(e=this.resizeObserver_)==null||e.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,n,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:bo,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,n,null,o,null)}getFeaturesAtPixel(e,n){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},n),i}getAllLayers(){const e=[];function n(i){i.forEach(function(r){r instanceof As?n(r.getLayers()):e.push(r)})}return n(this.getLayers()),e}hasFeatureAtPixel(e,n){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const r=n.layerFilter!==void 0?n.layerFilter:bo,s=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(qe.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return ld(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const n=this.frameState_;return n?Pe(n.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const n=this.overlayIdIndex_[e.toString()];return n!==void 0?n:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(qe.LAYERGROUP)}setLayers(e){const n=this.getLayerGroup();if(e instanceof zt){n.setLayers(e);return}const i=n.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let n=0,i=e.length;n<i;++n){const r=e[n];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const n=Rn(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)}getPixelFromCoordinateInternal(e){const n=this.frameState_;return n?Pe(n.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(qe.SIZE)}getView(){return this.get(qe.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,n,i,r){return wS(this.frameState_,e,n,i,r)}handleBrowserEvent(e,n){n=n||e.type;const i=new ei(n,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const n=e.originalEvent,i=n.type;if(i===ed.POINTERDOWN||i===J.WHEEL||i===J.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=n.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Be.ANIMATING]||o[Be.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}n.getTilesLoading()<r&&(n.reprioritize(),n.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Ge.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ge.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Ir(ti.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Ir(ti.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){var i,r;if(this.mapBrowserEventHandler_){for(let s=0,o=this.targetChangeHandlerKeys_.length;s<o;++s)ge(this.targetChangeHandlerKeys_[s]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(J.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(J.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!hi(this.targetElement_)){(i=this.resizeObserver_)==null||i.unobserve(this.targetElement_);const s=this.targetElement_.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.unobserve(s.host),this.setSize(void 0)}const e=this.getTarget(),n=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=n,!n)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(hi(n)||n.appendChild(this.viewport_),this.renderer_||(this.renderer_=new OR(this)),!hi(n)){this.mapBrowserEventHandler_=new xS(this,this.moveTolerance_);for(const o in we)this.mapBrowserEventHandler_.addEventListener(we[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(J.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(J.WHEEL,this.boundHandleBrowserEvent_,D0?{passive:!1}:!1);let s;if(this.keyboardEventTarget_)s=this.keyboardEventTarget_;else{const o=n.getRootNode();s=o instanceof ShadowRoot?o.host:n}if(this.targetChangeHandlerKeys_=[ee(s,J.KEYDOWN,this.handleBrowserEvent,this),ee(s,J.KEYPRESS,this.handleBrowserEvent,this)],n instanceof HTMLElement){const o=n.getRootNode();o instanceof ShadowRoot&&this.resizeObserver_.observe(o.host),(r=this.resizeObserver_)==null||r.observe(n)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(ge(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(ge(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=ee(e,fs.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=ee(e,J.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ge),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new ri("addlayer",e)),this.layerGroupPropertyListenerKeys_=[ee(e,fs.PROPERTYCHANGE,this.render,this),ee(e,J.CHANGE,this.render,this),ee(e,"addlayer",this.handleLayerAdd_,this),ee(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let n=0,i=e.length;n<i;++n){const r=e[n].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){Ax(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const n=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(n!==void 0&&Em(n)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:rd(a.center,a.resolution,a.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:X(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=rd(a.nextCenter,a.nextResolution,l,n)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Pu(this.previousExtent_)&&!ms(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Ir(ti.MOVESTART,this,r)),this.previousExtent_=Su(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Be.ANIMATING]&&!s.viewHints[Be.INTERACTING]&&!ms(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Ir(ti.MOVEEND,this,s)),N0(s.extent,this.previousExtent_))),this.dispatchEvent(new Ir(ti.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(ti.LOADSTART)||this.hasListener(ti.LOADEND)||this.hasListener(Ge.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const n=this.getLayerGroup();n&&this.handleLayerRemove_(new ri("removelayer",n)),this.set(qe.LAYERGROUP,e)}setSize(e){this.set(qe.SIZE,e)}setTarget(e){this.set(qe.TARGET,e)}setView(e){if(!e||e instanceof fn){this.set(qe.VIEW,e);return}this.set(qe.VIEW,new fn);const n=this;e.then(function(i){n.setView(new fn(i))})}updateSize(){const e=this.getTargetElement();let n;if(e){let r,s;if(hi(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(n=[Math.max(0,r),Math.max(0,s)],!Em(n)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&W0("No map visible because the map container's width or height are 0."))}const i=this.getSize();n&&(!i||!Wn(n,i))&&(this.setSize(n),this.updateViewportSize_(n))}updateViewportSize_(e){const n=this.getView();n&&n.setViewportSize(e)}};function jR(t){let e=null;t.keyboardEventTarget!==void 0&&(e=typeof t.keyboardEventTarget=="string"?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},i=t.layers&&typeof t.layers.getLayers=="function"?t.layers:new As({layers:t.layers});n[qe.LAYERGROUP]=i,n[qe.TARGET]=t.target,n[qe.VIEW]=t.view instanceof fn?t.view:new fn;let r;t.controls!==void 0&&(Array.isArray(t.controls)?r=new zt(t.controls.slice()):(te(typeof t.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=t.controls));let s;t.interactions!==void 0&&(Array.isArray(t.interactions)?s=new zt(t.interactions.slice()):(te(typeof t.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions));let o;return t.overlays!==void 0?Array.isArray(t.overlays)?o=new zt(t.overlays.slice()):(te(typeof t.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new zt,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:n}}class tg extends vu{constructor(e,n,i){super(),i=i||{},this.tileCoord=e,this.state=n,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(J.CHANGE)}release(){this.setState(G.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==G.EMPTY){if(this.state!==G.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){re()}getAlpha(e,n){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=n,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=n-i+1e3/60;return r>=this.transition_?1:U0(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function md(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}const zR=new Error("disposed"),$R=[256,256];class Nm extends tg{constructor(e){const n=G.IDLE;super(e.tileCoord,n,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=md(this.data_);return e?[e.width,e.height]:$R}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==G.IDLE&&this.state!==G.ERROR)return;this.state=G.LOADING,this.changed();const e=this;this.loader_().then(function(n){e.data_=n,e.state=G.LOADED,e.changed()}).catch(function(n){e.error_=n,e.state=G.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(zR),this.controller_=null),super.disposeInternal()}}class Mx extends tg{constructor(e,n,i,r,s,o){super(e,n,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,wt?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=G.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=G.ERROR,this.unlistenImage_(),this.image_=BR(),this.changed()}handleImageLoad_(){if(wt)this.state=G.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=G.LOADED:this.state=G.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==G.ERROR&&(this.state=G.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==G.IDLE&&(this.state=G.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=sR(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function BR(){const t=Me(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}class ng{constructor(e,n,i,r){this.minX=e,this.maxX=n,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,n){return this.minX<=e&&e<=this.maxX&&this.minY<=n&&n<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function wr(t,e,n,i,r){return r!==void 0?(r.minX=t,r.maxX=e,r.minY=n,r.maxY=i,r):new ng(t,e,n,i)}let zc;const ss=[];function Fm(t,e,n,i,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(i,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,i)+1,Math.max(n,r)),t.restore()}function $c(t,e){return Math.abs(t[e*4]-210)>2||Math.abs(t[e*4+3]-.75*255)>2}function GR(){if(zc===void 0){const t=Me(6,6,ss);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",Fm(t,4,5,4,0),Fm(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;zc=$c(e,0)||$c(e,4)||$c(e,8),Mu(t),ss.push(t.canvas)}return zc}function Om(t,e,n,i){const r=Df(n,e,t);let s=sm(e,i,n);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=t.getMetersPerUnit();a!==void 0&&(s/=a);const l=t.getExtent();if(!l||ps(l,r)){const u=sm(t,s,r)/s;isFinite(u)&&u>0&&(s/=u)}return s}function UR(t,e,n,i){const r=ar(n);let s=Om(t,e,r,i);return(!isFinite(s)||s<=0)&&Cf(n,function(o){return s=Om(t,e,o,i),isFinite(s)&&s>0}),s}function WR(t,e,n,i,r,s,o,a,l,u,c,h,d,g){const f=Me(Math.round(n*t),Math.round(n*e),ss);if(h||(f.imageSmoothingEnabled=!1),l.length===0)return f.canvas;f.scale(n,n);function _(w){return Math.round(w*n)/n}f.globalCompositeOperation="lighter";const x=Tt();l.forEach(function(w,C,R){RS(x,w.extent)});let m;const p=n/i,y=(h?1:1+Math.pow(2,-24))/p;m=Me(Math.round(ae(x)*p),Math.round(rt(x)*p),ss),h||(m.imageSmoothingEnabled=!1),l.forEach(function(w,C,R){if(w.image.width>0&&w.image.height>0){if(w.clipExtent){m.save();const b=(w.clipExtent[0]-x[0])*p,F=-(w.clipExtent[3]-x[3])*p,$=ae(w.clipExtent)*p,K=rt(w.clipExtent)*p;m.rect(h?b:Math.round(b),h?F:Math.round(F),h?$:Math.round(b+$)-Math.round(b),h?K:Math.round(F+K)-Math.round(F)),m.clip()}const T=(w.extent[0]-x[0])*p,I=-(w.extent[3]-x[3])*p,A=ae(w.extent)*p,j=rt(w.extent)*p;m.drawImage(w.image,u,u,w.image.width-2*u,w.image.height-2*u,h?T:Math.round(T),h?I:Math.round(I),h?A:Math.round(T+A)-Math.round(T),h?j:Math.round(I+j)-Math.round(I)),w.clipExtent&&m.restore()}});const v=hr(o);return a.getTriangles().forEach(function(w,C,R){const T=w.source,I=w.target;let A=T[0][0],j=T[0][1],b=T[1][0],F=T[1][1],$=T[2][0],K=T[2][1];const B=_((I[0][0]-v[0])/s),H=_(-(I[0][1]-v[1])/s),L=_((I[1][0]-v[0])/s),D=_(-(I[1][1]-v[1])/s),N=_((I[2][0]-v[0])/s),W=_(-(I[2][1]-v[1])/s),k=A,Ce=j;A=0,j=0,b-=k,F-=Ce,$-=k,K-=Ce;const ue=[[b,F,0,0,L-B],[$,K,0,0,N-B],[0,0,b,F,D-H],[0,0,$,K,W-H]],he=CS(ue);if(!he)return;if(f.save(),f.beginPath(),GR()||!h){f.moveTo(L,D);const Re=4,sn=B-L,Vt=H-D;for(let xt=0;xt<Re;xt++)f.lineTo(L+_((xt+1)*sn/Re),D+_(xt*Vt/(Re-1))),xt!=Re-1&&f.lineTo(L+_((xt+1)*sn/Re),D+_((xt+1)*Vt/(Re-1)));f.lineTo(N,W)}else f.moveTo(L,D),f.lineTo(B,H),f.lineTo(N,W);f.clip(),f.transform(he[0],he[2],he[1],he[3],B,H),f.translate(x[0]-k,x[3]-Ce);let Te;if(m)Te=m.canvas,f.scale(y,-y);else{const Re=l[0],sn=Re.extent;Te=Re.image,f.scale(ae(sn)/Te.width,-rt(sn)/Te.height)}f.drawImage(Te,0,0),f.restore()}),m&&(Mu(m),ss.push(m.canvas)),c&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach(function(w,C,R){const T=w.target,I=(T[0][0]-v[0])/s,A=-(T[0][1]-v[1])/s,j=(T[1][0]-v[0])/s,b=-(T[1][1]-v[1])/s,F=(T[2][0]-v[0])/s,$=-(T[2][1]-v[1])/s;f.beginPath(),f.moveTo(j,b),f.lineTo(I,A),f.lineTo(F,$),f.closePath(),f.stroke()}),f.restore()),f.canvas}const XR=10,bm=.25;class VR{constructor(e,n,i,r,s,o,a){this.sourceProj_=e,this.targetProj_=n;let l={};const u=a?uC(y=>Pe(a,Df(y,this.targetProj_,this.sourceProj_))):bl(this.targetProj_,this.sourceProj_);this.transformInv_=function(y){const v=y[0]+"/"+y[1];return l[v]||(l[v]=u(y)),l[v]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ae(r)>=ae(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ae(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ae(this.targetProj_.getExtent()):null;const c=hr(i),h=Ru(i),d=Tu(i),g=Cu(i),f=this.transformInv_(c),_=this.transformInv_(h),x=this.transformInv_(d),m=this.transformInv_(g),p=XR+(o?Math.max(0,Math.ceil(Math.log2(id(i)/(o*o*256*256)))):0);if(this.addQuad_(c,h,d,g,f,_,x,m,p),this.wrapsXInSource_){let y=1/0;this.triangles_.forEach(function(v,w,C){y=Math.min(y,v.source[0][0],v.source[1][0],v.source[2][0])}),this.triangles_.forEach(v=>{if(Math.max(v.source[0][0],v.source[1][0],v.source[2][0])-y>this.sourceWorldWidth_/2){const w=[[v.source[0][0],v.source[0][1]],[v.source[1][0],v.source[1][1]],[v.source[2][0],v.source[2][1]]];w[0][0]-y>this.sourceWorldWidth_/2&&(w[0][0]-=this.sourceWorldWidth_),w[1][0]-y>this.sourceWorldWidth_/2&&(w[1][0]-=this.sourceWorldWidth_),w[2][0]-y>this.sourceWorldWidth_/2&&(w[2][0]-=this.sourceWorldWidth_);const C=Math.min(w[0][0],w[1][0],w[2][0]);Math.max(w[0][0],w[1][0],w[2][0])-C<this.sourceWorldWidth_/2&&(v.source=w)}})}l={}}addTriangle_(e,n,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,n,i]})}addQuad_(e,n,i,r,s,o,a,l,u){const c=Zp([s,o,a,l]),h=this.sourceWorldWidth_?ae(c)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&h>.5&&h<1;let f=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const x=Zp([e,n,i,r]);f=ae(x)/this.targetWorldWidth_>bm||f}!g&&this.sourceProj_.isGlobal()&&h&&(f=h>bm||f)}if(!f&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!it(c,this.maxSourceExtent_))return;let _=0;if(!f&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)f=!0;else if(_=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),_!=1&&_!=2&&_!=4&&_!=8)return}if(u>0){if(!f){const x=[(e[0]+i[0])/2,(e[1]+i[1])/2],m=this.transformInv_(x);let p;g?p=(ts(s[0],d)+ts(a[0],d))/2-ts(m[0],d):p=(s[0]+a[0])/2-m[0];const y=(s[1]+a[1])/2-m[1];f=p*p+y*y>this.errorThresholdSquared_}if(f){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const x=[(n[0]+i[0])/2,(n[1]+i[1])/2],m=this.transformInv_(x),p=[(r[0]+e[0])/2,(r[1]+e[1])/2],y=this.transformInv_(p);this.addQuad_(e,n,x,p,s,o,m,y,u-1),this.addQuad_(p,x,i,r,y,m,a,l,u-1)}else{const x=[(e[0]+n[0])/2,(e[1]+n[1])/2],m=this.transformInv_(x),p=[(i[0]+r[0])/2,(i[1]+r[1])/2],y=this.transformInv_(p);this.addQuad_(e,x,p,r,s,m,y,l,u-1),this.addQuad_(x,n,i,p,m,o,a,y,u-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}_&11||this.addTriangle_(e,i,r,s,a,l),_&14||this.addTriangle_(e,i,n,s,a,o),_&&(_&13||this.addTriangle_(n,r,e,o,l,s),_&7||this.addTriangle_(n,r,i,o,l,a))}calculateSourceExtent(){const e=Tt();return this.triangles_.forEach(function(n,i,r){const s=n.source;po(e,s[0]),po(e,s[1]),po(e,s[2])}),e}getTriangles(){return this.triangles_}}const YR=.5;class Dx extends tg{constructor(e,n,i,r,s,o,a,l,u,c,h,d){super(s,G.IDLE,d),this.renderEdges_=h!==void 0?h:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=n,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const g=r.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let _=this.sourceTileGrid_.getExtent();const x=f?qi(g,f):g;if(id(x)===0){this.state=G.EMPTY;return}const m=e.getExtent();m&&(_?_=qi(_,m):_=m);const p=r.getResolution(this.wrappedTileCoord_[0]),y=UR(e,i,x,p);if(!isFinite(y)||y<=0){this.state=G.EMPTY;return}const v=c!==void 0?c:YR;if(this.triangulation_=new VR(e,i,x,_,y*v,p),this.triangulation_.getTriangles().length===0){this.state=G.EMPTY;return}this.sourceZ_=n.getZForResolution(y);let w=this.triangulation_.calculateSourceExtent();if(_&&(e.canWrapX()?(w[1]=_e(w[1],_[1],_[3]),w[3]=_e(w[3],_[1],_[3])):w=qi(w,_)),!id(w))this.state=G.EMPTY;else{let C=0,R=0;e.canWrapX()&&(C=ae(m),R=Math.floor((w[0]-m[0])/C)),B0(w.slice(),e,!0).forEach(I=>{const A=n.getTileRangeForExtentAndZ(I,this.sourceZ_);for(let j=A.minX;j<=A.maxX;j++)for(let b=A.minY;b<=A.maxY;b++){const F=u(this.sourceZ_,j,b,a);if(F){const $=R*C;this.sourceTiles_.push({tile:F,offset:$})}}++R}),this.sourceTiles_.length===0&&(this.state=G.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(n=>{var r;const i=n.tile;if(i&&i.getState()==G.LOADED){const s=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);s[0]+=n.offset,s[2]+=n.offset;const o=(r=this.clipExtent_)==null?void 0:r.slice();o&&(o[0]+=n.offset,o[2]+=n.offset),e.push({extent:s,clipExtent:o,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=G.ERROR;else{const n=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(n),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(n),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=WR(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=G.LOADED}this.changed()}load(){if(this.state==G.IDLE){this.state=G.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:n})=>{const i=n.getState();if(i==G.IDLE||i==G.LOADING){e++;const r=ee(n,J.CHANGE,s=>{const o=n.getState();(o==G.LOADED||o==G.ERROR||o==G.EMPTY)&&(ge(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:n},i,r){n.getState()==G.IDLE&&n.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(ge),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Mu(this.canvas_.getContext("2d")),ss.push(this.canvas_),this.canvas_=null),super.release()}}class jm{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof ta&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let n=this.oldest_;for(;n;)e(n.value_,n.key_,this),n=n.newer}get(e,n){const i=this.entries_[e];return te(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const n=this.entries_[e];return te(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_?(this.newest_=n.older,this.newest_&&(this.newest_.newer=null)):n===this.oldest_?(this.oldest_=n.newer,this.oldest_&&(this.oldest_.older=null)):(n.newer.older=n.older,n.older.newer=n.newer),delete this.entries_[e],--this.count_,n.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let n=0,i;for(i=this.newest_;i;i=i.older)e[n++]=i.key_;return e}getValues(){const e=new Array(this.count_);let n=0,i;for(i=this.newest_;i;i=i.older)e[n++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){var n;return(n=this.entries_[e])==null?void 0:n.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,n){this.get(e),this.entries_[e].value_=n}set(e,n){te(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:n};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function Wl(t,e,n,i){return i!==void 0?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]}function HR(t,e,n){return t+"/"+e+"/"+n}function rl(t,e,n,i,r){return`${X(t)},${e},${HR(n,i,r)}`}function KR(t){return ZR(t[0],t[1],t[2])}function ZR(t,e,n){return(e<<t)+n}function qR(t,e){const n=t[0],i=t[1],r=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const s=e.getFullTileRange(n);return s?s.containsXY(i,r):!0}class Nx{constructor(){Yu(this,"pushMethodArgs_",(...e)=>(this.push_(e),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(zl(),{get:(e,n)=>{if(typeof zl()[n]=="function")return this.push_(n),this.pushMethodArgs_},set:(e,n,i)=>(this.push_(n,i),!0)})}push_(...e){const n=this.instructions_,i=this.zIndex+this.offset_;n[i]||(n[i]=[]),n[i].push(...e)}pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(n=>{for(let i=0,r=n.length;i<r;++i){const s=n[i];if(typeof s=="function"){s(e);continue}const o=n[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const JR=5;class Fx extends na{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=JR}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return re()}getData(e){return null}prepareFrame(e){return re()}renderFrame(e,n){return re()}forEachFeatureAtCoordinate(e,n,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const n=e.target;(n.getState()===q.LOADED||n.getState()===q.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let n=e.getState();return n!=q.LOADED&&n!=q.ERROR&&e.addEventListener(J.CHANGE,this.boundHandleImageChange_),n==q.IDLE&&(e.load(),n=e.getState()),n==q.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const zm=[];let kr=null;function QR(){kr=Me(1,1,void 0,{willReadFrequently:!0})}class Ox extends Fx{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=be(),this.pixelTransform=be(),this.inversePixelTransform=be(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,n,i){kr||QR(),kr.clearRect(0,0,1,1);let r;try{kr.drawImage(e,n,i,1,1,0,0,1,1),r=kr.getImageData(0,0,1,1).data}catch{return kr=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,n,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&Wn(nn(e.style.backgroundColor),nn(i)))){const a=e.firstElementChild;hi(a)&&(o=a.getContext("2d"))}if(o&&_C(o.canvas.style.transform,n)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=wt?cx():document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Me();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,n,i){const r=hr(i),s=Ru(i),o=Tu(i),a=Cu(i);Pe(n.coordinateToPixelTransform,r),Pe(n.coordinateToPixelTransform,s),Pe(n.coordinateToPixelTransform,o),Pe(n.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Pe(l,r),Pe(l,s),Pe(l,o),Pe(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,n){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(ae(i)/r*o),l=Math.round(rt(i)/r*o);tn(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-l/2),$o(this.inversePixelTransform,this.pixelTransform);const u=mC(this.pixelTransform);if(this.useContainer(n,u,this.getBackground(e)),!this.containerReused){const c=this.context.canvas;c.width!=a||c.height!=l?(c.width=a,c.height=l):this.context.clearRect(0,0,a,l),u!==c.style.transform&&(c.style.transform=u)}}dispatchRenderEvent_(e,n,i){const r=this.getLayer();if(r.hasListener(e)){const s=new _o(e,this.inversePixelTransform,i,n);r.dispatchEvent(s)}}preRender(e,n){this.frameState=n,!n.declutter&&this.dispatchRenderEvent_(Ge.PRERENDER,e,n)}postRender(e,n){n.declutter||this.dispatchRenderEvent_(Ge.POSTRENDER,e,n)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Nx),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Ge.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Ge.POSTRENDER,this.context,e))}getRenderTransform(e,n,i,r,s,o,a){const l=s/2,u=o/2,c=r/n,h=-c,d=-e[0]+a,g=-e[1];return tn(this.tempTransform,l,u,c,h,-i,d,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function Bc(t,e,n){if(!(n in t))return t[n]=new Set([e]),!0;const i=t[n],r=i.has(e);return r||i.add(e),!r}function e2(t,e,n){const i=t[n];return i?i.delete(e):!1}function $m(t,e){const n=t.layerStatesArray[t.layerIndex];n.extent&&(e=qi(e,ci(n.extent,t.viewState.projection)));const i=n.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(t.viewState.projection).getExtent();r&&(e=qi(e,r))}return e}class t2 extends Ox{constructor(e,n){super(e),n=n||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Tt(),this.tempTileRange_=new ng(0,0,0,0),this.tempTileCoord_=Wl(0,0,0);const i=n.cacheSize!==void 0?n.cacheSize:512;this.tileCache_=new jm(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new jm(512)),this.sourceTileCache_}getOrCreateTile(e,n,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),l=rl(a,a.getKey(),e,n,i);let u;if(s.containsKey(l))u=s.get(l);else{const c=r.viewState.projection,h=a.getProjection();if(u=a.getTile(e,n,i,r.pixelRatio,c,!h||il(h,c)?void 0:this.getSourceTileCache()),!u)return null;s.set(l,u)}return u}getTile(e,n,i,r){const s=this.getOrCreateTile(e,n,i,r);return s||null}getData(e){const n=this.frameState;if(!n)return null;const i=this.getLayer(),r=Pe(n.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!ps(s,r))return null;const o=n.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),u=a.getTilePixelRatio(n.pixelRatio);for(let c=l.getZForResolution(o.resolution);c>=l.getMinZoom();--c){const h=l.getTileCoordForCoordAndZ(r,c),d=this.getTile(c,h[1],h[2],n);if(!d||d.getState()!==G.LOADED)continue;const g=l.getOrigin(c),f=st(l.getTileSize(c)),_=l.getResolution(c);let x;if(d instanceof Mx||d instanceof Dx)x=d.getImage();else if(d instanceof Nm){if(x=md(d.getData()),!x)continue}else continue;const m=Math.floor(u*((r[0]-g[0])/_-h[1]*f[0])),p=Math.floor(u*((g[1]-r[1])/_-h[2]*f[1])),y=Math.round(u*a.getGutterForProjection(o.projection));return this.getImageData(x,m+y,p+y)}return null}prepareFrame(e){var r;this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const n=this.getLayer().getSource();if(!n)return!1;const i=n.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===n.getKey()&&(this.tileCache_.clear(),(r=this.sourceTileCache_)==null||r.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,n,i,r,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),u=l.getTileGridForProjection(o.projection),c=X(l);c in e.wantedTiles||(e.wantedTiles[c]={});const h=e.wantedTiles[c],d=a.getMapInternal(),g=Math.max(i-s,u.getMinZoom(),u.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):u.getResolution(0)),l.zDirection)),f=o.rotation,_=f?z0(o.center,o.resolution,f,e.size):void 0;for(let x=i;x>=g;--x){const m=u.getTileRangeForExtentAndZ(n,x,this.tempTileRange_),p=u.getResolution(x);for(let y=m.minX;y<=m.maxX;++y)for(let v=m.minY;v<=m.maxY;++v){if(f&&!u.tileCoordIntersectsViewport([x,y,v],_))continue;const w=this.getTile(x,y,v,e);if(!w||!Bc(r,w,x))continue;const R=w.getKey();if(h[R]=!0,w.getState()===G.IDLE&&!e.tileQueue.isKeyQueued(R)){const T=Wl(x,y,v,this.tempTileCoord_);e.tileQueue.enqueue([w,c,u.getTileCoordCenter(T),p])}}}}findStaleTile_(e,n){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const u=rl(this.getLayer().getSource(),a[l],r,s,o);if(i.containsKey(u)){const c=i.peek(u);if(c.getState()===G.LOADED)return c.endTransition(X(this)),Bc(n,c,r),!0}}return!1}findAltTiles_(e,n,i,r){const s=e.getTileRangeForTileCoordAndZ(n,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),u=l.getKey();for(let c=s.minX;c<=s.maxX;++c)for(let h=s.minY;h<=s.maxY;++h){const d=rl(l,u,i,c,h);let g=!1;if(a.containsKey(d)){const f=a.peek(d);f.getState()===G.LOADED&&(Bc(r,f,i),g=!0)}g||(o=!1)}return o}renderFrame(e,n){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,l=e.pixelRatio,u=this.getLayer(),c=u.getSource(),h=c.getTileGridForProjection(s),d=h.getZForResolution(o,c.zDirection),g=h.getResolution(d),f=c.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==f&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=f):this.renderedSourceKey_=f;let _=e.extent;const x=c.getTilePixelRatio(l);this.prepareContainer(e,n);const m=this.context.canvas.width,p=this.context.canvas.height,y=i.extent&&ci(i.extent);y&&(_=qi(_,ci(i.extent)));const v=g*m/2/x,w=g*p/2/x,C=[a[0]-v,a[1]-w,a[0]+v,a[1]+w],R={};this.renderedTiles.length=0;const T=u.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const L=h.getZForResolution(r.nextResolution,c.zDirection),D=$m(e,e.nextExtent);this.enqueueTiles(e,D,L,R,T)}const I=$m(e,_);if(this.enqueueTiles(e,I,d,R,0),T>0&&setTimeout(()=>{this.enqueueTiles(e,I,d-1,R,T-1)},0),!(d in R))return this.container;const A=X(this),j=e.time;for(const L of R[d]){const D=L.getState();if(D===G.EMPTY)continue;const N=L.tileCoord;if(D===G.LOADED&&L.getAlpha(A,j)===1){L.endTransition(A);continue}if(D!==G.ERROR&&(this.renderComplete=!1),this.findStaleTile_(N,R)){e2(R,L,d),e.animate=!0;continue}if(this.findAltTiles_(h,N,d+1,R))continue;const Ce=h.getMinZoom();for(let ue=d-1;ue>=Ce&&!this.findAltTiles_(h,N,ue,R);--ue);}const b=g/o*l/x,F=this.getRenderContext(e);tn(this.tempTransform,m/2,p/2,b,b,0,-m/2,-p/2),i.extent&&this.clipUnrotated(F,e,y),c.getInterpolate()||(F.imageSmoothingEnabled=!1),this.preRender(F,e);const $=Object.keys(R).map(Number);$.sort(Fn);let K;const B=[],H=[];for(let L=$.length-1;L>=0;--L){const D=$[L],N=c.getTilePixelSize(D,l,s),k=h.getResolution(D)/g,Ce=N[0]*k*b,ue=N[1]*k*b,he=h.getTileCoordForCoordAndZ(hr(C),D),Te=h.getTileCoordExtent(he),Re=Pe(this.tempTransform,[x*(Te[0]-C[0])/g,x*(C[3]-Te[3])/g]),sn=x*c.getGutterForProjection(s);for(const Vt of R[D]){if(Vt.getState()!==G.LOADED)continue;const xt=Vt.tileCoord,la=he[1]-xt[1],Bu=Math.round(Re[0]-(la-1)*Ce),ks=he[2]-xt[2],Mi=Math.round(Re[1]-(ks-1)*ue),Lt=Math.round(Re[0]-la*Ce),on=Math.round(Re[1]-ks*ue),fr=Bu-Lt,gr=Mi-on,Ms=$.length===1;let Di=!1;K=[Lt,on,Lt+fr,on,Lt+fr,on+gr,Lt,on+gr];for(let pr=0,mr=B.length;pr<mr;++pr)if(!Ms&&D<H[pr]){const je=B[pr];it([Lt,on,Lt+fr,on+gr],[je[0],je[3],je[4],je[7]])&&(Di||(F.save(),Di=!0),F.beginPath(),F.moveTo(K[0],K[1]),F.lineTo(K[2],K[3]),F.lineTo(K[4],K[5]),F.lineTo(K[6],K[7]),F.moveTo(je[6],je[7]),F.lineTo(je[4],je[5]),F.lineTo(je[2],je[3]),F.lineTo(je[0],je[1]),F.clip())}B.push(K),H.push(D),this.drawTile(Vt,e,Lt,on,fr,gr,sn,Ms),Di&&F.restore(),this.renderedTiles.unshift(Vt),this.updateUsedTiles(e.usedTiles,c,Vt)}}if(this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!ms(this.renderedExtent_,C),this.renderedExtent_=C,this.renderedPixelRatio=l,this.postRender(this.context,e),i.extent&&F.restore(),F.imageSmoothingEnabled=!0,this.renderComplete){const L=(D,N)=>{var ue;const W=X(c),k=N.wantedTiles[W],Ce=k?Object.keys(k).length:0;this.updateCacheSize(Ce),this.tileCache_.expireCache(),(ue=this.sourceTileCache_)==null||ue.expireCache()};e.postRenderFunctions.push(L)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,n,i,r,s,o,a,l){let u;if(e instanceof Nm){if(u=md(e.getData()),!u)throw new Error("Rendering array data is not yet supported")}else u=this.getTileImage(e);if(!u)return;const c=this.getRenderContext(n),h=X(this),d=n.layerStatesArray[n.layerIndex],g=d.opacity*(l?e.getAlpha(h,n.time):1),f=g!==c.globalAlpha;f&&(c.save(),c.globalAlpha=g),c.drawImage(u,a,a,u.width-2*a,u.height-2*a,i,r,s,o),f&&c.restore(),g!==d.opacity?n.animate=!0:l&&e.endTransition(h)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,n,i){const r=X(n);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const za={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class n2 extends Du{constructor(e){e=e||{};const n=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete n.preload,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(za.PRELOAD)}setPreload(e){this.set(za.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(za.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(za.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class i2 extends n2{constructor(e){super(e)}createRenderer(){return new t2(this,{cacheSize:this.getCacheSize()})}}const Sr=[0,0,0],Kn=5;class bx{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,te(hS(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let n;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!n)n=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==n){n=void 0;break}}this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,te(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=hr(i)),te(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,te(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Bf,te(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new ng(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,n,i){const r=this.getTileRangeForExtentAndZ(e,n);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)i([n,s,a])}forEachTileCoordParentTileRange(e,n,i,r){let s,o,a,l=null,u=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,r);u>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=wr(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(l,u,i),n(u,s))return!0;--u}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,n,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return wr(s,s+1,o,o+1,n)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,n)}return null}getTileRangeForTileCoordAndZ(e,n,i){if(n>this.maxZoom||n<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(n===r)return wr(s,o,s,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,n-r),u=Math.floor(s*l),c=Math.floor(o*l);if(n<r)return wr(u,u,c,c,i);const h=Math.floor(l*(s+1))-1,d=Math.floor(l*(o+1))-1;return wr(u,h,c,d,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,n,i)}getTileRangeForExtentAndZ(e,n,i){this.getTileCoordForXYAndZ_(e[0],e[3],n,!1,Sr);const r=Sr[1],s=Sr[2];this.getTileCoordForXYAndZ_(e[2],e[1],n,!0,Sr);const o=Sr[1],a=Sr[2];return wr(r,o,s,a,i)}getTileCoordCenter(e){const n=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=st(this.getTileSize(e[0]),this.tmpSize_);return[n[0]+(e[1]+.5)*r[0]*i,n[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,n){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=st(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,a=i[1]-(e[2]+1)*s[1]*r,l=o+s[0]*r,u=a+s[1]*r;return Gn(o,a,l,u,n)}getTileCoordForCoordAndResolution(e,n,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],n,!1,i)}getTileCoordForXYAndResolution_(e,n,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),u=st(this.getTileSize(o),this.tmpSize_);let c=a*(e-l[0])/i/u[0],h=a*(l[1]-n)/i/u[1];return r?(c=Aa(c,Kn)-1,h=Aa(h,Kn)-1):(c=La(c,Kn),h=La(h,Kn)),Wl(o,c,h,s)}getTileCoordForXYAndZ_(e,n,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),l=st(this.getTileSize(i),this.tmpSize_);let u=(e-o[0])/a/l[0],c=(o[1]-n)/a/l[1];return r?(u=Aa(u,Kn)-1,c=Aa(c,Kn)-1):(u=La(u,Kn),c=La(c,Kn)),Wl(i,u,c,s)}getTileCoordForCoordAndZ(e,n,i){return this.getTileCoordForXYAndZ_(e[0],e[1],n,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,n){const i=Ef(this.resolutions_,e,n||0);return _e(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,n){return lx(n,0,n.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const n=this.resolutions_.length,i=new Array(n);for(let r=this.minZoom;r<n;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function jx(t){let e=t.getDefaultTileGrid();return e||(e=a2(t),t.setDefaultTileGrid(e)),e}function r2(t,e,n){const i=e[0],r=t.getTileCoordCenter(e),s=ig(n);if(!ps(s,r)){const o=ae(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,t.getTileCoordForCoordAndZ(r,i)}return e}function s2(t,e,n,i){i=i!==void 0?i:"top-left";const r=zx(t,e,n);return new bx({extent:t,origin:IS(t,i),resolutions:r,tileSize:n})}function o2(t){const e=t||{},n=e.extent||_t("EPSG:3857").getExtent(),i={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:zx(n,e.maxZoom,e.tileSize,e.maxResolution)};return new bx(i)}function zx(t,e,n,i){e=e!==void 0?e:$C,n=st(n!==void 0?n:Bf);const r=rt(t),s=ae(t);i=i>0?i:Math.max(s/n[0],r/n[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function a2(t,e,n,i){const r=ig(t);return s2(r,e,n,i)}function ig(t){t=_t(t);let e=t.getExtent();if(!e){const n=180*Rf.degrees/t.getMetersPerUnit();e=Gn(-n,-n,n,n)}return e}const l2=/\{z\}/g,u2=/\{x\}/g,c2=/\{y\}/g,h2=/\{-y\}/g;function d2(t,e,n,i,r){return t.replace(l2,e.toString()).replace(u2,n.toString()).replace(c2,i.toString()).replace(h2,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function f2(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const i=n[1].charCodeAt(0),r=n[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(t.replace(n[0],String.fromCharCode(s)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const i=parseInt(n[2],10);for(let r=parseInt(n[1],10);r<=i;r++)e.push(t.replace(n[0],r.toString()));return e}return e.push(t),e}function g2(t,e){return function(n,i,r){if(!n)return;let s;const o=n[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return d2(t,o,n[1],n[2],s)}}function p2(t,e){const n=t.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=g2(t[r],e);return m2(i)}function m2(t){return t.length===1?t[0]:function(e,n,i){if(!e)return;const r=KR(e),s=ts(r,t.length);return t[s](e,n,i)}}class $x extends xn{constructor(e){super(),this.projection=_t(e.projection),this.attributions_=Bm(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const n=this;this.viewPromise_=new Promise(function(i,r){n.viewResolver=i,n.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=Bm(e),this.changed()}setState(e){this.state_=e,this.changed()}}function Bm(t){return t?typeof t=="function"?t:(Array.isArray(t)||(t=[t]),e=>t):null}class _2 extends $x{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const n=[256,256];this.tileGrid&&st(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),n),this.tmpSize=[0,0],this.key_=e.key||X(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const n=e?this.getTileGridForProjection(e):this.tileGrid;return n?n.getResolutions():null}getTile(e,n,i,r,s,o){return re()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:jx(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,n,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(n),o=st(r.getTileSize(e),this.tmpSize);return s==1?o:FT(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,n){const i=n!==void 0?n:this.getProjection(),r=n!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=r2(r,e,i)),qR(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class y2 extends Xn{constructor(e,n){super(e),this.tile=n}}const Gc={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class rg extends _2{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===rg.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const n=e.target,i=X(n),r=n.getState();let s;r==G.LOADING?(this.tileLoadingKeys_[i]=!0,s=Gc.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==G.ERROR?Gc.TILELOADERROR:r==G.LOADED?Gc.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new y2(s,n))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,n){this.tileUrlFunction=e,typeof n<"u"?this.setKey(n):this.changed()}setUrl(e){const n=f2(e);this.urls=n,this.setUrls(n)}setUrls(e){this.urls=e;const n=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(p2(e,this.tileGrid),n):this.setKey(n)}tileUrlFunction(e,n,i){}}class x2 extends rg{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Bx,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Mx,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!il(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||il(n,e)))return this.tileGrid;const i=X(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=jx(e)),this.tileGridForProjection[i]}createTile_(e,n,i,r,s,o){const a=[e,n,i],l=this.getTileCoordForTileUrlFunction(a,s),u=l?this.tileUrlFunction(l,r,s):void 0,c=new this.tileClass(a,u!==void 0?G.IDLE:G.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=o,c.addEventListener(J.CHANGE,this.handleTileChange.bind(this)),c}getTile(e,n,i,r,s,o){const a=this.getProjection();if(!a||!s||il(a,s))return this.getTileInternal(e,n,i,r,a||s);const l=[e,n,i],u=this.getKey(),c=this.getTileGridForProjection(a),h=this.getTileGridForProjection(s),d=this.getTileCoordForTileUrlFunction(l,s),g=new Dx(a,c,s,h,l,d,this.getTilePixelRatio(r),this.getGutter(),(f,_,x,m)=>this.getTileInternal(f,_,x,m,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=u,g}getTileInternal(e,n,i,r,s,o){const a=this.getKey(),l=rl(this,a,e,n,i);if(o&&o.containsKey(l))return o.get(l);const u=this.createTile_(e,n,i,r,s,a);return o==null||o.set(l,u),u}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,n){const i=_t(e);if(i){const r=X(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=n)}}}function Bx(t,e){if(wt){const n=t.getCrossOrigin();let i="same-origin",r="same-origin";n==="anonymous"||n===""?(i="cors",r="omit"):n==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{var l;const o=t.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),(l=s.close)==null||l.call(s),o.dispatchEvent(new Event("load"))}).catch(()=>{t.getImage().dispatchEvent(new Event("error"))});return}t.getImage().src=e}class v2 extends x2{constructor(e){e=e||{};const n=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:o2({extent:ig(n),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const E2='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class w2 extends v2{constructor(e){e=e||{};let n;e.attributions!==void 0?n=e.attributions:n=[E2];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:n,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!wt&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||Bx)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}class Gx{drawCustom(e,n,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,n,i){}drawFeature(e,n,i){}drawGeometryCollection(e,n,i){}drawLineString(e,n,i){}drawMultiLineString(e,n,i){}drawMultiPoint(e,n,i){}drawMultiPolygon(e,n,i){}drawPoint(e,n,i){}drawPolygon(e,n,i){}drawText(e,n,i){}setFillStrokeStyle(e,n){}setImageStyle(e,n){}setTextStyle(e,n){}}const U={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},$a=[U.FILL],di=[U.STROKE],Hi=[U.BEGIN_PATH],Gm=[U.CLOSE_PATH];class aa extends Gx{constructor(e,n,i,r){super(),this.tolerance=e,this.maxExtent=n,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const n=this.pixelRatio;return n==1?e:e.map(function(i){return i*n})}appendFlatPointCoordinates(e,n){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=n)r[0]=e[a],r[1]=e[a+1],ps(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,n,i,r,s,o){const a=this.coordinates;let l=a.length;const u=this.getBufferedMaxExtent();o&&(n+=r);let c=e[n],h=e[n+1];const d=this.tmpCoordinate_;let g=!0,f,_,x;for(f=n+r;f<i;f+=r)d[0]=e[f],d[1]=e[f+1],x=nd(u,d),x!==_?(g&&(a[l++]=c,a[l++]=h,g=!1),a[l++]=d[0],a[l++]=d[1]):x===ze.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],g=!1):g=!0,c=d[0],h=d[1],_=x;return(s&&g||f===n+r)&&(a[l++]=c,a[l++]=h),l}drawCustomCoordinates_(e,n,i,r,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],u=this.appendFlatLineCoordinates(e,n,l,r,!1,!1);s.push(u),n=l}return n}drawCustom(e,n,i,r,s){this.beginGeometry(e,n,s);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let u,c,h,d,g;switch(o){case"MultiPolygon":u=e.getOrientedFlatCoordinates(),d=[];const f=e.getEndss();g=0;for(let _=0,x=f.length;_<x;++_){const m=[];g=this.drawCustomCoordinates_(u,g,f[_],a,m),d.push(m)}this.instructions.push([U.CUSTOM,l,d,e,i,cm,s]),this.hitDetectionInstructions.push([U.CUSTOM,l,d,e,r||i,cm,s]);break;case"Polygon":case"MultiLineString":h=[],u=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),g=this.drawCustomCoordinates_(u,0,e.getEnds(),a,h),this.instructions.push([U.CUSTOM,l,h,e,i,jl,s]),this.hitDetectionInstructions.push([U.CUSTOM,l,h,e,r||i,jl,s]);break;case"LineString":case"Circle":u=e.getFlatCoordinates(),c=this.appendFlatLineCoordinates(u,0,u.length,a,!1,!1),this.instructions.push([U.CUSTOM,l,c,e,i,Xr,s]),this.hitDetectionInstructions.push([U.CUSTOM,l,c,e,r||i,Xr,s]);break;case"MultiPoint":u=e.getFlatCoordinates(),c=this.appendFlatPointCoordinates(u,a),c>l&&(this.instructions.push([U.CUSTOM,l,c,e,i,Xr,s]),this.hitDetectionInstructions.push([U.CUSTOM,l,c,e,r||i,Xr,s]));break;case"Point":u=e.getFlatCoordinates(),this.coordinates.push(u[0],u[1]),c=this.coordinates.length,this.instructions.push([U.CUSTOM,l,c,e,i,void 0,s]),this.hitDetectionInstructions.push([U.CUSTOM,l,c,e,r||i,void 0,s]);break}this.endGeometry(n)}beginGeometry(e,n,i){this.beginGeometryInstruction1_=[U.BEGIN_GEOMETRY,n,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[U.BEGIN_GEOMETRY,n,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let n;const i=e.length;let r,s,o=-1;for(n=0;n<i;++n)r=e[n],s=r[0],s==U.END_GEOMETRY?o=n:s==U.BEGIN_GEOMETRY&&(r[2]=n,cS(this.hitDetectionInstructions,o,n),o=-1)}fillStyleToState(e,n={}){if(e){const i=e.getColor();n.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,n.fillStyle=pn(i||ht)}else n.fillStyle=void 0;return n}strokeStyleToState(e,n={}){if(e){const i=e.getColor();n.strokeStyle=pn(i||Wo);const r=e.getLineCap();n.lineCap=r!==void 0?r:ys;const s=e.getLineDash();n.lineDash=s?s.slice():On;const o=e.getLineDashOffset();n.lineDashOffset=o||bn;const a=e.getLineJoin();n.lineJoin=a!==void 0?a:xs;const l=e.getWidth();n.lineWidth=l!==void 0?l:Vo;const u=e.getMiterLimit();n.miterLimit=u!==void 0?u:Uo,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0;return n}setFillStrokeStyle(e,n){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(n,i)}createFill(e){const n=e.fillStyle,i=[U.SET_FILL_STYLE,n];return typeof n!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[U.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,n){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(n.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,n){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,u=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!Wn(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=u)&&(n.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=u)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const n=[U.END_GEOMETRY,e];this.instructions.push(n),this.hitDetectionInstructions.push(n)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=N0(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;wu(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class S2 extends aa{constructor(e,n,i,r){super(e,n,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,n,i){if(!this.image_||this.maxExtent&&!ps(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,n,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([U.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([U.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}drawMultiPoint(e,n,i){if(!this.image_)return;this.beginGeometry(e,n,i);const r=e.getFlatCoordinates(),s=[];for(let l=0,u=r.length;l<u;l+=e.getStride())(!this.maxExtent||ps(this.maxExtent,r.slice(l,l+2)))&&s.push(r[l],r[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([U.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([U.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,n){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}class C2 extends aa{constructor(e,n,i,r){super(e,n,i,r)}drawFlatCoordinates_(e,n,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,n,i,r,!1,!1),a=[U.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,n,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,n,i),this.hitDetectionInstructions.push([U.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,On,bn],Hi);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(di),this.endGeometry(n)}drawMultiLineString(e,n,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,n,i),this.hitDetectionInstructions.push([U.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,On,bn],Hi);const a=e.getEnds(),l=e.getFlatCoordinates(),u=e.getStride();let c=0;for(let h=0,d=a.length;h<d;++h)c=this.drawFlatCoordinates_(l,c,a[h],u);this.hitDetectionInstructions.push(di),this.endGeometry(n)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(di),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(di),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Hi)}}class Um extends aa{constructor(e,n,i,r){super(e,n,i,r)}drawFlatCoordinatess_(e,n,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=i.length;this.instructions.push(Hi),this.hitDetectionInstructions.push(Hi);for(let u=0;u<l;++u){const c=i[u],h=this.coordinates.length,d=this.appendFlatLineCoordinates(e,n,c,r,!0,!a),g=[U.MOVE_TO_LINE_TO,h,d];this.instructions.push(g),this.hitDetectionInstructions.push(g),a&&(this.instructions.push(Gm),this.hitDetectionInstructions.push(Gm)),n=c}return o&&(this.instructions.push($a),this.hitDetectionInstructions.push($a)),a&&(this.instructions.push(di),this.hitDetectionInstructions.push(di)),n}drawCircle(e,n,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([U.SET_FILL_STYLE,ht]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([U.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,On,bn]);const a=e.getFlatCoordinates(),l=e.getStride(),u=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const c=[U.CIRCLE,u];this.instructions.push(Hi,c),this.hitDetectionInstructions.push(Hi,c),r.fillStyle!==void 0&&(this.instructions.push($a),this.hitDetectionInstructions.push($a)),r.strokeStyle!==void 0&&(this.instructions.push(di),this.hitDetectionInstructions.push(di)),this.endGeometry(n)}drawPolygon(e,n,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([U.SET_FILL_STYLE,ht]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([U.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,On,bn]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),u=e.getStride();this.drawFlatCoordinatess_(l,0,a,u),this.endGeometry(n)}drawMultiPolygon(e,n,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([U.SET_FILL_STYLE,ht]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([U.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,On,bn]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),u=e.getStride();let c=0;for(let h=0,d=a.length;h<d;++h)c=this.drawFlatCoordinatess_(l,c,a[h],u);this.endGeometry(n)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const n=this.coordinates;for(let i=0,r=n.length;i<r;++i)n[i]=zi(n[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function T2(t,e,n,i,r){const s=[];let o=n,a=0,l=e.slice(n,2);for(;a<t&&o+r<i;){const[u,c]=l.slice(-2),h=e[o+r],d=e[o+r+1],g=Math.sqrt((h-u)*(h-u)+(d-c)*(d-c));if(a+=g,a>=t){const f=(t-a+g)/g,_=Ot(u,h,f),x=Ot(c,d,f);l.push(_,x),s.push(l),l=[_,x],a==t&&(o+=r),a=0}else if(a<t)l.push(e[o+r],e[o+r+1]),o+=r;else{const f=g-a,_=Ot(u,h,f/g),x=Ot(c,d,f/g);l.push(_,x),s.push(l),l=[_,x],a=0,o+=r}}return a>0&&s.push(l),s}function R2(t,e,n,i,r){let s=n,o=n,a=0,l=0,u=n,c,h,d,g,f,_,x,m,p,y;for(h=n;h<i;h+=r){const v=e[h],w=e[h+1];f!==void 0&&(p=v-f,y=w-_,g=Math.sqrt(p*p+y*y),x!==void 0&&(l+=d,c=Math.acos((x*p+m*y)/(d*g)),c>t&&(l>a&&(a=l,s=u,o=h),l=0,u=h-r)),d=g,x=p,m=y),f=v,_=w}return l+=g,l>a?[u,h]:[s,o]}const Xl={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class P2 extends aa{constructor(e,n,i,r){super(e,n,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ht]={fillStyle:ht},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,n,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let l=a.length;const u=e.getType();let c=null,h=e.getStride();if(o.placement==="line"&&(u=="LineString"||u=="MultiLineString"||u=="Polygon"||u=="MultiPolygon")){if(!it(this.maxExtent,e.getExtent()))return;let d;if(c=e.getFlatCoordinates(),u=="LineString")d=[c.length];else if(u=="MultiLineString")d=e.getEnds();else if(u=="Polygon")d=e.getEnds().slice(0,1);else if(u=="MultiPolygon"){const x=e.getEndss();d=[];for(let m=0,p=x.length;m<p;++m)d.push(x[m][0])}this.beginGeometry(e,n,i);const g=o.repeat,f=g?void 0:o.textAlign;let _=0;for(let x=0,m=d.length;x<m;++x){let p;g?p=T2(g*this.resolution,c,_,d[x],h):p=[c.slice(_,d[x])];for(let y=0,v=p.length;y<v;++y){const w=p[y];let C=0,R=w.length;if(f==null){const I=R2(o.maxAngle,w,0,w.length,2);C=I[0],R=I[1]}for(let I=C;I<R;I+=h)a.push(w[I],w[I+1]);const T=a.length;_=d[x],this.drawChars_(l,T),l=T}}this.endGeometry(n)}else{let d=o.overflow?null:[];switch(u){case"Point":case"MultiPoint":c=e.getFlatCoordinates();break;case"LineString":c=e.getFlatMidpoint();break;case"Circle":c=e.getCenter();break;case"MultiLineString":c=e.getFlatMidpoints(),h=2;break;case"Polygon":c=e.getFlatInteriorPoint(),o.overflow||d.push(c[2]/this.resolution),h=3;break;case"MultiPolygon":const v=e.getFlatInteriorPoints();c=[];for(let w=0,C=v.length;w<C;w+=3)o.overflow||d.push(v[w+2]/this.resolution),c.push(v[w],v[w+1]);if(c.length===0)return;h=2;break}const g=this.appendFlatPointCoordinates(c,h);if(g===l)return;if(d&&(g-l)/2!==c.length/h){let v=l/2;d=d.filter((w,C)=>{const R=a[(v+C)*2]===c[C*h]&&a[(v+C)*2+1]===c[C*h+1];return R||--v,R})}this.saveTextStates_();const f=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,_=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,n,i);let x=o.padding;if(x!=Yi&&(o.scale[0]<0||o.scale[1]<0)){let v=o.padding[0],w=o.padding[1],C=o.padding[2],R=o.padding[3];o.scale[0]<0&&(w=-w,R=-R),o.scale[1]<0&&(v=-v,C=-C),x=[v,w,C,R]}const m=this.pixelRatio;this.instructions.push([U.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,x==Yi?Yi:x.map(function(v){return v*m}),f,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const p=1/m,y=f?f.slice(0):null;y&&(y[1]=ht),this.hitDetectionInstructions.push([U.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[p,p],NaN,this.declutterMode_,this.declutterImageWithText_,x,y,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ht:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(n)}}saveTextStates_(){const e=this.textStrokeState_,n=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:n.font,textAlign:n.textAlign||Xo,justify:n.justify,textBaseline:n.textBaseline||Bl,scale:n.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,n){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,u=Xl[r.textBaseline],c=this.textOffsetY_*l,h=this.text_,d=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([U.DRAW_CHARS,e,n,u,r.overflow,a,r.maxAngle,l,c,s,d*l,h,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([U.DRAW_CHARS,e,n,u,r.overflow,a&&ht,r.maxAngle,l,c,s,d*l,h,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,n){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=pn(o.getColor()||ht)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const _=a.getLineDash(),x=a.getLineDashOffset(),m=a.getWidth(),p=a.getMiterLimit();s.lineCap=a.getLineCap()||ys,s.lineDash=_?_.slice():On,s.lineDashOffset=x===void 0?bn:x,s.lineJoin=a.getLineJoin()||xs,s.lineWidth=m===void 0?Vo:m,s.miterLimit=p===void 0?Uo:p,s.strokeStyle=pn(a.getColor()||Wo)}i=this.textState_;const l=e.getFont()||wx;dR(l);const u=e.getScaleArray();i.overflow=e.getOverflow(),i.font=l,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Bl,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||Yi,i.scale=u===void 0?[1,1]:u;const c=e.getOffsetX(),h=e.getOffsetY(),d=e.getRotateWithView(),g=e.getKeepUpright(),f=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=c===void 0?0:c,this.textOffsetY_=h===void 0?0:h,this.textRotateWithView_=d===void 0?!1:d,this.textKeepUpright_=g===void 0?!0:g,this.textRotation_=f===void 0?0:f,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:X(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+X(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}const I2={Circle:Um,Default:aa,Image:S2,LineString:C2,Polygon:Um,Text:P2};class L2{constructor(e,n,i,r){this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const n in this.buildersByZIndex_){e[n]=e[n]||{};const i=this.buildersByZIndex_[n];for(const r in i){const s=i[r].finish();e[n][r]=s}}return e}getBuilder(e,n){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[n];if(s===void 0){const o=I2[n];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[n]=s}return s}}function A2(t,e,n,i){let r=t[e],s=t[e+1],o=0;for(let a=e+i;a<n;a+=i){const l=t[a],u=t[a+1];o+=Math.sqrt((l-r)*(l-r)+(u-s)*(u-s)),r=l,s=u}return o}function k2(t,e,n,i,r,s,o,a,l,u,c,h,d=!0){let g=t[e],f=t[e+1],_=0,x=0,m=0,p=0;function y(){_=g,x=f,e+=i,g=t[e],f=t[e+1],p+=m,m=Math.sqrt((g-_)*(g-_)+(f-x)*(f-x))}do y();while(e<n-i&&p+m<s);let v=m===0?0:(s-p)/m;const w=Ot(_,g,v),C=Ot(x,f,v),R=e-i,T=p,I=s+a*l(u,r,c);for(;e<n-i&&p+m<I;)y();v=m===0?0:(I-p)/m;const A=Ot(_,g,v),j=Ot(x,f,v);let b=!1;if(d)if(h){const H=[w,C,A,j];Nf(H,0,4,2,h,H,H),b=H[0]>H[2]}else b=w>A;const F=Math.PI,$=[],K=R+i===e;e=R,m=0,p=T,g=t[e],f=t[e+1];let B;if(K){y(),B=Math.atan2(f-x,g-_),b&&(B+=B>0?-F:F);const H=(A+w)/2,L=(j+C)/2;return $[0]=[H,L,(I-s)/2,B,r],$}r=r.replace(/\n/g," ");for(let H=0,L=r.length;H<L;){y();let D=Math.atan2(f-x,g-_);if(b&&(D+=D>0?-F:F),B!==void 0){let he=D-B;if(he+=he>F?-2*F:he<-F?2*F:0,Math.abs(he)>o)return null}B=D;const N=H;let W=0;for(;H<L;++H){const he=b?L-H-1:H,Te=a*l(u,r[he],c);if(e+i<n&&p+m<s+W+Te/2)break;W+=Te}if(H===N)continue;const k=b?r.substring(L-N,L-H):r.substring(N,H);v=m===0?0:(s+W/2-p)/m;const Ce=Ot(_,g,v),ue=Ot(x,f,v);$.push([Ce,ue,W/2,D,k]),s+=W}return $}const Cr=Tt(),Zn=[],Sn=[],Cn=[],qn=[];function Wm(t){return t[3].declutterBox}const Xm=new RegExp("[-----]");function Uc(t,e){return e==="start"?e=Xm.test(t)?"right":"left":e==="end"&&(e=Xm.test(t)?"left":"right"),Xl[e]}function M2(t,e,n){return n>0&&t.push(`
`,""),t.push(e,""),t}function D2(t,e,n){return n%2===0&&(t+=e),t}class N2{constructor(e,n,i,r,s){this.overlaps=i,this.pixelRatio=n,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=be(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Nx:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,n,i,r){const s=e+n+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,l=this.textStates[n],u=this.pixelRatio,c=[l.scale[0]*u,l.scale[1]*u],h=l.justify?Xl[l.justify]:Uc(Array.isArray(e)?e[0]:e,l.textAlign||Xo),d=r&&o.lineWidth?o.lineWidth:0,g=Array.isArray(e)?e:String(e).split(`
`).reduce(M2,[]),{width:f,height:_,widths:x,heights:m,lineWidths:p}=gR(l,g),y=f+d,v=[],w=(y+2)*c[0],C=(_+d)*c[1],R={width:w<0?Math.floor(w):Math.ceil(w),height:C<0?Math.floor(C):Math.ceil(C),contextInstructions:v};(c[0]!=1||c[1]!=1)&&v.push("scale",c),r&&(v.push("strokeStyle",o.strokeStyle),v.push("lineWidth",d),v.push("lineCap",o.lineCap),v.push("lineJoin",o.lineJoin),v.push("miterLimit",o.miterLimit),v.push("setLineDash",[o.lineDash]),v.push("lineDashOffset",o.lineDashOffset)),i&&v.push("fillStyle",a.fillStyle),v.push("textBaseline","middle"),v.push("textAlign","center");const T=.5-h;let I=h*y+T*d;const A=[],j=[];let b=0,F=0,$=0,K=0,B;for(let H=0,L=g.length;H<L;H+=2){const D=g[H];if(D===`
`){F+=b,b=0,I=h*y+T*d,++K;continue}const N=g[H+1]||l.font;N!==B&&(r&&A.push("font",N),i&&j.push("font",N),B=N),b=Math.max(b,m[$]);const W=[D,I+T*x[$]+h*(x[$]-p[K]),.5*(d+b)+F];I+=x[$],r&&A.push("strokeText",W),i&&j.push("fillText",W),++$}return Array.prototype.push.apply(v,A),Array.prototype.push.apply(v,j),this.labels_[s]=R,R}replayTextBackground_(e,n,i,r,s,o,a){e.beginPath(),e.moveTo.apply(e,n),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,n),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,n,i,r,s,o,a,l,u,c,h,d,g,f,_,x){a*=d[0],l*=d[1];let m=i-a,p=r-l;const y=s+u>e?e-u:s,v=o+c>n?n-c:o,w=f[3]+y*d[0]+f[1],C=f[0]+v*d[1]+f[2],R=m-f[3],T=p-f[0];(_||h!==0)&&(Zn[0]=R,qn[0]=R,Zn[1]=T,Sn[1]=T,Sn[0]=R+w,Cn[0]=Sn[0],Cn[1]=T+C,qn[1]=Cn[1]);let I;return h!==0?(I=tn(be(),i,r,1,1,h,-i,-r),Pe(I,Zn),Pe(I,Sn),Pe(I,Cn),Pe(I,qn),Gn(Math.min(Zn[0],Sn[0],Cn[0],qn[0]),Math.min(Zn[1],Sn[1],Cn[1],qn[1]),Math.max(Zn[0],Sn[0],Cn[0],qn[0]),Math.max(Zn[1],Sn[1],Cn[1],qn[1]),Cr)):Gn(Math.min(R,R+w),Math.min(T,T+C),Math.max(R,R+w),Math.max(T,T+C),Cr),g&&(m=Math.round(m),p=Math.round(p)),{drawImageX:m,drawImageY:p,drawImageW:y,drawImageH:v,originX:u,originY:c,declutterBox:{minX:Cr[0],minY:Cr[1],maxX:Cr[2],maxY:Cr[3],value:x},canvasTransform:I,scale:d}}replayImageOrLabel_(e,n,i,r,s,o,a){const l=!!(o||a),u=r.declutterBox,c=a?a[2]*r.scale[0]/2:0;return u.minX-c<=n[0]&&u.maxX+c>=0&&u.minY-c<=n[1]&&u.maxY+c>=0&&(l&&this.replayTextBackground_(e,Zn,Sn,Cn,qn,o,a),pR(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const n=this.alignAndScaleFill_;if(n){const i=Pe(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),n!==1&&e.scale(n,n),e.rotate(this.viewRotation_)}e.fill(),n&&e.restore()}setStrokeStyle_(e,n){e.strokeStyle=n[1],n[1]&&(e.lineWidth=n[2],e.lineCap=n[3],e.lineJoin=n[4],e.miterLimit=n[5],e.lineDashOffset=n[7],e.setLineDash(n[6]))}drawLabelWithPointPlacement_(e,n,i,r){const s=this.textStates[n],o=this.createLabel(e,n,r,i),a=this.strokeStates[i],l=this.pixelRatio,u=Uc(Array.isArray(e)?e[0]:e,s.textAlign||Xo),c=Xl[s.textBaseline||Bl],h=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*s.scale[0],g=u*d+2*(.5-u)*h,f=c*o.height/l+2*(.5-c)*h;return{label:o,anchorX:g,anchorY:f}}execute_(e,n,i,r,s,o,a,l){const u=this.zIndexContext_;let c;this.pixelCoordinates_&&Wn(i,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=yn(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Q0(this.renderedTransform_,i));let h=0;const d=r.length;let g=0,f,_,x,m,p,y,v,w,C,R,T,I,A,j=0,b=0;const F=this.coordinateCache_,$=this.viewRotation_,K=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,B={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:$},H=this.instructions!=r||this.overlaps?0:200;let L,D,N,W;for(;h<d;){const k=r[h];switch(k[0]){case U.BEGIN_GEOMETRY:L=k[1],W=k[3],L.getGeometry()?a!==void 0&&!it(a,W.getExtent())?h=k[2]+1:++h:h=k[2],u&&(u.zIndex=k[4]);break;case U.BEGIN_PATH:j>H&&(this.fill_(e),j=0),b>H&&(e.stroke(),b=0),!j&&!b&&(e.beginPath(),p=NaN,y=NaN),++h;break;case U.CIRCLE:g=k[1];const ue=c[g],he=c[g+1],Te=c[g+2],Re=c[g+3],sn=Te-ue,Vt=Re-he,xt=Math.sqrt(sn*sn+Vt*Vt);e.moveTo(ue+xt,he),e.arc(ue,he,xt,0,2*Math.PI,!0),++h;break;case U.CLOSE_PATH:e.closePath(),++h;break;case U.CUSTOM:g=k[1],f=k[2];const la=k[3],Bu=k[4],ks=k[5];B.geometry=la,B.feature=L,h in F||(F[h]=[]);const Mi=F[h];ks?ks(c,g,f,2,Mi):(Mi[0]=c[g],Mi[1]=c[g+1],Mi.length=2),u&&(u.zIndex=k[6]),Bu(Mi,B),++h;break;case U.DRAW_IMAGE:g=k[1],f=k[2],C=k[3],_=k[4],x=k[5];let Lt=k[6];const on=k[7],fr=k[8],gr=k[9],Ms=k[10];let Di=k[11];const pr=k[12];let mr=k[13];m=k[14]||"declutter";const je=k[15];if(!C&&k.length>=20){R=k[19],T=k[20],I=k[21],A=k[22];const At=this.drawLabelWithPointPlacement_(R,T,I,A);C=At.label,k[3]=C;const Ni=k[23];_=(At.anchorX-Ni)*this.pixelRatio,k[4]=_;const kt=k[24];x=(At.anchorY-kt)*this.pixelRatio,k[5]=x,Lt=C.height,k[6]=Lt,mr=C.width,k[13]=mr}let Gu;k.length>25&&(Gu=k[25]);let Uu,ua,ca;k.length>17?(Uu=k[16],ua=k[17],ca=k[18]):(Uu=Yi,ua=null,ca=null),Ms&&K?Di+=$:!Ms&&!K&&(Di-=$);let ov=0;for(;g<f;g+=2){if(Gu&&Gu[ov++]<mr/this.pixelRatio)continue;const At=this.calculateImageOrLabelDimensions_(C.width,C.height,c[g],c[g+1],mr,Lt,_,x,fr,gr,Di,pr,s,Uu,!!ua||!!ca,L),Ni=[e,n,C,At,on,ua,ca];if(l){let kt,an,Mt;if(je){const Ee=f-g;if(!je[Ee]){je[Ee]={args:Ni,declutterMode:m};continue}const tt=je[Ee];kt=tt.args,an=tt.declutterMode,delete je[Ee],Mt=Wm(kt)}let vn,En;if(kt&&(an!=="declutter"||!l.collides(Mt))&&(vn=!0),(m!=="declutter"||!l.collides(At.declutterBox))&&(En=!0),an==="declutter"&&m==="declutter"){const Ee=vn&&En;vn=Ee,En=Ee}vn&&(an!=="none"&&l.insert(Mt),this.replayImageOrLabel_.apply(this,kt)),En&&(m!=="none"&&l.insert(At.declutterBox),this.replayImageOrLabel_.apply(this,Ni))}else this.replayImageOrLabel_.apply(this,Ni)}++h;break;case U.DRAW_CHARS:const mg=k[1],_g=k[2],Wu=k[3],av=k[4];A=k[5];const lv=k[6],yg=k[7],xg=k[8];I=k[9];const Xu=k[10];R=k[11],Array.isArray(R)&&(R=R.reduce(D2,"")),T=k[12];const vg=[k[13],k[13]];m=k[14]||"declutter";const uv=k[15],Vu=this.textStates[T],Ds=Vu.font,Ns=[Vu.scale[0]*yg,Vu.scale[1]*yg];let Fs;Ds in this.widths_?Fs=this.widths_[Ds]:(Fs={},this.widths_[Ds]=Fs);const Eg=A2(c,mg,_g,2),wg=Math.abs(Ns[0])*Rm(Ds,R,Fs);if(av||wg<=Eg){const At=this.textStates[T].textAlign,Ni=(Eg-wg)*Uc(R,At),kt=k2(c,mg,_g,2,R,Ni,lv,Math.abs(Ns[0]),Rm,Ds,Fs,K?0:this.viewRotation_,uv);e:if(kt){const an=[];let Mt,vn,En,Ee,tt;if(I)for(Mt=0,vn=kt.length;Mt<vn;++Mt){tt=kt[Mt],En=tt[4],Ee=this.createLabel(En,T,"",I),_=tt[2]+(Ns[0]<0?-Xu:Xu),x=Wu*Ee.height+(.5-Wu)*2*Xu*Ns[1]/Ns[0]-xg;const wn=this.calculateImageOrLabelDimensions_(Ee.width,Ee.height,tt[0],tt[1],Ee.width,Ee.height,_,x,0,0,tt[3],vg,!1,Yi,!1,L);if(l&&m==="declutter"&&l.collides(wn.declutterBox))break e;an.push([e,n,Ee,wn,1,null,null])}if(A)for(Mt=0,vn=kt.length;Mt<vn;++Mt){tt=kt[Mt],En=tt[4],Ee=this.createLabel(En,T,A,""),_=tt[2],x=Wu*Ee.height-xg;const wn=this.calculateImageOrLabelDimensions_(Ee.width,Ee.height,tt[0],tt[1],Ee.width,Ee.height,_,x,0,0,tt[3],vg,!1,Yi,!1,L);if(l&&m==="declutter"&&l.collides(wn.declutterBox))break e;an.push([e,n,Ee,wn,1,null,null])}l&&m!=="none"&&l.load(an.map(Wm));for(let wn=0,cv=an.length;wn<cv;++wn)this.replayImageOrLabel_.apply(this,an[wn])}}++h;break;case U.END_GEOMETRY:if(o!==void 0){L=k[1];const At=o(L,W,m);if(At)return At}++h;break;case U.FILL:H?j++:this.fill_(e),++h;break;case U.MOVE_TO_LINE_TO:for(g=k[1],f=k[2],D=c[g],N=c[g+1],e.moveTo(D,N),p=D+.5|0,y=N+.5|0,g+=2;g<f;g+=2)D=c[g],N=c[g+1],v=D+.5|0,w=N+.5|0,(g==f-2||v!==p||w!==y)&&(e.lineTo(D,N),p=v,y=w);++h;break;case U.SET_FILL_STYLE:this.alignAndScaleFill_=k[2],j&&(this.fill_(e),j=0,b&&(e.stroke(),b=0)),e.fillStyle=k[1],++h;break;case U.SET_STROKE_STYLE:b&&(e.stroke(),b=0),this.setStrokeStyle_(e,k),++h;break;case U.STROKE:H?b++:e.stroke(),++h;break;default:++h;break}}j&&this.fill_(e),b&&e.stroke()}execute(e,n,i,r,s,o){this.viewRotation_=r,this.execute_(e,n,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,n,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],n,this.hitDetectionInstructions,!0,r,s)}}const $i=["Polygon","Circle","LineString","Image","Text","Default"],Ux=["Image","Text"],F2=$i.filter(t=>!Ux.includes(t));class O2{constructor(e,n,i,r,s,o,a){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=n,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=be(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,n){const i=this.getClipCoords(n);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,n){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const a=s[o];r[o]=new N2(this.resolution_,this.pixelRatio_,this.overlaps_,a,n)}}}hasExecutors(e){for(const n in this.executorsByZIndex_){const i=this.executorsByZIndex_[n];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,n,i,r,s,o){r=Math.round(r);const a=r*2+1,l=tn(this.hitDetectionTransform_,r+.5,r+.5,1/n,-1/n,-i,-e[0],-e[1]),u=!this.hitDetectionContext_;u&&(this.hitDetectionContext_=Me(a,a));const c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):u||c.clearRect(0,0,a,a);let h;this.renderBuffer_!==void 0&&(h=Tt(),po(h,e),wu(h,n*(this.renderBuffer_+r),h));const d=b2(r);let g;function f(w,C,R){const T=c.getImageData(0,0,a,a).data;for(let I=0,A=d.length;I<A;I++)if(T[d[I]]>0){if(!o||R==="none"||g!=="Image"&&g!=="Text"||o.includes(w)){const j=(d[I]-3)/4,b=r-j%a,F=r-(j/a|0),$=s(w,C,b*b+F*F);if($)return $}c.clearRect(0,0,a,a);break}}const _=Object.keys(this.executorsByZIndex_).map(Number);_.sort(Fn);let x,m,p,y,v;for(x=_.length-1;x>=0;--x){const w=_[x].toString();for(p=this.executorsByZIndex_[w],m=$i.length-1;m>=0;--m)if(g=$i[m],y=p[g],y!==void 0&&(v=y.executeHitDetection(c,l,i,f,h),v))return v}}getClipCoords(e){const n=this.maxExtent_;if(!n)return null;const i=n[0],r=n[1],s=n[2],o=n[3],a=[i,r,i,o,s,o,s,r];return yn(a,0,8,2,e,a),a}isEmpty(){return gs(this.executorsByZIndex_)}execute(e,n,i,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?uS:Fn),o=o||$i;const u=$i.length;for(let c=0,h=l.length;c<h;++c){const d=l[c].toString(),g=this.executorsByZIndex_[d];for(let f=0,_=o.length;f<_;++f){const x=o[f],m=g[x];if(m!==void 0){const p=a===null?void 0:m.getZIndexContext(),y=p?p.getContext():e,v=this.maxExtent_&&x!=="Image"&&x!=="Text";if(v&&(y.save(),this.clip(y,i)),!p||x==="Text"||x==="Image"?m.execute(y,n,i,r,s,a):p.pushFunction(w=>m.execute(w,n,i,r,s,a)),v&&y.restore(),p){p.offset();const w=l[c]*u+$i.indexOf(x);this.deferredZIndexContexts_[w]||(this.deferredZIndexContexts_[w]=[]),this.deferredZIndexContexts_[w].push(p)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,n=Object.keys(e).map(Number).sort(Fn);for(let i=0,r=n.length;i<r;++i)e[n[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[n[i]].length=0}}const Wc={};function b2(t){if(Wc[t]!==void 0)return Wc[t];const e=t*2+1,n=t*t,i=new Array(n+1);for(let s=0;s<=t;++s)for(let o=0;o<=t;++o){const a=s*s+o*o;if(a>n)break;let l=i[a];l||(l=[],i[a]=l),l.push(((t+s)*e+(t+o))*4+3),s>0&&l.push(((t-s)*e+(t+o))*4+3),o>0&&(l.push(((t+s)*e+(t-o))*4+3),s>0&&l.push(((t-s)*e+(t-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return Wc[t]=r,r}class j2 extends Gx{constructor(e,n,i,r,s,o,a){super(),this.context_=e,this.pixelRatio_=n,this.extent_=i,this.transform_=r,this.transformRotation_=r?Eu(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=be()}drawImages_(e,n,i,r){if(!this.image_)return;const s=yn(e,n,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let u=this.imageRotation_;this.transformRotation_===0&&(u-=this.viewRotation_),this.imageRotateWithView_&&(u+=this.viewRotation_);for(let c=0,h=s.length;c<h;c+=2){const d=s[c]-this.imageAnchorX_,g=s[c+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const f=d+this.imageAnchorX_,_=g+this.imageAnchorY_;tn(a,f,_,1,1,u,-f,-_),o.save(),o.transform.apply(o,a),o.translate(f,_),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,n,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=yn(e,n,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);n<i;n+=r){const l=s[n]+this.textOffsetX_,u=s[n+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,u-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,u),this.textFillState_&&o.fillText(this.text_,l,u))}}moveToLineTo_(e,n,i,r,s){const o=this.context_,a=yn(e,n,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let u=2;u<l;u+=2)o.lineTo(a[u],a[u+1]);return s&&o.closePath(),i}drawRings_(e,n,i,r){for(let s=0,o=i.length;s<o;++s)n=this.moveToLineTo_(e,n,i[s],r,!0);return n}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!it(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=SC(e,this.transform_,this.pixelCoordinates_),i=n[2]-n[0],r=n[3]-n[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(n[0],n[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,n){const i=n.getGeometryFunction()(e);i&&(this.setStyle(n),this.drawGeometry(i))}drawGeometryCollection(e){const n=e.getGeometriesArray();for(let i=0,r=n.length;i<r;++i)this.drawGeometry(n[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(n,0,n.length,i),this.text_!==""&&this.drawText_(n,0,n.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(n,0,n.length,i),this.text_!==""&&this.drawText_(n,0,n.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!it(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,i=e.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoint();this.drawText_(n,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getExtent();if(it(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let l=0,u=o.length;l<u;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!it(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_;n.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!it(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();n.beginPath();for(let a=0,l=s.length;a<l;++a){const u=s[a];r=this.drawRings_(i,r,u,o)}this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoints();this.drawText_(n,0,n.length,2)}}}setContextFillState_(e){const n=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,n.fillStyle=e.fillStyle):(n.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const n=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,n.lineCap=e.lineCap),Wn(i.lineDash,e.lineDash)||n.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,n.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,n.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,n.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,n.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,n.strokeStyle=e.strokeStyle)):(n.lineCap=e.lineCap,n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset,n.lineJoin=e.lineJoin,n.lineWidth=e.lineWidth,n.miterLimit=e.miterLimit,n.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const n=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Xo;i?(i.font!=e.font&&(i.font=e.font,n.font=e.font),i.textAlign!=r&&(i.textAlign=r,n.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,n.textBaseline=e.textBaseline)):(n.font=e.font,n.textAlign=r,n.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,n){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:pn(i||ht)}}if(!n)this.strokeState_=null;else{const i=n.getColor(),r=n.getLineCap(),s=n.getLineDash(),o=n.getLineDashOffset(),a=n.getLineJoin(),l=n.getWidth(),u=n.getMiterLimit(),c=s||On;this.strokeState_={lineCap:r!==void 0?r:ys,lineDash:this.pixelRatio_===1?c:c.map(h=>h*this.pixelRatio_),lineDashOffset:(o||bn)*this.pixelRatio_,lineJoin:a!==void 0?a:xs,lineWidth:(l!==void 0?l:Vo)*this.pixelRatio_,miterLimit:u!==void 0?u:Uo,strokeStyle:pn(i||Wo)}}}setImageStyle(e){let n;if(!e||!(n=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=n[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=n[0]*i}setTextStyle(e){if(!e)this.text_="";else{const n=e.getFill();if(!n)this.textFillState_=null;else{const g=n.getColor();this.textFillState_={fillStyle:pn(g||ht)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const g=i.getColor(),f=i.getLineCap(),_=i.getLineDash(),x=i.getLineDashOffset(),m=i.getLineJoin(),p=i.getWidth(),y=i.getMiterLimit();this.textStrokeState_={lineCap:f!==void 0?f:ys,lineDash:_||On,lineDashOffset:x||bn,lineJoin:m!==void 0?m:xs,lineWidth:p!==void 0?p:Vo,miterLimit:y!==void 0?y:Uo,strokeStyle:pn(g||Wo)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),u=e.getScaleArray(),c=e.getText(),h=e.getTextAlign(),d=e.getTextBaseline();this.textState_={font:r!==void 0?r:wx,textAlign:h!==void 0?h:Xo,textBaseline:d!==void 0?d:Bl},this.text_=c!==void 0?Array.isArray(c)?c.reduce((g,f,_)=>g+=_%2?" ":f,""):c:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*u[0],this.pixelRatio_*u[1]]}}}const gn=.5;function z2(t,e,n,i,r,s,o,a,l){const u=r,c=t[0]*gn,h=t[1]*gn,d=Me(c,h);d.imageSmoothingEnabled=!1;const g=d.canvas,f=new j2(d,gn,r,null,o,a,null),_=n.length,x=Math.floor((256*256*256-1)/_),m={};for(let y=1;y<=_;++y){const v=n[y-1],w=v.getStyleFunction()||i;if(!w)continue;let C=w(v,s);if(!C)continue;Array.isArray(C)||(C=[C]);const T=(y*x).toString(16).padStart(7,"#00000");for(let I=0,A=C.length;I<A;++I){const j=C[I],b=j.getGeometryFunction()(v);if(!b||!it(u,b.getExtent()))continue;const F=j.clone(),$=F.getFill();$&&$.setColor(T);const K=F.getStroke();K&&(K.setColor(T),K.setLineDash(null)),F.setText(void 0);const B=j.getImage();if(B){const N=B.getImageSize();if(!N)continue;const W=Me(N[0],N[1],void 0,{alpha:!1}),k=W.canvas;W.fillStyle=T,W.fillRect(0,0,k.width,k.height),F.setImage(new Ou({img:k,anchor:B.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:B.getOrigin(),opacity:1,size:B.getSize(),scale:B.getScale(),rotation:B.getRotation(),rotateWithView:B.getRotateWithView()}))}const H=F.getZIndex()||0;let L=m[H];L||(L={},m[H]=L,L.Polygon=[],L.Circle=[],L.LineString=[],L.Point=[]);const D=b.getType();if(D==="GeometryCollection"){const N=b.getGeometriesArrayRecursive();for(let W=0,k=N.length;W<k;++W){const Ce=N[W];L[Ce.getType().replace("Multi","")].push(Ce,F)}}else L[D.replace("Multi","")].push(b,F)}}const p=Object.keys(m).map(Number).sort(Fn);for(let y=0,v=p.length;y<v;++y){const w=m[p[y]];for(const C in w){const R=w[C];for(let T=0,I=R.length;T<I;T+=2){f.setStyle(R[T+1]);for(let A=0,j=e.length;A<j;++A)f.setTransform(e[A]),f.drawGeometry(R[T])}}}return d.getImageData(0,0,g.width,g.height)}function $2(t,e,n){const i=[];if(n){const r=Math.floor(Math.round(t[0])*gn),s=Math.floor(Math.round(t[1])*gn),o=(_e(r,0,n.width-1)+_e(s,0,n.height-1)*n.width)*4,a=n.data[o],l=n.data[o+1],c=n.data[o+2]+256*(l+256*a),h=Math.floor((256*256*256-1)/e.length);c&&c%h===0&&i.push(e[c/h-1])}return i}const B2=.5,Wx={Point:K2,LineString:V2,Polygon:q2,MultiPoint:Z2,MultiLineString:Y2,MultiPolygon:H2,GeometryCollection:X2,Circle:U2};function G2(t,e){return parseInt(X(t),10)-parseInt(X(e),10)}function Vm(t,e){const n=Xx(t,e);return n*n}function Xx(t,e){return B2*t/e}function U2(t,e,n,i,r){const s=n.getFill(),o=n.getStroke();if(s||o){const l=t.getBuilder(n.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,i,r)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i)}}function Ym(t,e,n,i,r,s,o,a){const l=[],u=n.getImage();if(u){let d=!0;const g=u.getImageState();g==q.LOADED||g==q.ERROR?d=!1:g==q.IDLE&&u.load(),d&&l.push(u.ready())}const c=n.getFill();c&&c.loading()&&l.push(c.ready());const h=l.length>0;return h&&Promise.all(l).then(()=>r(null)),W2(t,e,n,i,s,o,a),h}function W2(t,e,n,i,r,s,o){const a=n.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(i,r);if(n.getRenderer())Vx(t,l,n,e,o);else{const c=Wx[l.getType()];c(t,l,n,e,o,s)}}function Vx(t,e,n,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)Vx(t,o[a],n,i,r);return}t.getBuilder(n.getZIndex(),"Default").drawCustom(e,i,n.getRenderer(),n.getHitDetectionRenderer(),r)}function X2(t,e,n,i,r,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const u=Wx[o[a].getType()];u(t,o[a],n,i,r,s)}}function V2(t,e,n,i,r){const s=n.getStroke();if(s){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,i,r)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function Y2(t,e,n,i,r){const s=n.getStroke();if(s){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,i,r)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function H2(t,e,n,i,r){const s=n.getFill(),o=n.getStroke();if(o||s){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,i,r)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,r)}}function K2(t,e,n,i,r,s){const o=n.getImage(),a=n.getText(),l=a&&a.getText(),u=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=q.LOADED)return;const c=t.getBuilder(n.getZIndex(),"Image");c.setImageStyle(o,u),c.drawPoint(e,i,r)}if(l){const c=t.getBuilder(n.getZIndex(),"Text");c.setTextStyle(a,u),c.drawText(e,i,r)}}function Z2(t,e,n,i,r,s){const o=n.getImage(),a=o&&o.getOpacity()!==0,l=n.getText(),u=l&&l.getText(),c=s&&a&&u?{}:void 0;if(a){if(o.getImageState()!=q.LOADED)return;const h=t.getBuilder(n.getZIndex(),"Image");h.setImageStyle(o,c),h.drawMultiPoint(e,i,r)}if(u){const h=t.getBuilder(n.getZIndex(),"Text");h.setTextStyle(l,c),h.drawText(e,i,r)}}function q2(t,e,n,i,r){const s=n.getFill(),o=n.getStroke();if(s||o){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,i,r)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,r)}}class J2 extends Ox{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Tt(),this.wrappedRenderedExtent_=Tt(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,n,i){const r=n.extent,s=n.viewState,o=s.center,a=s.resolution,l=s.projection,u=s.rotation,c=l.getExtent(),h=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),g=n.pixelRatio,f=n.viewHints,_=!(f[Be.ANIMATING]||f[Be.INTERACTING]),x=this.context,m=Math.round(ae(r)/a*g),p=Math.round(rt(r)/a*g),y=h.getWrapX()&&l.canWrapX(),v=y?ae(c):null,w=y?Math.ceil((r[2]-c[2])/v)+1:1;let C=y?Math.floor((r[0]-c[0])/v):0;do{let R=this.getRenderTransform(o,a,0,g,m,p,C*v);n.declutter&&(R=R.slice(0)),e.execute(x,[x.canvas.width,x.canvas.height],R,u,_,i===void 0?$i:i?Ux:F2,i?d&&n.declutter[d]:void 0)}while(++C<w)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Me(this.context.canvas.width,this.context.canvas.height,zm))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Mu(this.context),zm.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,n){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,n);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Ge.PRERENDER)||this.getLayer().hasListener(Ge.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=ci(i.extent);a=it(l,e.extent),this.clipped_=a&&!Qs(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(n=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,u=this.getLayer(),c=[],h=i[0]*gn,d=i[1]*gn;c.push(this.getRenderTransform(r,s,o,gn,h,d,0).slice());const g=u.getSource(),f=a.getExtent();if(g.getWrapX()&&a.canWrapX()&&!Qs(f,l)){let _=l[0];const x=ae(f);let m=0,p;for(;_<f[0];)--m,p=x*m,c.push(this.getRenderTransform(r,s,o,gn,h,d,p).slice()),_+=x;for(m=0,_=l[2];_>f[2];)++m,p=x*m,c.push(this.getRenderTransform(r,s,o,gn,h,d,p).slice()),_-=x}this.hitDetectionImageData_=z2(i,c,this.renderedFeatures_,u.getStyleFunction(),l,s,o,Vm(s,this.renderedPixelRatio_))}n($2(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,n,i,r,s){var d,g;if(!this.replayGroup_)return;const o=n.viewState.resolution,a=n.viewState.rotation,l=this.getLayer(),u={},c=function(f,_,x){const m=X(f),p=u[m];if(p){if(p!==!0&&x<p.distanceSq){if(x===0)return u[m]=!0,s.splice(s.lastIndexOf(p),1),r(f,l,_);p.geometry=_,p.distanceSq=x}}else{if(x===0)return u[m]=!0,r(f,l,_);s.push(u[m]={feature:f,layer:l,geometry:_,distanceSq:x,callback:r})}},h=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,i,c,h?(g=(d=n.declutter)==null?void 0:d[h])==null?void 0:g.all().map(f=>f.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const n=this.getLayer(),i=n.getSource();if(!i)return!1;const r=e.viewHints[Be.ANIMATING],s=e.viewHints[Be.INTERACTING],o=n.getUpdateWhileAnimating(),a=n.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,u=e.viewState,c=u.projection,h=u.resolution,d=e.pixelRatio,g=n.getRevision(),f=n.getRenderBuffer();let _=n.getRenderOrder();_===void 0&&(_=G2);const x=u.center.slice(),m=wu(l,f*h),p=m.slice(),y=[m.slice()],v=c.getExtent();if(i.getWrapX()&&c.canWrapX()&&!Qs(v,e.extent)){const $=ae(v),K=Math.max(ae(m)/2,$);m[0]=v[0]-K,m[2]=v[2]+K,G0(x,c);const B=$0(y[0],c);B[0]<v[0]&&B[2]<v[2]?y.push([B[0]+$,B[1],B[2]+$,B[3]]):B[0]>v[0]&&B[2]>v[2]&&y.push([B[0]-$,B[1],B[2]-$,B[3]])}if(this.ready&&this.renderedResolution_==h&&this.renderedRevision_==g&&this.renderedRenderOrder_==_&&this.renderedFrameDeclutter_===!!e.declutter&&Qs(this.wrappedRenderedExtent_,m))return Wn(this.renderedExtent_,p)||(this.hitDetectionImageData_=null,this.renderedExtent_=p),this.renderedCenter_=x,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const w=new L2(Xx(h,d),m,h,d);let C;for(let $=0,K=y.length;$<K;++$)i.loadFeatures(y[$],h,c);const R=Vm(h,d);let T=!0;const I=($,K)=>{let B;const H=$.getStyleFunction()||n.getStyleFunction();if(H&&(B=H($,h)),B){const L=this.renderFeature($,R,B,w,C,this.getLayer().getDeclutter(),K);T=T&&!L}},A=q0(m),j=i.getFeaturesInExtent(A);_&&j.sort(_);for(let $=0,K=j.length;$<K;++$)I(j[$],$);this.renderedFeatures_=j,this.ready=T;const b=w.finish(),F=new O2(m,h,d,i.getOverlaps(),b,n.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=h,this.renderedRevision_=g,this.renderedRenderOrder_=_,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=p,this.wrappedRenderedExtent_=m,this.renderedCenter_=x,this.renderedProjection_=c,this.renderedPixelRatio_=d,this.replayGroup_=F,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,n,i,r,s,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let u=0,c=i.length;u<c;++u)l=Ym(r,e,i[u],n,this.boundHandleStyleImageChange_,s,o,a)||l;else l=Ym(r,e,i,n,this.boundHandleStyleImageChange_,s,o,a);return l}}class Xc extends zu{constructor(e){super(e)}createRenderer(){return new J2(this)}}function Yx(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function _d(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}const Vl=34962,sg=34963,Q2=35044,Vc=35048,eP=5121,tP=5123,nP=5125,Hx=5126,Hm=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function iP(t,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!mS},e);const n=Hm.length;for(let i=0;i<n;++i)try{const r=t.getContext(Hm[i],e);if(r)return r}catch{}return null}const rP={STATIC_DRAW:Q2};class Yc{constructor(e,n){this.array_=null,this.type_=e,te(e===Vl||e===sg,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=n!==void 0?n:rP.STATIC_DRAW}ofSize(e){return this.array_=new(Ba(this.type_))(e),this}fromArray(e){return this.array_=Ba(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(Ba(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const n=Ba(this.type_);if(!(e instanceof n))throw new Error(`Expected ${n}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function Ba(t){switch(t){case Vl:return Float32Array;case sg:return Uint32Array;default:return Float32Array}}const Ga={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},sP=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,oP=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class Km{constructor(e){this.gl_=e.webGlContext;const n=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=n.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=n.createFramebuffer(),this.depthBuffer_=n.createRenderbuffer();const i=n.createShader(n.VERTEX_SHADER);n.shaderSource(i,e.vertexShader||sP),n.compileShader(i);const r=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(r,e.fragmentShader||oP),n.compileShader(r),this.renderTargetProgram_=n.createProgram(),n.attachShader(this.renderTargetProgram_,i),n.attachShader(this.renderTargetProgram_,r),n.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=n.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];n.bindBuffer(n.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),n.bufferData(n.ARRAY_BUFFER,new Float32Array(s),n.STATIC_DRAW),this.renderTargetAttribLocation_=n.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(o=>{this.uniforms_.push({value:e.uniforms[o],location:n.getUniformLocation(this.renderTargetProgram_,o)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const n=this.getGL(),i=[n.drawingBufferWidth*this.scaleRatio_,n.drawingBufferHeight*this.scaleRatio_];if(n.bindFramebuffer(n.FRAMEBUFFER,this.getFrameBuffer()),n.bindRenderbuffer(n.RENDERBUFFER,this.getDepthBuffer()),n.viewport(0,0,i[0],i[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==i[0]||this.renderTargetTextureSize_[1]!==i[1]){this.renderTargetTextureSize_=i;const r=0,s=n.RGBA,o=0,a=n.RGBA,l=n.UNSIGNED_BYTE,u=null;n.bindTexture(n.TEXTURE_2D,this.renderTargetTexture_),n.texImage2D(n.TEXTURE_2D,r,s,i[0],i[1],o,a,l,u),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.renderTargetTexture_,0),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,i[0],i[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer_)}}apply(e,n,i,r){const s=this.getGL(),o=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,n?n.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!n){const l=X(s.canvas);if(!e.renderTargets[l]){const u=s.getContextAttributes();u&&u.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),i&&i(s,e),s.drawArrays(s.TRIANGLES,0,6),r&&r(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const n=this.getGL();let i,r=1;this.uniforms_.forEach(function(s){if(i=typeof s.value=="function"?s.value(e):s.value,i instanceof HTMLCanvasElement||i instanceof ImageData)s.texture||(s.texture=n.createTexture()),n.activeTexture(n[`TEXTURE${r}`]),n.bindTexture(n.TEXTURE_2D,s.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),i instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,i.width,i.height,0,n.UNSIGNED_BYTE,new Uint8Array(i.data)):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i),n.uniform1i(s.location,r++);else if(Array.isArray(i))switch(i.length){case 2:n.uniform2f(s.location,i[0],i[1]);return;case 3:n.uniform3f(s.location,i[0],i[1],i[2]);return;case 4:n.uniform4f(s.location,i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&n.uniform1f(s.location,i)})}}const Pn={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},Xe={UNSIGNED_BYTE:eP,UNSIGNED_SHORT:tP,UNSIGNED_INT:nP,FLOAT:Hx},Yl={};function Zm(t){return"shared/"+t}let qm=0;function aP(){const t="unique/"+qm;return qm+=1,t}function lP(t){let e=Yl[t];if(!e){const n=document.createElement("canvas");n.width=1,n.height=1,n.style.position="absolute",n.style.left="0",e={users:0,context:iP(n)},Yl[t]=e}return e.users+=1,e.context}function uP(t){const e=Yl[t];if(!e||(e.users-=1,e.users>0))return;const n=e.context,i=n.getExtension("WEBGL_lose_context");i&&i.loseContext();const r=n.canvas;r.width=1,r.height=1,delete Yl[t]}class cP extends ta{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?Zm(e.canvasCacheKey):aP(),this.gl_=lP(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const n=this.gl_.canvas;n.addEventListener(Ga.LOST,this.boundHandleWebGLContextLost_),n.addEventListener(Ga.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=be(),this.offsetScaleMatrix_=be(),this.tmpMat4_=Yx(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(i=>new Km({webGlContext:this.gl_,scaleRatio:i.scaleRatio,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,uniforms:i.uniforms})):[new Km({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const n in e)this.uniforms_.push({name:n,value:e[n]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===Zm(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const n=this.gl_.getExtension(e);return this.extensionCache_[e]=n,n}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return te(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const n=this.gl_,i=X(e);let r=this.bufferCache_[i];if(!r){const s=n.createBuffer();r={buffer:e,webGlBuffer:s},this.bufferCache_[i]=r}n.bindBuffer(e.getType(),r.webGlBuffer)}flushBufferData(e){const n=this.gl_;this.bindBuffer(e),n.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const n=X(e);delete this.bufferCache_[n]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(Ga.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(Ga.RESTORED,this.boundHandleWebGLContextRestored_),uP(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,n,i){const r=this.gl_,s=this.getCanvas(),o=e.size,a=e.pixelRatio;(s.width!==o[0]*a||s.height!==o[1]*a)&&(s.width=o[0]*a,s.height=o[1]*a,s.style.width=o[0]+"px",s.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.depthRange(0,1),r.clearDepth(1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,n?r.ZERO:r.ONE_MINUS_SRC_ALPHA),i?(r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL)):r.disable(r.DEPTH_TEST)}bindFrameBuffer(e,n){const i=this.getGL();i.bindFramebuffer(i.FRAMEBUFFER,e),n&&i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,n,0)}bindInitialFrameBuffer(){const e=this.getGL(),n=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,n);const i=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0)}bindTexture(e,n,i){const r=this.gl_;r.activeTexture(r.TEXTURE0+n),r.bindTexture(r.TEXTURE_2D,e),r.uniform1i(this.getUniformLocation(i),n)}bindAttribute(e,n,i){const r=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(n);r.enableVertexAttribArray(s),r.vertexAttribPointer(s,i,r.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,n,i,r){const s=this.gl_,o=n.getSize();s.bindFramebuffer(s.FRAMEBUFFER,n.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,n.getDepthbuffer()),s.viewport(0,0,o[0],o[1]),s.bindTexture(s.TEXTURE_2D,n.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,i?s.ZERO:s.ONE_MINUS_SRC_ALPHA),r?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,n){const i=this.gl_;this.getExtension("OES_element_index_uint");const r=i.UNSIGNED_INT,s=4,o=n-e,a=e*s;i.drawElements(i.TRIANGLES,o,r,a)}drawElementsInstanced(e,n,i){const r=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),o=r.UNSIGNED_INT,a=4,l=n-e,u=e*a;s.drawElementsInstancedANGLE(r.TRIANGLES,l,o,u,i);for(let c=0;c<this.maxAttributeCount_;c++)s.vertexAttribDivisorANGLE(c,0)}finalizeDraw(e,n,i){for(let r=0,s=this.postProcessPasses_.length;r<s;r++)r===s-1?this.postProcessPasses_[r].apply(e,null,n,i):this.postProcessPasses_[r].apply(e,this.postProcessPasses_[r+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const n=e.size,i=e.viewState.rotation,r=e.pixelRatio;this.setUniformFloatValue(Pn.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Pn.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Pn.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(Pn.PIXEL_RATIO,r),this.setUniformFloatVec2(Pn.VIEWPORT_SIZE_PX,[n[0],n[1]]),this.setUniformFloatValue(Pn.ROTATION,i)}applyHitDetectionUniform(e){const n=this.getUniformLocation(Pn.HIT_DETECTION);this.getGL().uniform1i(n,e?1:0),e&&this.setUniformFloatValue(Pn.PIXEL_RATIO,.5)}applyUniforms(e){const n=this.gl_;let i,r=0;this.uniforms_.forEach(s=>{if(i=typeof s.value=="function"?s.value(e):s.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData||i instanceof WebGLTexture){i instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=i):s.texture||(s.prevValue=void 0,s.texture=n.createTexture()),this.bindTexture(s.texture,r,s.name),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);const o=!(i instanceof HTMLImageElement)||i.complete;!(i instanceof WebGLTexture)&&o&&s.prevValue!==i&&(s.prevValue=i,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i)),r++}else if(Array.isArray(i)&&i.length===6)this.setUniformMatrixValue(s.name,_d(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:n.uniform2f(this.getUniformLocation(s.name),i[0],i[1]);return;case 3:n.uniform3f(this.getUniformLocation(s.name),i[0],i[1],i[2]);return;case 4:n.uniform4f(this.getUniformLocation(s.name),i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&n.uniform1f(this.getUniformLocation(s.name),i)})}useProgram(e,n){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,n&&(this.applyFrameState(n),this.applyUniforms(n))}compileShader(e,n){const i=this.gl_,r=i.createShader(n);return i.shaderSource(r,e),i.compileShader(r),r}getProgram(e,n){const i=this.gl_,r=this.compileShader(e,i.FRAGMENT_SHADER),s=this.compileShader(n,i.VERTEX_SHADER),o=i.createProgram();if(i.attachShader(o,r),i.attachShader(o,s),i.linkProgram(o),!i.getShaderParameter(r,i.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${i.getShaderInfoLog(r)}`;throw new Error(a)}if(i.deleteShader(r),!i.getShaderParameter(s,i.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${i.getShaderInfoLog(s)}`;throw new Error(a)}if(i.deleteShader(s),!i.getProgramParameter(o,i.LINK_STATUS)){const a=`GL program linking failed: ${i.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(e){const n=X(this.currentProgram_);return this.uniformLocationsByProgram_[n]===void 0&&(this.uniformLocationsByProgram_[n]={}),this.uniformLocationsByProgram_[n][e]===void 0&&(this.uniformLocationsByProgram_[n][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[n][e]}getAttributeLocation(e){const n=X(this.currentProgram_);return this.attribLocationsByProgram_[n]===void 0&&(this.attribLocationsByProgram_[n]={}),this.attribLocationsByProgram_[n][e]===void 0&&(this.attribLocationsByProgram_[n][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[n][e]}makeProjectionTransform(e,n){const i=e.size,r=e.viewState.rotation,s=e.viewState.resolution,o=e.viewState.center;return tn(n,0,0,2/(s*i[0]),2/(s*i[1]),-r,-o[0],-o[1]),n}setUniformFloatValue(e,n){this.gl_.uniform1f(this.getUniformLocation(e),n)}setUniformFloatVec2(e,n){this.gl_.uniform2fv(this.getUniformLocation(e),n)}setUniformFloatVec4(e,n){this.gl_.uniform4fv(this.getUniformLocation(e),n)}setUniformMatrixValue(e,n){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,n)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,n,i,r,s,o){const a=this.getAttributeLocation(e);a<0||(this.gl_.enableVertexAttribArray(a),this.gl_.vertexAttribPointer(a,n,i,!1,r,s),o&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(a,1))}enableAttributes_(e,n){const i=hP(e);let r=0;for(let s=0;s<e.length;s++){const o=e[s];o.name&&this.enableAttributeArray_(o.name,o.size,o.type||Hx,i,r,n),r+=o.size*Kx(o.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){Is(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,n,i,r){const s=this.gl_;i=i||s.createTexture();const o=r?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,i),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const a=0,l=s.RGBA,u=0,c=s.RGBA,h=s.UNSIGNED_BYTE;return n instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],u,c,h,n):n?s.texImage2D(s.TEXTURE_2D,a,l,c,h,n):s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],u,c,h,null),i}}function hP(t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];e+=i.size*Kx(i.type)}return e}function Kx(t){switch(t){case Xe.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Xe.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Xe.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Xe.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class og extends Fx{constructor(e,n){super(e),n=n||{},this.inversePixelTransform_=be(),this.postProcesses_=n.postProcesses,this.uniforms_=n.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(oe.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,n){const i=this.getLayer();if(i.hasListener(Ge.PRECOMPOSE)){const r=new _o(Ge.PRECOMPOSE,void 0,n,e);i.dispatchEvent(r)}}dispatchPostComposeEvent(e,n){const i=this.getLayer();if(i.hasListener(Ge.POSTCOMPOSE)){const r=new _o(Ge.POSTCOMPOSE,void 0,n,e);i.dispatchEvent(r)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let n=!0,i=-1,r;for(let o=0,a=e.layerStatesArray.length;o<a;o++){const l=e.layerStatesArray[o].layer,u=l.getRenderer();if(!(u instanceof og)){n=!0;continue}const c=l.getClassName();if((n||c!==r)&&(i+=1,n=!1),r=c,u===this)break}const s="map/"+e.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new cP({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),r&&(this.helper.getCanvas().className=r),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){var e;this.clearCache(),this.removeHelper(),(e=this.getLayer())==null||e.removeChangeListener(oe.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,n,i){const r=this.getLayer();if(r.hasListener(e)){tn(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);const s=new _o(e,this.inversePixelTransform_,i,n);r.dispatchEvent(s)}}preRender(e,n){this.dispatchRenderEvent_(Ge.PRERENDER,e,n)}postRender(e,n){this.dispatchRenderEvent_(Ge.POSTRENDER,e,n)}}const Hc={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};class dP{constructor(e,n){this.name=e,this.data=n,this.texture_=null}getTexture(e){if(!this.texture_){const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=n}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function fP(t,e){return`operator_${t}_${Object.keys(e.functions).length}`}function Si(t){const e=t.toString();return e.includes(".")?e:e+".0"}function ag(t){if(t.length<2||t.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${t.length}(${t.map(Si).join(", ")})`}function sl(t){const e=nn(t),n=e.length>3?e[3]:1;return ag([e[0]/255,e[1]/255,e[2]/255,n])}function gP(t){const e=st(t);return ag(e)}const Kc={};let pP=0;function Ko(t){return t in Kc||(Kc[t]=pP++),Kc[t]}function kn(t){return Si(Ko(t))}function lg(t){return"u_var_"+t}function Zx(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const Zc="getBandValue",mP="u_paletteTextures",qx="featureId",Jx="geometryType",yd=-9999999;function _P(t,e,n,i){const r=Ue(t,e,n);return ug(r,e,i)}function ie(t){return(e,n,i)=>{const r=n.args.length,s=new Array(r);for(let o=0;o<r;++o)s[o]=ug(n.args[o],i,e);return t(s,e)}}const yP={[S.Get]:(t,e)=>{const i=e.args[0].value;i in t.properties||(t.properties[i]={name:i,type:e.type});let s="a_prop_"+i;return hn(e.type,Ae)&&(s=`(${s} > 0.0)`),s},[S.Id]:t=>(t.featureId=!0,"a_"+qx),[S.GeometryType]:t=>(t.geometryType=!0,"a_"+Jx),[S.LineMetric]:()=>"currentLineMetric",[S.Var]:(t,e)=>{const i=e.args[0].value;i in t.variables||(t.variables[i]={name:i,type:e.type});let s=lg(i);return hn(e.type,Ae)&&(s=`(${s} > 0.0)`),s},[S.Has]:(t,e)=>{const i=e.args[0].value;return i in t.properties||(t.properties[i]={name:i,type:e.type}),`(a_prop_${i} != ${Si(yd)})`},[S.Resolution]:()=>"u_resolution",[S.Zoom]:()=>"u_zoom",[S.Time]:()=>"u_time",[S.Any]:ie(t=>`(${t.join(" || ")})`),[S.All]:ie(t=>`(${t.join(" && ")})`),[S.Not]:ie(([t])=>`(!${t})`),[S.Equal]:ie(([t,e])=>`(${t} == ${e})`),[S.NotEqual]:ie(([t,e])=>`(${t} != ${e})`),[S.GreaterThan]:ie(([t,e])=>`(${t} > ${e})`),[S.GreaterThanOrEqualTo]:ie(([t,e])=>`(${t} >= ${e})`),[S.LessThan]:ie(([t,e])=>`(${t} < ${e})`),[S.LessThanOrEqualTo]:ie(([t,e])=>`(${t} <= ${e})`),[S.Multiply]:ie(t=>`(${t.join(" * ")})`),[S.Divide]:ie(([t,e])=>`(${t} / ${e})`),[S.Add]:ie(t=>`(${t.join(" + ")})`),[S.Subtract]:ie(([t,e])=>`(${t} - ${e})`),[S.Clamp]:ie(([t,e,n])=>`clamp(${t}, ${e}, ${n})`),[S.Mod]:ie(([t,e])=>`mod(${t}, ${e})`),[S.Pow]:ie(([t,e])=>`pow(${t}, ${e})`),[S.Abs]:ie(([t])=>`abs(${t})`),[S.Floor]:ie(([t])=>`floor(${t})`),[S.Ceil]:ie(([t])=>`ceil(${t})`),[S.Round]:ie(([t])=>`floor(${t} + 0.5)`),[S.Sin]:ie(([t])=>`sin(${t})`),[S.Cos]:ie(([t])=>`cos(${t})`),[S.Atan]:ie(([t,e])=>e!==void 0?`atan(${t}, ${e})`:`atan(${t})`),[S.Sqrt]:ie(([t])=>`sqrt(${t})`),[S.Match]:ie(t=>{const e=t[0],n=t[t.length-1];let i=null;for(let r=t.length-3;r>=1;r-=2){const s=t[r],o=t[r+1];i=`(${e} == ${s} ? ${o} : ${i||n})`}return i}),[S.Between]:ie(([t,e,n])=>`(${t} >= ${e} && ${t} <= ${n})`),[S.Interpolate]:ie(([t,e,...n])=>{let i="";for(let r=0;r<n.length-2;r+=2){const s=n[r],o=i||n[r+1],a=n[r+2],l=n[r+3];let u;t===Si(1)?u=`(${e} - ${s}) / (${a} - ${s})`:u=`(pow(${t}, (${e} - ${s})) - 1.0) / (pow(${t}, (${a} - ${s})) - 1.0)`,i=`mix(${o}, ${l}, clamp(${u}, 0.0, 1.0))`}return i}),[S.Case]:ie(t=>{const e=t[t.length-1];let n=null;for(let i=t.length-3;i>=0;i-=2){const r=t[i],s=t[i+1];n=`(${r} ? ${s} : ${n||e})`}return n}),[S.In]:ie(([t,...e],n)=>{const i=fP("in",n),r=[];for(let s=0;s<e.length;s+=1)r.push(`  if (inputValue == ${e[s]}) { return true; }`);return n.functions[i]=`bool ${i}(float inputValue) {
${r.join(`
`)}
  return false;
}`,`${i}(${t})`}),[S.Array]:ie(t=>`vec${t.length}(${t.join(", ")})`),[S.Color]:ie(t=>{if(t.length===1)return`vec4(vec3(${t[0]} / 255.0), 1.0)`;if(t.length===2)return`vec4(vec3(${t[0]} / 255.0), ${t[1]})`;const e=t.slice(0,3).map(i=>`${i} / 255.0`);if(t.length===3)return`vec4(${e.join(", ")}, 1.0)`;const n=t[3];return`vec4(${e.join(", ")}, ${n})`}),[S.Band]:ie(([t,e,n],i)=>{if(!(Zc in i.functions)){let r="";const s=i.bandCount||1;for(let o=0;o<s;o++){const a=Math.floor(o/4);let l=o%4;o===s-1&&l===1&&(l=3);const u=`${Hc.TILE_TEXTURE_ARRAY}[${a}]`;r+=`  if (band == ${o+1}.0) {
    return texture2D(${u}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}i.functions[Zc]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${Hc.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${Hc.TEXTURE_PIXEL_HEIGHT};
${r}
}`}return`${Zc}(${t}, ${e??"0.0"}, ${n??"0.0"})`}),[S.Palette]:(t,e)=>{const[n,...i]=e.args,r=i.length,s=new Uint8Array(r*4);for(let u=0;u<i.length;u++){const c=i[u].value,h=nn(c),d=u*4;s[d]=h[0],s[d+1]=h[1],s[d+2]=h[2],s[d+3]=h[3]*255}t.paletteTextures||(t.paletteTextures=[]);const o=`${mP}[${t.paletteTextures.length}]`,a=new dP(o,s);t.paletteTextures.push(a);const l=ug(n,z,t);return`texture2D(${o}, vec2((${l} + 0.5) / ${r}.0, 0.5))`}};function ug(t,e,n){if(t instanceof xx){const i=yP[t.operator];if(i===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(t.operator)}`);return i(n,t,e)}if((t.type&z)>0)return Si(t.value);if((t.type&Ae)>0)return t.value.toString();if((t.type&Fe)>0)return kn(t.value.toString());if((t.type&me)>0)return sl(t.value);if((t.type&yt)>0)return ag(t.value);if((t.type&$t)>0)return gP(t.value);throw new Error(`Unexpected expression ${t.value} (expected type ${Vr(e)})`)}function xP(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const Jm=.985;function Y(t,e,n){const i=qf();return _P(e,n,i,t)}function vP(t){const e=nn(t),n=e[0]*256,i=e[1],r=e[2]*256,s=Math.round(e[3]*255);return[n+i,r+s]}const EP=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function cg(t){return t===me||t===$t?2:t===yt?4:1}function xd(t){const e=cg(t);return e>1?`vec${e}`:"float"}function Qx(t,e){for(const n in e.variables){const i=e.variables[n],r=lg(i.name);let s=xd(i.type);i.type===me&&(s="vec4"),t.addUniform(r,s)}for(const n in e.properties){const i=e.properties[n],r=xd(i.type),s=`a_prop_${i.name}`;i.type===me?t.addAttribute(s,r,`unpackColor(${s})`,"vec4"):t.addAttribute(s,r)}for(const n in e.functions)t.addVertexShaderFunction(e.functions[n]),t.addFragmentShaderFunction(e.functions[n])}function ev(t,e){const n={};for(const i in t.variables){const r=t.variables[i],s=lg(r.name);n[s]=()=>{const o=e[r.name];if(typeof o=="number")return o;if(typeof o=="boolean")return o?1:0;if(r.type===me){const a=[...nn(o||"#eee")];return a[0]/=255,a[1]/=255,a[2]/=255,a[3]??(a[3]=1),a}return typeof o=="string"?Ko(o):o}}return n}function tv(t){const e={};for(const n in t.properties){const i=t.properties[n],r=s=>{const o=s.get(i.name);return i.type===me?vP([...nn(o||"#eee")]):typeof o=="string"?Ko(o):typeof o=="boolean"?o?1:0:o};e[`prop_${i.name}`]={size:cg(i.type),callback:r}}return e}const Tr=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${EP}
`,Rr=xP();class nv{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${Si(Rr["circle-radius"])} + ${Si(Rr["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=sl(Rr["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=Si(Rr["stroke-width"]),this.strokeColorExpression_=sl(Rr["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=kn("round"),this.strokeJoinExpression_=kn("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=sl(Rr["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,n){return this.uniforms_.push({name:e,type:n}),this}addAttribute(e,n,i,r){return this.attributes_.push({name:e,type:n,varyingName:e.replace(/^a_/,"v_"),varyingType:r??n,varyingExpression:i??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${Tr}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${Tr}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${Tr}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${Jm} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${Tr}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${Jm}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${kn("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${kn("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${kn("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${kn("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${Tr}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${Tr}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class Yr extends xn{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const n=e;this.setGeometry(n)}else{const n=e;this.setProperties(n)}}clone(){const e=new Yr(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const n=this.getGeometry();n&&e.setGeometry(n.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(ge(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=ee(e,J.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?wP(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function wP(t){if(typeof t=="function")return t;let e;return Array.isArray(t)?e=t:(te(typeof t.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}function SP(t,e,n,i){const r=[];let s=Tt();for(let o=0,a=n.length;o<a;++o){const l=n[o];s=Sf(t,e,l[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return r}function Qm(t,e,n,i,r,s,o){let a,l;const u=(n-e)/i;if(u===1)a=e;else if(u===2)a=e,l=r;else if(u!==0){let c=t[e],h=t[e+1],d=0;const g=[0];for(let x=e+i;x<n;x+=i){const m=t[x],p=t[x+1];d+=Math.sqrt((m-c)*(m-c)+(p-h)*(p-h)),g.push(d),c=m,h=p}const f=r*d,_=lS(g,f);_<0?(l=(f-g[-_-2])/(g[-_-1]-g[-_-2]),a=e+(-_-2)*i):a=e+_*i}o=o>1?o:2,s=s||new Array(o);for(let c=0;c<o;++c)s[c]=a===void 0?NaN:l===void 0?t[a+c]:Ot(t[a+c],t[a+i+c],l);return s}class hg extends Au{constructor(e,n,i){super(),i!==void 0&&n===void 0?this.setFlatCoordinates(i,e):(n=n||0,this.setCenterAndRadius(e,n,i))}clone(){const e=new hg(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,n,i,r){const s=this.flatCoordinates,o=e-s[0],a=n-s[1],l=o*o+a*a;if(l<r){if(l===0)for(let u=0;u<this.stride;++u)i[u]=s[u];else{const u=this.getRadius()/Math.sqrt(l);i[0]=s[0]+u*o,i[1]=s[1]+u*a;for(let c=2;c<this.stride;++c)i[c]=s[c]}return i.length=this.stride,l}return r}containsXY(e,n){const i=this.flatCoordinates,r=e-i[0],s=n-i[1];return r*r+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const n=this.flatCoordinates,i=n[this.stride]-n[0];return Gn(n[0]-i,n[1]-i,n[0]+i,n[1]+i,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],n=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+n*n}getType(){return"Circle"}intersectsExtent(e){const n=this.getExtent();if(it(e,n)){const i=this.getCenter();return e[0]<=i[0]&&e[2]>=i[0]||e[1]<=i[1]&&e[3]>=i[1]?!0:Cf(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const n=this.stride,i=this.flatCoordinates[n]-this.flatCoordinates[0],r=e.slice();r[n]=r[0]+i;for(let s=1;s<n;++s)r[n+s]=e[s];this.setFlatCoordinates(this.layout,r),this.changed()}setCenterAndRadius(e,n,i){this.setLayout(i,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const r=this.flatCoordinates;let s=ix(r,0,e,this.stride);r[s++]=r[0]+n;for(let o=1,a=this.stride;o<a;++o)r[s++]=r[o];r.length=s,this.changed()}getCoordinates(){return null}setCoordinates(e,n){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,n){const i=this.getCenter(),r=this.getStride();this.setCenter(Nf(i,0,i.length,r,e,n,i)),this.changed()}}const e_=be();class bt{constructor(e,n,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?b0(this.flatCoordinates_):Sf(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=ar(this.getExtent());this.flatInteriorPoints_=Of(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=ux(this.flatCoordinates_,this.ends_),n=SP(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=kC(this.flatCoordinates_,0,e,2,n)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Qm(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let n=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=Qm(e,n,o,2,.5);wf(this.flatMidpoints_,a),n=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,n){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=_t(e);const n=e.getExtent(),i=e.getWorldExtent();if(n&&i){const r=rt(i)/rt(n);tn(e_,i[0],i[3],r,-r,0,0,0),yn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,e_,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var e;return new bt(this.type_,this.flatCoordinates_.slice(),(e=this.ends_)==null?void 0:e.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=A0((e,n)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),n&&this.simplifiedGeometry_.applyTransform(n);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=Ff(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=IC(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=sx(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new bt(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}bt.prototype.getFlatCoordinates=bt.prototype.getOrientedFlatCoordinates;class Hl{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,n){for(let i=0;i<e.length;i++)this.addFeature(e[i],n)}addFeature(e,n){let i=e.getGeometry();i&&(n&&(i=i.clone(),i.applyTransform(n)),this.addGeometry_(i,e))}clearFeatureEntryInPointBatch_(e){const n=X(e),i=this.pointBatch.entries[n];if(i)return this.pointBatch.geometriesCount-=i.flatCoordss.length,delete this.pointBatch.entries[n],i}clearFeatureEntryInLineStringBatch_(e){const n=X(e),i=this.lineStringBatch.entries[n];if(i)return this.lineStringBatch.verticesCount-=i.verticesCount,this.lineStringBatch.geometriesCount-=i.flatCoordss.length,delete this.lineStringBatch.entries[n],i}clearFeatureEntryInPolygonBatch_(e){const n=X(e),i=this.polygonBatch.entries[n];if(i)return this.polygonBatch.verticesCount-=i.verticesCount,this.polygonBatch.ringsCount-=i.ringsCount,this.polygonBatch.geometriesCount-=i.flatCoordss.length,delete this.polygonBatch.entries[n],i}addGeometry_(e,n){var r;const i=e.getType();switch(i){case"GeometryCollection":{const s=e.getGeometriesArray();for(const o of s)this.addGeometry_(o,n);break}case"MultiPolygon":{const s=e;this.addCoordinates_(i,s.getFlatCoordinates(),s.getEndss(),n,X(n),s.getStride());break}case"MultiLineString":{const s=e;this.addCoordinates_(i,s.getFlatCoordinates(),s.getEnds(),n,X(n),s.getStride());break}case"MultiPoint":{const s=e;this.addCoordinates_(i,s.getFlatCoordinates(),null,n,X(n),s.getStride());break}case"Polygon":{const s=e;this.addCoordinates_(i,s.getFlatCoordinates(),s.getEnds(),n,X(n),s.getStride());break}case"Point":{const s=e;this.addCoordinates_(i,s.getFlatCoordinates(),null,n,X(n),s.getStride());break}case"LineString":case"LinearRing":{const s=e,o=s.getStride();this.addCoordinates_(i,s.getFlatCoordinates(),null,n,X(n),o,(r=s.getLayout)==null?void 0:r.call(s));break}}}addCoordinates_(e,n,i,r,s,o,a){let l;switch(e){case"MultiPolygon":{const u=i;for(let c=0,h=u.length;c<h;c++){let d=u[c];const g=c>0?u[c-1]:null,f=g?g[g.length-1]:0,_=d[d.length-1];d=f>0?d.map(x=>x-f):d,this.addCoordinates_("Polygon",n.slice(f,_),d,r,s,o,a)}break}case"MultiLineString":{const u=i;for(let c=0,h=u.length;c<h;c++){const d=c>0?u[c-1]:0;this.addCoordinates_("LineString",n.slice(d,u[c]),null,r,s,o,a)}break}case"MultiPoint":for(let u=0,c=n.length;u<c;u+=o)this.addCoordinates_("Point",n.slice(u,u+2),null,r,s,null,null);break;case"Polygon":{const u=i;if(r instanceof bt){const d=ux(n,u);if(d.length>1){this.addCoordinates_("MultiPolygon",n,d,r,s,o,a);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:r,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=n.length/o;const c=i.length,h=i.map((d,g,f)=>g>0?(d-f[g-1])/o:d/o);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=c,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(CP(n,o)),this.polygonBatch.entries[s].ringsVerticesCounts.push(h),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=c;for(let d=0,g=u.length;d<g;d++){const f=d>0?u[d-1]:0;this.addCoordinates_("LinearRing",n.slice(f,u[d]),null,r,s,o,a)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:r,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(n);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:r,flatCoordss:[],verticesCount:0})),l=n.length/o,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(TP(n,o,a)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,n){const i=this.uidToRef_.get(e),r=i||this.freeGlobalRef_.pop()||++this.globalCounter_;return n.ref=r,i||(this.refToFeature_.set(r,n.feature),this.uidToRef_.set(e,r)),n}removeRef_(e,n){if(!e)throw new Error("This feature has no ref: "+n);this.refToFeature_.delete(e),this.uidToRef_.delete(n),this.freeGlobalRef_.push(e)}changeFeature(e,n){if(!this.uidToRef_.get(X(e)))return;this.removeFeature(e);let i=e.getGeometry();i&&(n&&(i=i.clone(),i.applyTransform(n)),this.addGeometry_(i,e))}removeFeature(e){let n=this.clearFeatureEntryInPointBatch_(e);n=this.clearFeatureEntryInPolygonBatch_(e)||n,n=this.clearFeatureEntryInLineStringBatch_(e)||n,n&&this.removeRef_(n.ref,X(n.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const n=new Hl;n.globalCounter_=this.globalCounter_,n.uidToRef_=this.uidToRef_,n.refToFeature_=this.refToFeature_;let i=!0;for(const r of this.refToFeature_.values())e(r)&&(n.addFeature(r),i=!1);return i?new Hl:n}}function CP(t,e){return e===2?t:t.filter((n,i)=>i%e<2)}function TP(t,e,n){return e===3&&n==="XYM"?t:e===4?t.filter((i,r)=>r%e!==2):e===3?t.map((i,r)=>r%e!==2?i:0):new Array(t.length*1.5).fill(0).map((i,r)=>r%3===2?0:t[Math.round(r/1.5)])}function RP(){const t='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(t,"binary").toString("base64"):URL.createObjectURL(new Blob([t],{type:"application/javascript"})))}const qc={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function PP(t,e){e=e||[];const n=256,i=n-1,r=Math.floor(t/n/n/n)/i,s=Math.floor(t/n/n)%n/i,o=Math.floor(t/n)%n/i,a=t%n/i;return e[0]=r*256*255+s*255,e[1]=o*256*255+a*255,e}function IP(t){let e=0;const n=256,i=n-1;return e+=Math.round(t[0]*n*n*n*i),e+=Math.round(t[1]*n*n*i),e+=Math.round(t[2]*n*i),e+=Math.round(t[3]*i),e}function dg(t,e,n,i){let r=0;for(const s in e){const o=e[s],a=o.callback.call(n,n.feature);let l=(a==null?void 0:a[0])??a;l===yd&&console.warn('The "has" operator might return false positives.'),l===void 0?l=yd:l===null&&(l=0),t[i+r++]=l,!(!o.size||o.size===1)&&(t[i+r++]=a[1],!(o.size<3)&&(t[i+r++]=a[2],!(o.size<4)&&(t[i+r++]=a[3])))}return r}function $u(t){return Object.keys(t).reduce((e,n)=>e+(t[n].size||1),0)}function LP(t,e,n,i){const r=(2+$u(n))*t.geometriesCount;(!e||e.length!==r)&&(e=new Float32Array(r));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let u=0,c=l.flatCoordss.length;u<c;u++)s[0]=l.flatCoordss[u][0],s[1]=l.flatCoordss[u][1],Pe(i,s),e[o++]=s[0],e[o++]=s[1],o+=dg(e,n,l,o)}return e}function AP(t,e,n,i){const r=3*t.verticesCount+(1+$u(n))*t.geometriesCount;(!e||e.length!==r)&&(e=new Float32Array(r));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let u=0,c=l.flatCoordss.length;u<c;u++){s.length=l.flatCoordss[u].length,yn(l.flatCoordss[u],0,s.length,3,i,s,3),o+=dg(e,n,l,o),e[o++]=s.length/3;for(let h=0,d=s.length;h<d;h+=3)e[o++]=s[h],e[o++]=s[h+1],e[o++]=s[h+2]}}return e}function kP(t,e,n,i){const r=2*t.verticesCount+(1+$u(n))*t.geometriesCount+t.ringsCount;(!e||e.length!==r)&&(e=new Float32Array(r));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let u=0,c=l.flatCoordss.length;u<c;u++){s.length=l.flatCoordss[u].length,yn(l.flatCoordss[u],0,s.length,2,i,s),o+=dg(e,n,l,o),e[o++]=l.ringsVerticesCounts[u].length;for(let h=0,d=l.ringsVerticesCounts[u].length;h<d;h++)e[o++]=l.ringsVerticesCounts[u][h];for(let h=0,d=s.length;h<d;h+=2)e[o++]=s[h],e[o++]=s[h+1]}}return e}function Kl(t){return(JSON.stringify(t).split("").reduce((n,i)=>(n<<5)-n+i.charCodeAt(0),0)>>>0).toString()}function fg(t,e,n,i){if(`${i}radius`in t&&i!=="icon-"){let r=Y(n,t[`${i}radius`],z);if(`${i}radius2`in t){const s=Y(n,t[`${i}radius2`],z);r=`max(${r}, ${s})`}`${i}stroke-width`in t&&(r=`(${r} + ${Y(n,t[`${i}stroke-width`],z)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${r} * 2. + 0.5)`)}if(`${i}scale`in t){const r=Y(n,t[`${i}scale`],$t);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${r}`)}`${i}displacement`in t&&e.setSymbolOffsetExpression(Y(n,t[`${i}displacement`],yt)),`${i}rotation`in t&&e.setSymbolRotationExpression(Y(n,t[`${i}rotation`],z)),`${i}rotate-with-view`in t&&e.setSymbolRotateWithView(!!t[`${i}rotate-with-view`])}function iv(t,e,n,i,r){let s="vec4(0.)";if(e!==null&&(s=e),n!==null&&i!==null){const l=`smoothstep(-${i} + 0.63, -${i} - 0.58, ${t})`;s=`mix(${n}, ${s}, ${l})`}const o=`(1.0 - smoothstep(-0.63, 0.58, ${t}))`;let a=`${s} * vec4(1.0, 1.0, 1.0, ${o})`;return r!==null&&(a=`${a} * vec4(1.0, 1.0, 1.0, ${r})`),a}function gg(t,e,n,i,r){const s=new Image;s.crossOrigin=t[`${i}cross-origin`]===void 0?"anonymous":t[`${i}cross-origin`],te(typeof t[`${i}src`]=="string",`WebGL layers do not support expressions for the ${i}src style property`),s.src=t[`${i}src`],n[`u_texture${r}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${r}_size`,"vec2");const o=`u_texture${r}_size`;return n[`u_texture${r}`]=s,e.addUniform(`u_texture${r}`,"sampler2D"),o}function pg(t,e,n,i,r){let s=Y(n,t[`${e}offset`],$t);if(`${e}offset-origin`in t)switch(t[`${e}offset-origin`]){case"top-right":s=`vec2(${i}.x, 0.) + ${r} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${i}.y) + ${r} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${i} - ${r} - ${s}`;break}return s}function MP(t,e,n,i){i.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,fg(t,e,i,"circle-");let r=null;"circle-opacity"in t&&(r=Y(i,t["circle-opacity"],z));let s="coordsPx";"circle-scale"in t&&(s=`coordsPx / ${Y(i,t["circle-scale"],$t)}`);let o=null;"circle-fill-color"in t&&(o=Y(i,t["circle-fill-color"],me));let a=null;"circle-stroke-color"in t&&(a=Y(i,t["circle-stroke-color"],me));let l=Y(i,t["circle-radius"],z),u=null;"circle-stroke-width"in t&&(u=Y(i,t["circle-stroke-width"],z),l=`(${l} + ${u} * 0.5)`);const c=`circleDistanceField(${s}, ${l})`,h=iv(c,o,a,u,r);e.setSymbolColorExpression(h)}function DP(t,e,n,i){i.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,i.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,i.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,fg(t,e,i,"shape-");let r=null;"shape-opacity"in t&&(r=Y(i,t["shape-opacity"],z));let s="coordsPx";"shape-scale"in t&&(s=`coordsPx / ${Y(i,t["shape-scale"],$t)}`);let o=null;"shape-fill-color"in t&&(o=Y(i,t["shape-fill-color"],me));let a=null;"shape-stroke-color"in t&&(a=Y(i,t["shape-stroke-color"],me));let l=null;"shape-stroke-width"in t&&(l=Y(i,t["shape-stroke-width"],z));const u=Y(i,t["shape-points"],z);let c="0.";"shape-angle"in t&&(c=Y(i,t["shape-angle"],z));let h,d=Y(i,t["shape-radius"],z);if(l!==null&&(d=`${d} + ${l} * 0.5`),"shape-radius2"in t){let f=Y(i,t["shape-radius2"],z);l!==null&&(f=`${f} + ${l} * 0.5`),h=`starDistanceField(${s}, ${u}, ${d}, ${f}, ${c})`}else h=`regularDistanceField(${s}, ${u}, ${d}, ${c})`;const g=iv(h,o,a,l,r);e.setSymbolColorExpression(g)}function NP(t,e,n,i){let r="vec4(1.0)";"icon-color"in t&&(r=Y(i,t["icon-color"],me)),"icon-opacity"in t&&(r=`${r} * vec4(1.0, 1.0, 1.0, ${Y(i,t["icon-opacity"],z)})`);const s=Kl(t["icon-src"]),o=gg(t,e,n,"icon-",s);if(e.setSymbolColorExpression(`${r} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(o),"icon-width"in t&&"icon-height"in t&&e.setSymbolSizeExpression(`vec2(${Y(i,t["icon-width"],z)}, ${Y(i,t["icon-height"],z)})`),"icon-offset"in t&&"icon-size"in t){const a=Y(i,t["icon-size"],yt),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(a);const u=pg(t,"icon-",i,"v_quadSizePx",a);e.setTextureCoordinateExpression(`(vec4((${u}).xyxy) + vec4(0., 0., ${a})) / (${l}).xyxy`)}if(fg(t,e,i,"icon-"),"icon-anchor"in t){const a=Y(i,t["icon-anchor"],yt);let l="1.0";"icon-scale"in t&&(l=Y(i,t["icon-scale"],$t));let u;t["icon-anchor-x-units"]==="pixels"&&t["icon-anchor-y-units"]==="pixels"?u=`${a} * ${l}`:t["icon-anchor-x-units"]==="pixels"?u=`${a} * vec2(vec2(${l}).x, v_quadSizePx.y)`:t["icon-anchor-y-units"]==="pixels"?u=`${a} * vec2(v_quadSizePx.x, vec2(${l}).x)`:u=`${a} * v_quadSizePx`;let c=`v_quadSizePx * vec2(0.5, -0.5) + ${u} * vec2(-1., 1.)`;if("icon-anchor-origin"in t)switch(t["icon-anchor-origin"]){case"top-right":c=`v_quadSizePx * -0.5 + ${u}`;break;case"bottom-left":c=`v_quadSizePx * 0.5 - ${u}`;break;case"bottom-right":c=`v_quadSizePx * vec2(-0.5, 0.5) + ${u} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${c}`)}}function FP(t,e,n,i){if("stroke-color"in t&&e.setStrokeColorExpression(Y(i,t["stroke-color"],me)),"stroke-pattern-src"in t){const r=Kl(t["stroke-pattern-src"]),s=gg(t,e,n,"stroke-pattern-",r);let o=s,a="vec2(0.)";"stroke-pattern-offset"in t&&"stroke-pattern-size"in t&&(o=Y(i,t["stroke-pattern-size"],yt),a=pg(t,"stroke-pattern-",i,s,o));let l="0.";"stroke-pattern-spacing"in t&&(l=Y(i,t["stroke-pattern-spacing"],z));let u="0.";"stroke-pattern-start-offset"in t&&(u=Y(i,t["stroke-pattern-start-offset"],z)),i.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const c=`u_texture${r}`;let h="1.";"stroke-color"in t&&(h=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${h} * sampleStrokePattern(${c}, ${s}, ${a}, ${o}, ${l}, ${u}, currentLengthPx, currentRadiusRatio, v_width)`),i.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${o}, ${l}, v_width)`)}if("stroke-width"in t&&e.setStrokeWidthExpression(Y(i,t["stroke-width"],z)),"stroke-offset"in t&&e.setStrokeOffsetExpression(Y(i,t["stroke-offset"],z)),"stroke-line-cap"in t&&e.setStrokeCapExpression(Y(i,t["stroke-line-cap"],Fe)),"stroke-line-join"in t&&e.setStrokeJoinExpression(Y(i,t["stroke-line-join"],Fe)),"stroke-miter-limit"in t&&e.setStrokeMiterLimitExpression(Y(i,t["stroke-miter-limit"],z)),"stroke-line-dash"in t){i.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${kn("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${kn("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let r=t["stroke-line-dash"].map(f=>Y(i,f,z));r.length%2===1&&(r=[...r,...r]);let s="0.";"stroke-line-dash-offset"in t&&(s=Y(i,t["stroke-line-dash-offset"],z));const a=`dashDistanceField_${Kl(t["stroke-line-dash"])}`,l=r.map((f,_)=>`float dashLength${_}`).join(", "),u=r.map((f,_)=>`dashLength${_}`).join(" + ");let c="0.",h=`getSingleDashDistance(distance, radius, ${c}, dashLength0, totalDashLength, capType, lineWidth)`;for(let f=2;f<r.length;f+=2)c=`${c} + dashLength${f-2} + dashLength${f-1}`,h=`min(${h}, getSingleDashDistance(distance, radius, ${c}, dashLength${f}, totalDashLength, capType, lineWidth))`;i.functions[a]=`float ${a}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${u};
  return ${h};
}`;const d=r.map((f,_)=>`${f}`).join(", ");e.setStrokeDistanceFieldExpression(`${a}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${d})`);let g=r.join(" + ");e.getStrokePatternLengthExpression()&&(i.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,g=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${g})`),e.setStrokePatternLengthExpression(g)}}function OP(t,e,n,i){if("fill-color"in t&&e.setFillColorExpression(Y(i,t["fill-color"],me)),"fill-pattern-src"in t){const r=Kl(t["fill-pattern-src"]),s=gg(t,e,n,"fill-pattern-",r);let o=s,a="vec2(0.)";"fill-pattern-offset"in t&&"fill-pattern-size"in t&&(o=Y(i,t["fill-pattern-size"],yt),a=pg(t,"fill-pattern-",i,s,o)),i.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${r}`;let u="1.";"fill-color"in t&&(u=e.getFillColorExpression()),e.setFillColorExpression(`${u} * sampleFillPattern(${l}, ${s}, ${a}, ${o}, pxOrigin, pxPos)`)}}function t_(t,e,n){const i=Zx(),r=new nv,s={};if("icon-src"in t?NP(t,r,s,i):"shape-points"in t?DP(t,r,s,i):"circle-radius"in t&&MP(t,r,s,i),FP(t,r,s,i),OP(t,r,s,i),n){const l=Y(i,n,Ae);r.setFragmentDiscardExpression(`!${l}`)}const o={};function a(l,u,c,h){if(!i[l])return;const d=xd(c),g=cg(c);r.addAttribute(`a_${u}`,d),o[u]={size:g,callback:h}}return a("geometryType",Jx,Fe,l=>Ko(Jf(l.getGeometry()))),a("featureId",qx,Fe|z,l=>{const u=l.getId()??null;return typeof u=="string"?Ko(u):u}),Qx(r,i),{builder:r,attributes:{...o,...tv(i)},uniforms:{...s,...ev(i,e)}}}const bP=[];let Jc;function jP(){return Jc||(Jc=RP()),Jc}let zP=0;const Dt={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class $P{constructor(e,n,i,r){this.helper_,this.hitDetectionEnabled_=!!r,this.styleShaders=BP(e,n),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return PP(this.ref,bP)},size:2});for(const s of this.styleShaders){for(const o in s.attributes)o in this.customAttributes_||(this.customAttributes_[o]=s.attributes[o]);for(const o in s.uniforms)o in this.uniforms_||(this.uniforms_[o]=s.uniforms[o])}this.renderPasses_=this.styleShaders.map(s=>{const o={},a=Object.entries(this.customAttributes_).map(([l,u])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:u.size||1,type:Xe.FLOAT}));return s.builder.getFillVertexShader()&&(o.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:Dt.POSITION,size:2,type:Xe.FLOAT},...a],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(o.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:Dt.LOCAL_POSITION,size:2,type:Xe.FLOAT}],instancedAttributesDesc:[{name:Dt.SEGMENT_START,size:2,type:Xe.FLOAT},{name:Dt.MEASURE_START,size:1,type:Xe.FLOAT},{name:Dt.SEGMENT_END,size:2,type:Xe.FLOAT},{name:Dt.MEASURE_END,size:1,type:Xe.FLOAT},{name:Dt.JOIN_ANGLES,size:2,type:Xe.FLOAT},{name:Dt.DISTANCE_LOW,size:1,type:Xe.FLOAT},{name:Dt.DISTANCE_HIGH,size:1,type:Xe.FLOAT},{name:Dt.ANGLE_TANGENT_SUM,size:1,type:Xe.FLOAT},...a],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(o.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:Dt.LOCAL_POSITION,size:2,type:Xe.FLOAT}],instancedAttributesDesc:[{name:Dt.POSITION,size:2,type:Xe.FLOAT},...a],instancePrimitiveVertexCount:6}),o}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(i)}async generateBuffers(e,n){if(e.isEmpty())return null;const i=this.generateRenderInstructions_(e,n),[r,s,o]=await Promise.all([this.generateBuffersForType_(i.polygonInstructions,"Polygon",n),this.generateBuffersForType_(i.lineStringInstructions,"LineString",n),this.generateBuffersForType_(i.pointInstructions,"Point",n)]),a=$o(be(),n);return{polygonBuffers:r,lineStringBuffers:s,pointBuffers:o,invertVerticesTransform:a}}generateRenderInstructions_(e,n){const i=this.hasFill_?kP(e.polygonBatch,new Float32Array(0),this.customAttributes_,n):null,r=this.hasStroke_?AP(e.lineStringBatch,new Float32Array(0),this.customAttributes_,n):null,s=this.hasSymbol_?LP(e.pointBatch,new Float32Array(0),this.customAttributes_,n):null;return{polygonInstructions:i,lineStringInstructions:r,pointInstructions:s}}generateBuffersForType_(e,n,i){if(e===null)return null;const r=zP++;let s;switch(n){case"Polygon":s=qc.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=qc.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=qc.GENERATE_POINT_BUFFERS;break}const o={id:r,type:s,renderInstructions:e.buffer,renderInstructionsTransform:i,customAttributesSize:$u(this.customAttributes_)},a=jP();return a.postMessage(o,[e.buffer]),e=null,new Promise(l=>{const u=c=>{const h=c.data;if(h.id!==r||(a.removeEventListener("message",u),!this.helper_.getGL()))return;const d=new Yc(sg,Vc).fromArrayBuffer(h.indicesBuffer),g=new Yc(Vl,Vc).fromArrayBuffer(h.vertexAttributesBuffer),f=new Yc(Vl,Vc).fromArrayBuffer(h.instanceAttributesBuffer);this.helper_.flushBufferData(d),this.helper_.flushBufferData(g),this.helper_.flushBufferData(f),l([d,g,f])};a.addEventListener("message",u)})}render(e,n,i){for(const r of this.renderPasses_)r.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],r.fillRenderPass,n,i),r.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],r.strokeRenderPass,n,i),r.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],r.symbolRenderPass,n,i)}renderInternal_(e,n,i,r,s,o){const a=e.getSize();if(a===0)return;const l=r.instancedAttributesDesc.length;if(this.helper_.useProgram(r.program,s),this.helper_.bindBuffer(n),this.helper_.bindBuffer(e),this.helper_.enableAttributes(r.attributesDesc),this.helper_.bindBuffer(i),this.helper_.enableAttributesInstanced(r.instancedAttributesDesc),o(),l){const u=r.instancedAttributesDesc.reduce((h,d)=>h+(d.size||1),0),c=i.getSize()/u;this.helper_.drawElementsInstanced(0,a,c)}else this.helper_.drawElements(0,a)}setHelper(e,n=null){this.helper_=e;for(const i of this.renderPasses_)i.fillRenderPass&&(i.fillRenderPass.program=this.helper_.getProgram(i.fillRenderPass.fragmentShader,i.fillRenderPass.vertexShader)),i.strokeRenderPass&&(i.strokeRenderPass.program=this.helper_.getProgram(i.strokeRenderPass.fragmentShader,i.strokeRenderPass.vertexShader)),i.symbolRenderPass&&(i.symbolRenderPass.program=this.helper_.getProgram(i.symbolRenderPass.fragmentShader,i.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),n&&(n.polygonBuffers&&(this.helper_.flushBufferData(n.polygonBuffers[0]),this.helper_.flushBufferData(n.polygonBuffers[1]),this.helper_.flushBufferData(n.polygonBuffers[2])),n.lineStringBuffers&&(this.helper_.flushBufferData(n.lineStringBuffers[0]),this.helper_.flushBufferData(n.lineStringBuffers[1]),this.helper_.flushBufferData(n.lineStringBuffers[2])),n.pointBuffers&&(this.helper_.flushBufferData(n.pointBuffers[0]),this.helper_.flushBufferData(n.pointBuffers[1]),this.helper_.flushBufferData(n.pointBuffers[2])))}}function BP(t,e){const n=Array.isArray(t)?t:[t];if("style"in n[0]){const i=[],r=n,s=[];for(const o of r){const a=Array.isArray(o.style)?o.style:[o.style];let l=o.filter;o.else&&s.length&&(l=["all",...s.map(c=>["!",c])],o.filter&&l.push(o.filter),l.length<3&&(l=l[1])),o.filter&&s.push(o.filter);const u=a.map(c=>t_(c,e,l));i.push(...u)}return i}return"builder"in n[0]?n:n.map(i=>t_(i,e,null))}const Je={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"},un=new Uint8Array(4);class GP{constructor(e,n){this.helper_=e;const i=e.getGL();this.texture_=i.createTexture(),this.framebuffer_=i.createFramebuffer(),this.depthbuffer_=i.createRenderbuffer(),this.size_=n||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){Wn(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,n=this.helper_.getGL();n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_),n.readPixels(0,0,e[0],e[1],n.RGBA,n.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,n){if(e<0||n<0||e>this.size_[0]||n>=this.size_[1])return un[0]=0,un[1]=0,un[2]=0,un[3]=0,un;this.readAll();const i=Math.floor(e)+(this.size_[1]-Math.floor(n)-1)*this.size_[0];return un[0]=this.data_[i*4],un[1]=this.data_[i*4+1],un[2]=this.data_[i*4+2],un[3]=this.data_[i*4+3],un}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,n=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_),n.viewport(0,0,e[0],e[1]),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture_,0),n.bindRenderbuffer(n.RENDERBUFFER,this.depthbuffer_),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e[0],e[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function UP(t,e){const n=t.viewState.projection,r=e.getSource().getWrapX()&&n.canWrapX(),s=n.getExtent(),o=t.extent,a=r?ae(s):null,l=r?Math.ceil((o[2]-s[2])/a)+1:1;return[r?Math.floor((o[0]-s[0])/a):0,l,a]}const Pr={...Pn,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class WP extends og{constructor(e,n){const i={[Pr.RENDER_EXTENT]:[0,0,0,0],[Pr.PATTERN_ORIGIN]:[0,0],[Pr.GLOBAL_ALPHA]:1};super(e,{uniforms:i,postProcesses:n.postProcesses}),this.hitDetectionEnabled_=!n.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=Tt(),this.currentTransform_=be(),this.tmpCoords_=[0,0],this.tmpTransform_=be(),this.tmpMat4_=Yx(),this.currentFrameStateTransform_=be(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(n),this.batch_=new Hl,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const n=this.getLayer().getSource();let i;this.batch_.addFeatures(n.getFeatures(),i),this.sourceListenKeys_=[ee(n,Je.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,i)),ee(n,Je.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,i),this),ee(n,Je.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),ee(n,Je.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new $P(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new GP(this.helper))}handleSourceFeatureAdded_(e,n){const i=n.feature;this.batch_.addFeature(i,e)}handleSourceFeatureChanged_(e,n){const i=n.feature;this.batch_.changeFeature(i,e)}handleSourceFeatureDelete_(e){const n=e.feature;this.batch_.removeFeature(n)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){Q0(this.tmpTransform_,this.currentFrameStateTransform_),J0(this.tmpTransform_,e),this.helper.setUniformMatrixValue(Pr.PROJECTION_MATRIX,_d(this.tmpMat4_,this.tmpTransform_)),$o(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(Pr.SCREEN_TO_WORLD_MATRIX,_d(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,$o(this.tmpTransform_,e),Pe(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(Pr.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const n=this.helper.getGL();this.preRender(n,e);const[i,r,s]=UP(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,i,r,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const o=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,i,r,s),this.hitRenderTarget_.clearCachedData()),this.postRender(n,e),o}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const n=this.getLayer(),i=n.getSource(),r=e.viewState,s=!e.viewHints[Be.ANIMATING]&&!e.viewHints[Be.INTERACTING],o=!ms(this.previousExtent_,e.extent),a=this.sourceRevision_<i.getRevision();if(a&&(this.sourceRevision_=i.getRevision()),s&&(o||a)){const l=r.projection,u=r.resolution,c=n instanceof zu?n.getRenderBuffer():0,h=wu(e.extent,c*u);i.loadFeatures(h,u,l),this.ready=!1;const d=this.helper.makeProjectionTransform(e,be());this.styleRenderer_.generateBuffers(this.batch_,d).then(g=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=g,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,n,i,r,s){let o=i;n&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),fC(this.currentFrameStateTransform_,o*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(n)});while(++o<r)}forEachFeatureAtCoordinate(e,n,i,r,s){if(te(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const o=Pe(n.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],u=IP(l),c=this.batch_.getFeatureFromRef(u);if(c)return r(c,this.getLayer(),null)}disposeBuffers(e){const n=i=>{for(const r of i)r&&this.helper.deleteBuffer(r)};e.pointBuffers&&n(e.pointBuffers),e.lineStringBuffers&&n(e.lineStringBuffers),e.polygonBuffers&&n(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){ge(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const Tn={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},XP=["#00f","#0ff","#0f0","#ff0","#f00"];class VP extends zu{constructor(e){e=e||{};const n=Object.assign({},e);delete n.gradient,delete n.radius,delete n.blur,delete n.weight,super(n),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(Tn.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:XP),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const i=e.weight?e.weight:"weight";this.weight_=i,this.setRenderOrder(null)}getBlur(){return this.get(Tn.BLUR)}getGradient(){return this.get(Tn.GRADIENT)}getRadius(){return this.get(Tn.RADIUS)}handleGradientChanged_(){this.gradient_=YP(this.getGradient())}setBlur(e){const n=this.get(Tn.BLUR);if(this.set(Tn.BLUR,e),typeof e=="number"&&typeof n=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(Tn.GRADIENT,e)}setRadius(e){const n=this.get(Tn.RADIUS);if(this.set(Tn.RADIUS,e),typeof e=="number"&&typeof n=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new nv,n=Zx(),i=Y(n,this.filter_,Ae);let r=Y(n,this.getRadius(),z),s=Y(n,this.getBlur(),z);const o={};typeof this.getBlur()=="number"&&(s="a_blur",o.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(r="a_radius",o.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const a={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const h=typeof this.weight_=="string"?d=>d.get(this.weight_):this.weight_;a.prop_weight={size:1,callback:d=>{const g=h(d);return g!==void 0?_e(g,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const h=["clamp",this.weight_,0,1];l=Y(n,h,z)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${r};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${r} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${r} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${i}`),Qx(e,n);const u=tv(n),c=ev(n,this.styleVariables_);return new WP(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...u,...a},uniforms:{...c,...o}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function YP(t){const i=Me(1,256),r=i.createLinearGradient(0,0,1,256),s=1/(t.length-1);for(let o=0,a=t.length;o<a;++o)r.addColorStop(o*s,t[o]);return i.fillStyle=r,i.fillRect(0,0,1,256),i.canvas}let HP=!1;function KP(t,e,n,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof t=="function"?t(n,i,r):t,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=HP,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const u=e.getType();try{let c;u=="text"||u=="json"?c=a.responseText:u=="xml"?c=a.responseXML||a.responseText:u=="arraybuffer"&&(c=a.response),c?s(e.readFeatures(c,{extent:n,featureProjection:r}),e.readProjection(c)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function n_(t,e){return function(n,i,r,s,o){KP(t,e,n,i,r,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function ZP(t,e){return[[-1/0,-1/0,1/0,1/0]]}class i_{constructor(e){this.rbush_=new _x(e),this.items_={}}insert(e,n){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(i),this.items_[X(n)]=i}load(e,n){const i=new Array(n.length);for(let r=0,s=n.length;r<s;r++){const o=e[r],a=n[r],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=l,this.items_[X(a)]=l}this.rbush_.load(i)}remove(e){const n=X(e),i=this.items_[n];return delete this.items_[n],this.rbush_.remove(i)!==null}update(e,n){const i=this.items_[X(n)],r=[i.minX,i.minY,i.maxX,i.maxY];ms(r,e)||(this.remove(n),this.insert(e,n))}getAll(){return this.rbush_.all().map(function(n){return n.value})}getInExtent(e){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(n).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,n){return this.forEach_(this.getInExtent(e),n)}forEach_(e,n){let i;for(let r=0,s=e.length;r<s;r++)if(i=n(e[r]),i)return i;return i}isEmpty(){return gs(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const n=this.rbush_.toJSON();return Gn(n.minX,n.minY,n.maxX,n.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const n in e.items_)this.items_[n]=e.items_[n]}}class Jn extends Xn{constructor(e,n,i){super(e),this.feature=n,this.features=i}}class Ua extends $x{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=jo,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(te(this.format_,"`format` must be set when `url` is set"),this.loader_=n_(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:ZP;const n=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=n?new i_:null,this.loadedExtentsRtree_=new i_,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!n&&i===void 0&&(i=new zt(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const n=X(e);if(!this.addToIndex_(n,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(n,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[n]=e;this.dispatchEvent(new Jn(Je.ADDFEATURE,e))}setupChangeEvents_(e,n){n instanceof bt||(this.featureChangeKeys_[e]=[ee(n,J.CHANGE,this.handleFeatureChange_,this),ee(n,fs.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,n){let i=!0;if(n.getId()!==void 0){const r=String(n.getId());if(!(r in this.idIndex_))this.idIndex_[r]=n;else if(n instanceof bt){const s=this.idIndex_[r];s instanceof bt?Array.isArray(s)?s.push(n):this.idIndex_[r]=[s,n]:i=!1}else i=!1}return i&&(te(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=n),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const n=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],l=X(a);this.addToIndex_(l,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],l=X(a);this.setupChangeEvents_(l,a);const u=a.getGeometry();if(u){const c=u.getExtent();n.push(c),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(n,r),this.hasListener(Je.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Jn(Je.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let n=!1;this.addEventListener(Je.ADDFEATURE,function(i){n||(n=!0,e.push(i.feature),n=!1)}),this.addEventListener(Je.REMOVEFEATURE,function(i){n||(n=!0,e.remove(i.feature),n=!1)}),e.addEventListener(ct.ADD,i=>{n||(n=!0,this.addFeature(i.element),n=!1)}),e.addEventListener(ct.REMOVE,i=>{n||(n=!0,this.removeFeature(i.element),n=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(ge);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const n=new Jn(Je.CLEAR);this.dispatchEvent(n),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,n){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof bt||s.intersectsCoordinate(e))return n(r)})}forEachFeatureInExtent(e,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)}forEachFeatureIntersectingExtent(e,n){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof bt||r.intersectsExtent(e)){const s=n(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),gs(this.nullGeometryFeatures_)||wf(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const n=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){n.push(i)}),n}getFeaturesInExtent(e,n){if(this.featuresRtree_){if(!(n&&n.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=B0(e,n);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,n){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return n=n||bo,this.featuresRtree_.forEachInExtent(l,function(u){if(n(u)){const c=u.getGeometry(),h=a;if(a=c instanceof bt?0:c.closestPointXY(i,r,o,a),a<h){s=u;const d=Math.sqrt(a);l[0]=i-d,l[1]=r-d,l[2]=i+d,l[3]=r+d}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const n=this.idIndex_[e.toString()];return n!==void 0?n:null}getFeatureByUid(e){const n=this.uidIndex_[e];return n!==void 0?n:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const n=e.target,i=X(n),r=n.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[i]=n);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,n)):this.featuresRtree_&&this.featuresRtree_.update(o,n)}const s=n.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[o]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[i]=n;this.changed(),this.dispatchEvent(new Jn(Je.CHANGEFEATURE,n))}hasFeature(e){const n=e.getId();return n!==void 0?n in this.idIndex_:X(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&gs(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,n,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,n,i);for(let o=0,a=s.length;o<a;++o){const l=s[o];r.forEachInExtent(l,function(c){return Qs(c.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Jn(Je.FEATURESLOADSTART)),this.loader_.call(this,l,n,i,c=>{--this.loadingExtentsCount_,this.dispatchEvent(new Jn(Je.FEATURESLOADEND,void 0,c))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Jn(Je.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const n=this.loadedExtentsRtree_,i=n.forEachInExtent(e,function(r){if(ms(r.extent,e))return r});i&&n.remove(i)}removeFeatures(e){let n=!1;for(let i=0,r=e.length;i<r;++i)n=this.removeFeatureInternal(e[i])||n;n&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const n=X(e);if(!(n in this.uidIndex_))return!1;n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(e);const i=this.featureChangeKeys_[n];i==null||i.forEach(ge),delete this.featureChangeKeys_[n];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[n],this.hasListener(Je.REMOVEFEATURE)&&this.dispatchEvent(new Jn(Je.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const n in this.idIndex_)if(this.idIndex_[n]===e){delete this.idIndex_[n];break}}setLoader(e){this.loader_=e}setUrl(e){te(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(n_(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}function qP({events:t,selectedId:e,predictionPoints:n=[],showPredictions:i=!1,simRadiusKm:r,showHospitals:s=!1}){const o=P.useRef(null),a=P.useRef(null),l=P.useRef(null),u=P.useRef(null),c=P.useRef(null),h=P.useRef(null);P.useEffect(()=>{if(!o.current)return;const g=new Ua,f=new Xc({source:g,style:y=>{const v=y.get("id")===e;return new vs({radius:v?10:6,fill:new Ri({color:v?"rgba(255, 215, 0, 0.65)":"rgba(255,255,255,0.12)"}),stroke:new Es({color:v?"rgba(255, 215, 0, 0.9)":"rgba(255,255,255,0.25)",width:v?3:2})})}}),_=new Xc({source:new Ua}),x=new VP({source:new Ua,blur:12,radius:8}),m=new Xc({source:new Ua}),p=new bR({target:o.current,layers:[new i2({source:new w2}),f,x,m,_],view:new fn({center:Ma([0,0]),zoom:2})});return a.current=p,l.current=f,u.current=_,c.current=x,h.current=m,()=>{p.setTarget(void 0)}},[]),P.useEffect(()=>{const g=l.current;if(!g)return;const f=g.getSource();f&&(f.clear(),t.forEach(_=>{if(_.longitude==null||_.latitude==null)return;const x=new Yr({geometry:new is(Ma([_.longitude,_.latitude]))});x.set("id",_.id),x.set("source",_.source),f.addFeature(x)}))},[t]),P.useEffect(()=>{if(!e)return;const g=l.current,f=a.current,_=u.current;if(!g||!f)return;const x=g.getSource();if(!x)return;const p=x.getFeatures().find(w=>w.get("id")===e);if(!p)return;const v=p.getGeometry().getCoordinates();if(f.getView().animate({center:v,zoom:6,duration:600}),g.changed(),_){const w=_.getSource();w==null||w.clear();const C=String(p.get("source")||"").toLowerCase(),R=typeof r=="number"?r:d(C),T=new hg(v,R*1e3),I=new Yr(T);I.setStyle(new vs({radius:0,fill:new Ri({color:"rgba(255, 215, 0, 0.08)"}),stroke:new Es({color:"rgba(255, 215, 0, 0.6)",width:2})})),w==null||w.addFeature(I)}},[e]);function d(g){const f=String(g||"").toLowerCase();return f.includes("usgs")?120:f.includes("noaa")?60:f.includes("gdacs")?200:f.includes("fema")?40:80}return P.useEffect(()=>{const g=c.current;if(!g)return;const f=g.getSource();f==null||f.clear(),i&&n.forEach(_=>{const x=new Yr({geometry:new is(Ma([_.lon,_.lat]))});x.set("weight",Math.min(1,Math.max(.1,_.weight))),f==null||f.addFeature(x)})},[n,i]),P.useEffect(()=>{const g=h.current;if(!g)return;const f=g.getSource();f==null||f.clear(),s&&t.filter(_=>String(_.source).toLowerCase().includes("hifld")).forEach(_=>{if(_.longitude==null||_.latitude==null)return;const x=new Yr({geometry:new is(Ma([_.longitude,_.latitude]))});f==null||f.addFeature(x)})},[s,t]),E.jsx("div",{ref:o,className:"w-full h-[60vh] border border-primary/20"})}const JP=t=>{const e=String(t||"").toLowerCase();return e.includes("usgs")?"":e.includes("noaa")?"":e.includes("gdacs")?"":e.includes("fema")?"":e.includes("hifld")?"":e.includes("census")?"":""},QP=t=>{var i,r,s,o;const e=String(t.source||"unknown").toLowerCase(),n=new Date(t.timestamp).toLocaleString()||"";if(e==="usgs_seismic"){const a=(i=t.data)==null?void 0:i.mag,l=(r=t.data)==null?void 0:r.place;return`${a!=null?`M${a}`:"seismic activity"}${l?` near ${l}`:""}. ${n}`}if(e==="noaa_weather"){const a=(s=t.data)==null?void 0:s.headline;return`${((o=t.data)==null?void 0:o.event)||"Weather alert"}${a?`  ${a}`:""}. ${n}`}return`${(t.source||"Event").toString()} at ${n}`};function rv({events:t,onSelect:e}){const n=new Set,i=t.filter(r=>{const s=`${String(r.source).toLowerCase()}-${r.id}`;return n.has(s)?!1:(n.add(s),!0)});return E.jsxs("div",{className:"p-2",children:[E.jsx("div",{className:"border-b border-primary/20 px-2 py-1 flex items-center justify-between",children:E.jsx("div",{className:"text-primary",children:"Event Feed"})}),E.jsx("ul",{className:"divide-y divide-primary/10",children:i.map(r=>{const s=JP(r.source),o=QP(r),a=typeof r.confidence=="number"?Math.round(r.confidence*100):"",l=Math.round(sr(r)*100);return E.jsx("li",{className:"px-2 py-2",children:E.jsxs("div",{className:"grid grid-cols-[6px_auto_80px] gap-2 items-center",children:[E.jsx("div",{className:"bg-primary/60 rounded"}),E.jsxs("div",{className:"grid gap-1",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"text-lg",children:s}),E.jsx("span",{className:"text-xs tracking-widest text-muted-foreground",children:(r.source||"UNKNOWN").toUpperCase()})]}),E.jsx("div",{className:"text-sm",children:o}),E.jsxs("div",{className:"text-xs text-muted-foreground",children:["Conf: ",a,"%  Severity: ",l,"%"]})]}),E.jsx("div",{className:"flex justify-end",children:E.jsx("button",{className:"px-2 py-1 text-xs clip-corner-sm bg-primary/20 text-primary border border-primary/30",onClick:()=>e==null?void 0:e(r.id),children:"Focus"})})]})},r.id)})})]})}function Qc(t){const e=new Date,n=new Date(e.getTime()-60*6e4),i=t.filter(p=>{const y=new Date(p.timestamp).getTime();return!isNaN(y)&&y>=n.getTime()}),r=i.length,s=i.reduce((p,y)=>{const v=(y.source||"unknown").toLowerCase();return p[v]=(p[v]||0)+1,p},{}),o=Object.entries(s).sort((p,y)=>y[1]-p[1])[0],a=i.map(p=>typeof p.confidence=="number"?p.confidence:typeof p.confidence=="string"?Number(p.confidence):0),l=a.length?a.reduce((p,y)=>p+y,0)/a.length:0,u=Math.round(l*100),c=u>=70?"High":u>=40?"Moderate":"Low",h=i.some(p=>(p.source||"").toLowerCase()==="usgs_seismic"),d=i.some(p=>(p.source||"").toLowerCase()==="noaa_weather"),g=i.some(p=>(p.source||"").toLowerCase()==="hifld_infra"),f=h&&g?"Potential impact near infrastructure points.":d&&g?"Weather alerts observed near infrastructure.":"No supporting anomalies detected across aviation or maritime domains.",_=r>0?`Between ${n.toISOString().slice(11,16)}${e.toISOString().slice(11,16)} UTC, activity observed.`:"Stable patterns in the last hour.",x=o?`Most activity: ${(o[0]||"UNKNOWN").toUpperCase()} (${o[1]}).`:"",m=`Next: monitor ${o?o[0].toUpperCase():"key sources"} and watch for new anomaly flags.`;return[`${_}`,`Events: ${r}.`,`Confidence: ${c}.`,x,f,m].filter(Boolean).join(`
`)}function eI({events:t,onAsk:e}){const[n,i]=P.useState(""),[r,s]=P.useState(""),o=P.useMemo(()=>Qc(t),[t]),a=["Summarize last 6 hours","Explain top 3 anomalies","Any threats near critical infrastructure?","What should I monitor next?"];return E.jsxs("div",{className:"p-3 border-t border-primary/20",children:[E.jsx("div",{className:"text-sm text-primary",children:"Analyst Brief"}),E.jsx("pre",{className:"mt-2 text-xs text-foreground/90 whitespace-pre-wrap",children:o}),r&&E.jsx("pre",{className:"mt-2 text-xs text-success whitespace-pre-wrap",children:r}),E.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:a.map(u=>E.jsx("button",{className:"px-2 py-1 text-xs clip-corner-sm bg-primary/20 text-primary border border-primary/30",onClick:async()=>{await l(u),e==null||e(u)},children:u},u))}),E.jsxs("div",{className:"mt-3 flex gap-2",children:[E.jsx("input",{className:"px-2 py-1 text-xs bg-secondary text-foreground border border-primary/20 clip-corner-sm flex-1",value:n,onChange:u=>i(u.target.value),placeholder:"Ask the analyst"}),E.jsx("button",{className:"px-2 py-1 text-xs clip-corner-sm bg-primary/20 text-primary border border-primary/30",onClick:async()=>{const u=n.trim();u&&(await l(u),e==null||e(u),i(""))},children:"Ask"})]})]});async function l(u){const c=rr();if(!c){const h=`No backend configured. Based on current telemetry: ${Qc(t)}
Focus: Monitor top source; watch for new anomaly flags.`;s(h);return}try{const d=await(await fetch(`${c.replace(/\/$/,"")}/api/ai-analyst`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:u})})).json(),g=typeof d=="string"?d:JSON.stringify(d,null,2);s(g)}catch{s(`Analyst service unreachable. Falling back to local brief.
`+Qc(t))}}}function tI(){const[t,e]=P.useState([]),[n,i]=P.useState(void 0),[r,s]=P.useState({usgs:!0,noaa:!0,gdacs:!1,fema:!1,hifld:!1,census:!1}),[o,a]=P.useState(24),[l,u]=P.useState(!1),[c,h]=P.useState(void 0),[d,g]=P.useState(!1);return P.useEffect(()=>{let f=!1;return(async()=>{const _=rr();let x=[];if(_)x=await Qh();else{const m=new Date,p=new Date(m.getTime()-7*24*60*60*1e3).toISOString(),y=m.toISOString(),v=[];r.usgs&&v.push(fu()),r.noaa&&v.push(gu()),r.gdacs&&v.push(pu(p,y)),r.fema&&v.push(mu()),r.hifld&&v.push(_u()),r.census&&v.push(yu()),x=(await Promise.all(v)).flat()}f||e(x)})(),()=>{f=!0}},[r]),P.useEffect(()=>{const f=Number(window.localStorage.getItem("refreshMs")||"60000"),_=setInterval(()=>{rr()&&Qh().then(e).catch(()=>{})},Math.max(15e3,f));return()=>clearInterval(_)},[]),E.jsx("div",{className:"px-6 pt-20",children:E.jsxs("div",{className:"grid md:grid-cols-[280px_1fr] gap-4",children:[E.jsxs("div",{className:"border border-primary/20 clip-corner",children:[E.jsxs("div",{className:"px-2 py-2 border-b border-primary/20",children:[E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsx("div",{className:"text-xs text-primary tracking-widest uppercase",children:"Time Window"}),E.jsxs("div",{className:"text-xs text-muted-foreground",children:[o,"h"]})]}),E.jsx("input",{type:"range",min:"1",max:"168",value:o,onChange:f=>a(Number(f.target.value)),className:"w-full"})]}),E.jsx(rv,{events:t.filter(f=>{const _=new Date(f.timestamp).getTime(),x=Date.now()-o*36e5;return!isNaN(_)&&_>=x}),onSelect:f=>i(f)})]}),E.jsxs("div",{className:"border border-primary/20 clip-corner",children:[E.jsxs("div",{className:"px-3 py-2 border-b border-primary/20 flex flex-wrap gap-2",children:[E.jsx("div",{className:"text-xs text-primary tracking-widest uppercase",children:"Source Toggles"}),E.jsxs("label",{className:"text-xs flex items-center gap-1",children:[E.jsx("input",{type:"checkbox",checked:r.usgs,onChange:f=>s(_=>({..._,usgs:f.target.checked}))})," USGS"]}),E.jsxs("label",{className:"text-xs flex items-center gap-1",children:[E.jsx("input",{type:"checkbox",checked:r.noaa,onChange:f=>s(_=>({..._,noaa:f.target.checked}))})," NOAA"]}),E.jsxs("label",{className:"text-xs flex items-center gap-1",children:[E.jsx("input",{type:"checkbox",checked:r.gdacs,onChange:f=>s(_=>({..._,gdacs:f.target.checked}))})," GDACS"]}),E.jsxs("label",{className:"text-xs flex items-center gap-1",children:[E.jsx("input",{type:"checkbox",checked:r.fema,onChange:f=>s(_=>({..._,fema:f.target.checked}))})," FEMA"]}),E.jsxs("label",{className:"text-xs flex items-center gap-1",children:[E.jsx("input",{type:"checkbox",checked:r.hifld,onChange:f=>s(_=>({..._,hifld:f.target.checked}))})," HIFLD"]}),E.jsxs("label",{className:"text-xs flex items-center gap-1",children:[E.jsx("input",{type:"checkbox",checked:r.census,onChange:f=>s(_=>({..._,census:f.target.checked}))})," Census"]}),E.jsx("span",{className:"mx-2",children:""}),E.jsxs("label",{className:"text-xs flex items-center gap-1",children:[E.jsx("input",{type:"checkbox",checked:l,onChange:f=>u(f.target.checked)})," Predictions"]}),E.jsxs("label",{className:"text-xs flex items-center gap-1",children:[E.jsx("input",{type:"checkbox",checked:d,onChange:f=>g(f.target.checked)})," Hospitals"]}),E.jsxs("div",{className:"text-xs ml-auto flex items-center gap-2",children:[E.jsx("span",{children:"Impact radius"}),E.jsx("input",{type:"range",min:"10",max:"250",value:c??120,onChange:f=>h(Number(f.target.value))}),E.jsxs("span",{children:[c??120," km"]})]})]}),E.jsx(qP,{events:t,selectedId:n,predictionPoints:oS(t),showPredictions:l,simRadiusKm:c,showHospitals:d}),E.jsx(eI,{events:t,onAsk:()=>{}})]})]})})}function ro({title:t,value:e,subtitle:n,icon:i,variant:r="default"}){const s={default:"border-primary/20",warning:"border-warning/30",danger:"border-destructive/30",success:"border-success/30"}[r];return E.jsx("div",{className:nl("clip-corner border bg-card/30",s),children:E.jsx("div",{className:"px-4 py-3 flex items-center justify-between",children:E.jsxs("div",{className:"flex items-center gap-3",children:[i&&E.jsx("div",{className:"text-primary",children:i}),E.jsxs("div",{children:[E.jsx("div",{className:"text-xs tracking-widest text-muted-foreground uppercase",children:t}),E.jsx("div",{className:"text-2xl font-bold text-primary",children:e}),n&&E.jsx("div",{className:"text-xs text-muted-foreground",children:n})]})]})})})}function nI({events:t=[]}){const e=t.filter(c=>c.latitude!=null&&c.longitude!=null).slice(0,200),n=c=>`${(c+180)/360*100}%`,i=c=>`${(1-(c+90)/180)*100}%`,r=c=>{const h=String(c||"").toLowerCase();return h.includes("usgs")?"hsl(0 85% 55% / 0.9)":h.includes("noaa")?"hsl(35 100% 50% / 0.9)":h.includes("gdacs")?"hsl(180 100% 50% / 0.9)":h.includes("fema")?"hsl(150 80% 45% / 0.9)":"hsl(180 100% 50% / 0.6)"},s={usgs:t.filter(c=>String(c.source).toLowerCase().includes("usgs")).length,noaa:t.filter(c=>String(c.source).toLowerCase().includes("noaa")).length,gdacs:t.filter(c=>String(c.source).toLowerCase().includes("gdacs")).length,fema:t.filter(c=>String(c.source).toLowerCase().includes("fema")).length},o=P.useMemo(()=>Wi(t.filter(c=>String(c.source).toLowerCase().includes("usgs"))),[t]),a=P.useMemo(()=>Wi(t.filter(c=>String(c.source).toLowerCase().includes("noaa"))),[t]),l=P.useMemo(()=>Wi(t.filter(c=>String(c.source).toLowerCase().includes("gdacs"))),[t]),u=P.useMemo(()=>Wi(t.filter(c=>String(c.source).toLowerCase().includes("fema"))),[t]);return E.jsx("div",{className:"clip-corner border border-primary/20 bg-secondary",children:E.jsxs("div",{className:"relative h-[420px]",children:[E.jsx("div",{className:"absolute inset-2 border border-primary/20"}),E.jsx("div",{className:"absolute inset-0",children:E.jsxs("svg",{width:"100%",height:"100%",children:[E.jsx("defs",{children:E.jsxs("linearGradient",{id:"bggrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[E.jsx("stop",{offset:"0%",stopColor:"rgba(255,255,255,0.08)"}),E.jsx("stop",{offset:"100%",stopColor:"rgba(255,255,255,0.02)"})]})}),E.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#bggrad)"}),[10,20,30,40,50,60,70,80,90].map(c=>E.jsx("line",{x1:`${c}%`,y1:"0",x2:`${c}%`,y2:"100%",stroke:"rgba(255,255,255,0.08)"},`v${c}`)),[10,20,30,40,50,60,70,80,90].map(c=>E.jsx("line",{x1:"0",y1:`${c}%`,x2:"100%",y2:`${c}%`,stroke:"rgba(255,255,255,0.08)"},`h${c}`)),E.jsx("circle",{cx:"50%",cy:"55%",r:"60",fill:"none",stroke:"rgba(255,255,255,0.15)"}),E.jsx("circle",{cx:"50%",cy:"55%",r:"30",fill:"none",stroke:"rgba(255,255,255,0.12)"}),e.map((c,h)=>E.jsxs("g",{children:[E.jsx("circle",{cx:n(c.longitude),cy:i(c.latitude),r:4,fill:r(c.source)}),E.jsx("circle",{cx:n(c.longitude),cy:i(c.latitude),r:12,fill:r(c.source).replace("/ 0.9","/ 0.15"),className:"animate-ping"}),E.jsx("title",{children:`${c.source}  ${new Date(c.timestamp).toUTCString()}`})]},h)),[o,a,l,u].map((c,h)=>{const d=h===0?"hsl(0 85% 55% / 0.22)":h===1?"hsl(35 100% 50% / 0.22)":h===2?"hsl(180 100% 50% / 0.22)":"hsl(150 80% 45% / 0.22)",g=h===0?8:h===1?6:h===2?10:5;return c.map((f,_)=>E.jsx("circle",{cx:n(f.lon),cy:i(f.lat),r:`${g}%`,fill:d},`${h}-${_}`))})]})}),E.jsxs("div",{className:"absolute top-2 left-2 text-[11px] text-muted-foreground bg-background/60 px-2 py-1 clip-corner-sm border border-primary/20",children:["USGS ",s.usgs,"  NOAA ",s.noaa,"  GDACS ",s.gdacs,"  FEMA ",s.fema]}),E.jsxs("div",{className:"absolute bottom-2 right-2 text-[11px] text-muted-foreground bg-background/60 px-2 py-1 clip-corner-sm border border-primary/20",children:[E.jsx("span",{style:{color:"hsl(0 85% 55%)"},children:""})," USGS",E.jsx("span",{className:"ml-2",style:{color:"hsl(35 100% 50%)"},children:""})," NOAA",E.jsx("span",{className:"ml-2",style:{color:"hsl(180 100% 50%)"},children:""})," GDACS",E.jsx("span",{className:"ml-2",style:{color:"hsl(150 80% 45%)"},children:""})," FEMA"]})]})})}function sv({alerts:t}){return E.jsxs("div",{className:"clip-corner border border-primary/20",children:[E.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[E.jsx("div",{className:"text-sm text-primary tracking-widest uppercase",children:"Alert Channel"}),E.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.length," active"]})]}),E.jsx("div",{className:"px-2 pb-3 space-y-2",children:t.map(e=>E.jsx("div",{className:"px-3 py-2 border clip-corner-sm bg-card/20 flex items-center gap-3",style:{borderColor:e.severity==="high"?"hsl(0 85% 55% / 0.35)":e.severity==="medium"?"hsl(35 100% 50% / 0.35)":"hsl(180 100% 50% / 0.25)"},children:E.jsxs("div",{className:"text-xs font-medium",children:[e.title,E.jsxs("div",{className:"text-[11px] text-muted-foreground",children:[e.source,"  ",e.ago]})]})},e.id))})]})}function iI({stats:t}){return E.jsxs("div",{className:"clip-corner border border-primary/20",children:[E.jsx("div",{className:"px-4 py-3 text-sm text-primary tracking-widest uppercase",children:"System Status"}),E.jsx("div",{className:"px-4 pb-4 space-y-3",children:t.map(e=>E.jsxs("div",{children:[E.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:e.label}),E.jsx("div",{className:"h-2 bg-secondary clip-corner-sm",children:E.jsx("div",{className:"h-2",style:{width:`${e.value}%`,backgroundColor:e.color||"hsl(180 100% 50% / 0.7)"}})}),E.jsxs("div",{className:"text-[11px] text-muted-foreground mt-1",children:[e.value,"%"]})]},e.label))})]})}function rI({events:t}){const[e,n]=P.useState("");return P.useEffect(()=>{const i=rr(),r=vf(t),s=Wi(t),o=L0(t),a=[r>600?`Escalation expected in ${Math.max(6,Math.round(24-r/50))} hours`:"Conditions stable; monitor key sources",s[0]?`Deploy monitoring assets to zone (${s[0].lat.toFixed(2)}, ${s[0].lon.toFixed(2)})`:"No hotspot clusters detected",o.weather>50?"NOAA anomaly likelihood elevated":"No significant weather anomalies predicted"].join(`
`);n(a),i&&fetch(`${i.replace(/\/$/,"")}/api/ai-analyst`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"Operational recommendations for next 24h"})}).then(l=>l.json()).then(l=>n(typeof l=="string"?l:JSON.stringify(l,null,2))).catch(()=>{})},[t]),E.jsxs("div",{className:"clip-corner border border-primary/20 p-3",children:[E.jsx("div",{className:"text-xs text-primary tracking-widest uppercase",children:"RTAIP Recommendation Engine"}),E.jsx("pre",{className:"mt-2 text-xs whitespace-pre-wrap",children:e})]})}function sI({events:t}){const e=P.useMemo(()=>vf(t),[t]),n=P.useMemo(()=>{const o=Date.now()-216e5,a=t.filter(l=>{const u=new Date(l.timestamp).getTime();return!isNaN(u)&&u>=o});return Math.round(a.length/6)},[t]),i=P.useMemo(()=>Math.min(100,Math.round(100-Math.max(0,e-300)/7)),[e]),r=P.useMemo(()=>Math.max(0,Math.round(24-e/40)),[e]),s=P.useMemo(()=>{const o=t.length?t.map(sr).reduce((a,l)=>a+l,0)/t.length:0;return Math.min(100,Math.round(n*5+o*50))},[n,t]);return E.jsxs("div",{className:"clip-corner border border-primary/20 p-3",children:[E.jsx("div",{className:"text-xs text-primary tracking-widest uppercase mb-2",children:"Action Readiness"}),E.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[E.jsx(eh,{label:"Readiness",value:i,color:i<40?"hsl(0 85% 55%)":i<70?"hsl(35 100% 50%)":"hsl(150 80% 45%)"}),E.jsx(eh,{label:"T-minus (h)",value:r,color:"hsl(35 100% 50%)"}),E.jsx(eh,{label:"Saturation",value:s,color:"hsl(0 85% 55%)"})]}),E.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Events/hr: ",n,"  Threat Score: ",e]})]})}function eh({label:t,value:e,color:n}){return E.jsxs("div",{className:"clip-corner-sm border border-primary/20 p-2",children:[E.jsx("div",{className:"text-muted-foreground",children:t}),E.jsx("div",{className:"mt-1 h-2 bg-secondary relative",children:E.jsx("div",{style:{width:`${Math.min(100,e)}%`,background:n},className:"h-2"})}),E.jsx("div",{className:"mt-1 text-right",children:e})]})}function oI(){const[t,e]=P.useState([]),[n,i]=P.useState([]),r=P.useMemo(()=>[{label:"CPU load",value:34},{label:"Memory",value:67},{label:"Network",value:61,color:"hsl(35 100% 50% / 0.8)"},{label:"Security",value:22,color:"hsl(0 85% 55% / 0.8)"},{label:"Power",value:12}],[]);P.useEffect(()=>{let h=!1;return(async()=>{const d=new Date,g=new Date(d.getTime()-7*24*60*60*1e3).toISOString(),f=d.toISOString(),[_,x,m,p,y,v]=await Promise.all([fu(),gu(),pu(g,f),mu(),_u(),yu()]),w=[..._,...x,...m,...p,...y,...v];h||e(w);const C=[],R=T=>{const I=new Date(T).getTime();return`${Math.max(1,Math.round((Date.now()-I)/6e4))} min ago`};_.slice(0,3).forEach((T,I)=>{var b;const A=(b=T.data)==null?void 0:b.mag,j=A>=5?"high":A>=3?"medium":"low";C.push({id:`u-${I}`,title:`Seismic ${A!=null?`M${A}`:"activity"} detected`,source:"USGS",ago:R(T.timestamp),severity:j})}),x.slice(0,2).forEach((T,I)=>{var b;const A=((b=T.data)==null?void 0:b.event)||"Weather alert",j=/warning|watch/i.test(String(A))?"medium":"low";C.push({id:`n-${I}`,title:A,source:"NOAA",ago:R(T.timestamp),severity:j})}),h||i(C)})(),()=>{h=!0}},[]);const s=P.useMemo(()=>{const h=new Set;return t.forEach(d=>{d.source&&h.add(d.source)}),h.size},[t]),o=P.useMemo(()=>t.reduce((h,d)=>{var f,_;const g=String(d.source||"").toLowerCase();if(g==="usgs_seismic"&&((f=d.data)==null?void 0:f.mag)>=5)return h+1;if(g==="noaa_weather"){const x=((_=d.data)==null?void 0:_.event)||"";if(/warning/i.test(String(x)))return h+1}return h},0),[t]),a=P.useMemo(()=>vf(t),[t]),l=P.useMemo(()=>Wi(t),[t]),u=P.useMemo(()=>L0(t),[t]),c=P.useMemo(()=>o>3?"ALPHA":o>0?"BRAVO":"NORMAL",[o]);return E.jsxs("div",{className:"px-6 pt-20 space-y-6",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("div",{className:"text-xs tracking-widest text-muted-foreground uppercase",children:"Real-Time Tactical Analysis Intelligence Platform"}),E.jsxs("div",{className:"text-4xl font-bold",children:["Command ",E.jsx("span",{className:"text-primary",children:"Center"})]}),E.jsx("div",{className:"text-sm text-muted-foreground",children:"Advanced situational awareness and threat monitoring. All systems synchronized and operational."})]}),E.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[E.jsx(ro,{title:"Global Threat Score",value:a,subtitle:a>700?"CRITICAL":a>450?"HIGH":a>250?"ELEVATED":"LOW",icon:E.jsx(qh,{className:"w-4 h-4"}),variant:a>700?"danger":a>450?"warning":"default"}),E.jsx(ro,{title:"Active Sources",value:s,subtitle:"Synced",icon:E.jsx(kl,{className:"w-4 h-4"})}),E.jsx(ro,{title:"Events Processed",value:t.length,subtitle:"Last 7 days",icon:E.jsx(eS,{className:"w-4 h-4"})}),E.jsx(ro,{title:"Security Level",value:c,subtitle:c==="ALPHA"?"Elevated":"Nominal",icon:E.jsx(Qw,{className:"w-4 h-4"}),variant:c==="ALPHA"?"danger":"default"})]}),E.jsxs("div",{className:"grid lg:grid-cols-[1fr_360px] gap-4",children:[E.jsxs("div",{children:[E.jsx("div",{className:"text-sm text-primary tracking-widest uppercase mb-2",children:"Tactical Overview"}),E.jsx(nI,{events:t})]}),E.jsxs("div",{className:"space-y-4",children:[E.jsx(sv,{alerts:n}),E.jsx(iI,{stats:r}),E.jsxs("div",{className:"clip-corner border border-primary/20 p-3",children:[E.jsx("div",{className:"text-xs text-primary tracking-widest uppercase mb-2",children:"Top Emerging Threat Clusters"}),E.jsx("ul",{className:"text-xs space-y-1",children:l.map((h,d)=>E.jsxs("li",{className:"flex items-center justify-between",children:[E.jsxs("span",{children:["(",h.lat.toFixed(2),", ",h.lon.toFixed(2),")"]}),E.jsxs("span",{className:"text-muted-foreground",children:["score ",Math.round(h.score*100)]})]},d))}),E.jsxs("div",{className:"mt-3 text-xs text-muted-foreground",children:["Type probabilities (72h): weather ",u.weather||0,"%  seismic ",u.seismic||0,"%  disaster ",u.disaster||0,"%"]})]}),E.jsx(rI,{events:t}),E.jsx(sI,{events:t})]})]})]})}function r_(){const[t,e]=P.useState([{label:"USGS Seismic",count:0,subtitle:"Fetching...",icon:E.jsx(kl,{className:"w-4 h-4"}),variant:"warning"},{label:"NOAA Weather",count:0,subtitle:"Fetching...",icon:E.jsx(Gp,{className:"w-4 h-4"}),variant:"success"},{label:"GDACS Disasters",count:0,subtitle:"Fetching...",icon:E.jsx(Xp,{className:"w-4 h-4"}),variant:"danger"},{label:"FEMA Declarations",count:0,subtitle:"Fetching...",icon:E.jsx(qh,{className:"w-4 h-4"}),variant:"warning"},{label:"HIFLD Infrastructure",count:0,subtitle:"Fetching...",icon:E.jsx(Up,{className:"w-4 h-4"}),variant:"default"},{label:"Census Counties",count:0,subtitle:"Fetching...",icon:E.jsx(Wp,{className:"w-4 h-4"}),variant:"default"}]),[n,i]=P.useState([]);return P.useEffect(()=>{let r=!1;return(async()=>{const s=new Date,o=new Date(s.getTime()-7*24*60*60*1e3).toISOString(),a=s.toISOString(),[l,u,c,h,d,g]=await Promise.all([fu(),gu(),pu(o,a),mu(),_u(),yu()]);if(r)return;const f=[{label:"USGS Seismic",count:l.length,subtitle:"Earthquake feed (24h)",icon:E.jsx(kl,{className:"w-4 h-4"}),variant:"warning"},{label:"NOAA Weather",count:u.length,subtitle:"Active alerts",icon:E.jsx(Gp,{className:"w-4 h-4"}),variant:"success"},{label:"GDACS Disasters",count:c.length,subtitle:"Global disaster events",icon:E.jsx(Xp,{className:"w-4 h-4"}),variant:"danger"},{label:"FEMA Declarations",count:h.length,subtitle:"US incidents",icon:E.jsx(qh,{className:"w-4 h-4"}),variant:"warning"},{label:"HIFLD Infrastructure",count:d.length,subtitle:"Hospitals",icon:E.jsx(Up,{className:"w-4 h-4"}),variant:"default"},{label:"Census Counties",count:g.length,subtitle:"Population geography",icon:E.jsx(Wp,{className:"w-4 h-4"}),variant:"default"}];e(f);const _=[],x=m=>{const p=new Date(m).getTime();return`${Math.max(1,Math.round((Date.now()-p)/6e4))} min ago`};l.slice(0,3).forEach((m,p)=>{var w;const y=(w=m.data)==null?void 0:w.mag,v=y>=5?"high":y>=3?"medium":"low";_.push({id:`u-${p}`,title:`Seismic ${y!=null?`M${y}`:"activity"} detected`,source:"USGS",ago:x(m.timestamp),severity:v})}),u.slice(0,2).forEach((m,p)=>{var w;const y=((w=m.data)==null?void 0:w.event)||"Weather alert",v=/warning|watch/i.test(String(y))?"medium":"low";_.push({id:`n-${p}`,title:y,source:"NOAA",ago:x(m.timestamp),severity:v})}),i(_)})(),()=>{r=!0}},[]),E.jsxs("div",{className:"px-6 pt-20 space-y-6",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("div",{className:"text-xs tracking-widest text-muted-foreground uppercase",children:"Data Sources"}),E.jsxs("div",{className:"text-4xl font-bold",children:["Sources ",E.jsx("span",{className:"text-primary",children:"Registry"})]}),E.jsx("div",{className:"text-sm text-muted-foreground",children:"All inbound channels and datasets. Each source is synchronized and monitored for anomalies."})]}),E.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:t.map(r=>E.jsx(ro,{title:r.label,value:r.count,subtitle:r.subtitle,icon:r.icon,variant:r.variant},r.label))}),E.jsxs("div",{className:"clip-corner border border-primary/20",children:[E.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[E.jsx("div",{className:"text-sm text-primary tracking-widest uppercase",children:"Alert Channel"}),E.jsxs("div",{className:"text-xs text-muted-foreground",children:[n.length," active"]})]}),E.jsx("div",{className:"px-2 pb-3",children:n.length===0?E.jsx("div",{className:"px-3 py-2 text-xs text-muted-foreground",children:"No alerts yet."}):E.jsx(sv,{alerts:n})})]}),E.jsxs("div",{className:"clip-corner border border-primary/20 p-4",children:[E.jsx("div",{className:"text-sm text-primary tracking-widest uppercase",children:"Integration Notes"}),E.jsx("div",{className:"mt-2 text-sm text-muted-foreground",children:"Sources include seismic, weather, disaster management, critical infrastructure, and population datasets. These channels feed the map, timeline, and analyst brief to maintain situational awareness."})]})]})}function aI({matrix:t}){const e=Object.keys(t),n=Math.max(1,...e.flatMap(r=>Object.values(t[r]||{}))),i=r=>{const s=Math.min(1,r/n),o=35-Math.round(s*35),a=.15+s*.7;return`hsl(${o} 100% 50% / ${a})`};return E.jsx("div",{className:"overflow-auto",children:E.jsxs("table",{className:"text-xs w-full border border-primary/20 clip-corner",children:[E.jsx("thead",{children:E.jsxs("tr",{children:[E.jsx("th",{className:"p-2 text-left",children:"Source"}),e.map(r=>E.jsx("th",{className:"p-2 text-left",children:r.toUpperCase()},r))]})}),E.jsx("tbody",{children:e.map(r=>E.jsxs("tr",{children:[E.jsx("td",{className:"p-2 text-muted-foreground",children:r.toUpperCase()}),e.map(s=>{var a;const o=((a=t[r])==null?void 0:a[s])??0;return E.jsx("td",{style:{background:i(o)},className:"p-2 border-t border-primary/10",children:Math.round(o*100)},`${r}-${s}`)})]},r))})]})})}function lI(){const[t,e]=P.useState([]);P.useEffect(()=>{let a=!1;return(async()=>{let u=await Qh();if(u.length===0){const c=new Date,h=new Date(c.getTime()-7*24*60*60*1e3).toISOString(),d=c.toISOString(),[g,f,_,x,m,p]=await Promise.all([fu(),gu(),pu(h,d),mu(),_u(),yu()]);u=[...g,...f,..._,...x,...m,...p]}u.sort((c,h)=>new Date(h.timestamp).getTime()-new Date(c.timestamp).getTime()),a||e(u)})(),()=>{a=!0}},[]);const n=P.useMemo(()=>t.length,[t]),[i,r]=P.useState(12),s=P.useMemo(()=>{const a=Date.now()-i*36e5;return t.filter(l=>{const u=new Date(l.timestamp).getTime();return!isNaN(u)&&u>=a})},[t,i]),o=P.useMemo(()=>aS(s),[s]);return E.jsxs("div",{className:"px-6 pt-20 space-y-4",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("div",{className:"text-xs tracking-widest text-muted-foreground uppercase",children:"Chronology"}),E.jsxs("div",{className:"text-4xl font-bold",children:["Event ",E.jsx("span",{className:"text-primary",children:"Timeline"})]}),E.jsx("div",{className:"text-sm text-muted-foreground",children:"Ordered by most recent. Combined across all sources for operational review."})]}),E.jsxs("div",{className:"clip-corner border border-primary/20",children:[E.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[E.jsx("div",{className:"text-sm text-primary tracking-widest uppercase",children:"Latest Events"}),E.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.length," / ",n," shown"]})]}),E.jsxs("div",{className:"px-4 pb-2",children:[E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsx("div",{className:"text-xs text-primary tracking-widest uppercase",children:"Playback Window"}),E.jsxs("div",{className:"text-xs text-muted-foreground",children:[i,"h"]})]}),E.jsx("input",{type:"range",min:"1",max:"168",value:i,onChange:a=>r(Number(a.target.value)),className:"w-full"})]}),t.length===0?E.jsx("div",{className:"px-4 pb-4 text-xs text-muted-foreground",children:"No events available yet. Try again shortly or check backend ingestion."}):E.jsx(rv,{events:s,onSelect:()=>{}})]}),E.jsxs("div",{className:"clip-corner border border-primary/20 p-4",children:[E.jsx("div",{className:"text-sm text-primary tracking-widest uppercase mb-2",children:"Correlation Snapshot"}),E.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Before / During / After analysis: adjust the slider to observe correlation changes across sources."}),E.jsx(aI,{matrix:o})]})]})}function uI(){const[t,e]=P.useState(""),[n,i]=P.useState(6e4),[r,s]=P.useState({usgs:!0,noaa:!0,gdacs:!1,fema:!1,hifld:!1,census:!1});P.useEffect(()=>{const a=rr();e(a||"");const l=window.localStorage.getItem("sources");if(l)try{s(JSON.parse(l))}catch{}const u=window.localStorage.getItem("refreshMs");u&&i(Number(u))},[]);const o=()=>{window.localStorage.setItem("backendUrl",t.trim()),window.localStorage.setItem("sources",JSON.stringify(r)),window.localStorage.setItem("refreshMs",String(n))};return E.jsxs("div",{className:"px-6 pt-20 space-y-6",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("div",{className:"text-xs tracking-widest text-muted-foreground uppercase",children:"Configuration"}),E.jsxs("div",{className:"text-4xl font-bold",children:["System ",E.jsx("span",{className:"text-primary",children:"Settings"})]}),E.jsx("div",{className:"text-sm text-muted-foreground",children:"Backend connection, source toggles, and refresh intervals."})]}),E.jsxs("div",{className:"clip-corner border border-primary/20 p-4 space-y-4",children:[E.jsxs("div",{children:[E.jsx("div",{className:"text-sm text-primary tracking-widest uppercase mb-2",children:"Backend URL"}),E.jsx("input",{className:"w-full px-3 py-2 bg-secondary border border-primary/20 clip-corner-sm",value:t,onChange:a=>e(a.target.value),placeholder:"https://your-backend.onrender.com"})]}),E.jsxs("div",{children:[E.jsx("div",{className:"text-sm text-primary tracking-widest uppercase mb-2",children:"Source Toggles"}),E.jsx("div",{className:"flex flex-wrap gap-3 text-xs",children:Object.keys(r).map(a=>E.jsxs("label",{className:"flex items-center gap-2",children:[E.jsx("input",{type:"checkbox",checked:r[a],onChange:l=>s(u=>({...u,[a]:l.target.checked}))})," ",a.toUpperCase()]},a))})]}),E.jsxs("div",{children:[E.jsx("div",{className:"text-sm text-primary tracking-widest uppercase mb-2",children:"Refresh Interval"}),E.jsx("input",{type:"number",className:"px-3 py-2 bg-secondary border border-primary/20 clip-corner-sm",value:n,onChange:a=>i(Number(a.target.value))}),E.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"milliseconds"})]}),E.jsx("div",{children:E.jsx("button",{className:"px-3 py-2 clip-corner-sm bg-primary/20 text-primary border border-primary/30",onClick:o,children:"Save"})})]})]})}function cI(){const[t,e]=P.useState(!1),[n,i]=P.useState(!0);return P.useEffect(()=>{const r=setTimeout(()=>i(!1),1200);return()=>clearTimeout(r)},[]),P.useEffect(()=>{async function r(){const o=rr();if(!o){e(!1);return}try{const a=await fetch(`${o.replace(/\/$/,"")}/health`,{cache:"no-store"});e(a.ok)}catch{e(!1)}}r();const s=setInterval(r,3e4);return()=>{clearInterval(s)}},[]),E.jsxs("div",{className:"min-h-screen",children:[E.jsx(nS,{isOnline:t}),E.jsx("div",{className:"pt-16",children:E.jsxs(Nw,{children:[E.jsx(Qn,{path:"/",element:E.jsx(r_,{})}),E.jsx(Qn,{path:"/sources",element:E.jsx(r_,{})}),E.jsx(Qn,{path:"/dashboard",element:E.jsx(oI,{})}),E.jsx(Qn,{path:"/map",element:E.jsx(tI,{})}),E.jsx(Qn,{path:"/timeline",element:E.jsx(lI,{})}),E.jsx(Qn,{path:"/settings",element:E.jsx(uI,{})}),E.jsx(Qn,{path:"*",element:E.jsx(Mw,{to:"/",replace:!0})})]})}),n&&E.jsx("div",{className:"fixed inset-0 z-[100] grid place-items-center bg-background",children:E.jsxs("div",{className:"text-center",children:[E.jsx("div",{className:"text-[12px] tracking-widest text-muted-foreground uppercase",children:"RTAIP"}),E.jsxs("div",{className:"text-4xl font-bold",children:[E.jsx("span",{className:"text-primary",children:"Rapid"})," Tactical AI Platform"]}),E.jsx("div",{className:"mt-4 inline-block clip-corner-sm border border-primary/30 px-4 py-2 text-xs text-primary bg-primary/10",children:"Initializing Systems"})]})})]})}th.createRoot(document.getElementById("root")).render(E.jsx(p_.StrictMode,{children:E.jsx(Bw,{children:E.jsx(cI,{})})}));
